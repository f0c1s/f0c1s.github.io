<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="../../../index.css"/>
<link rel="stylesheet" href="../../../highlight/styles/monokai.min.css"/>
<script src="../../../highlight/highlight.min.js"></script>
<script>hljs.highlightAll();</script>

<h1>/f0c1s/blog/sec/tools/nbtscan</h1>

<p>
    <a href="../index.html">/blog</a>
    <a href="../../../sec/index.html">Security</a>
    <a href="../../../sec/tools/index.html">tools</a>
    <a href="../../../sec/tools/nbtscan/nbtscan.html">+ tool nbtscan</a>
</p>

<h1 id="tool-nbtscan">tool nbtscan</h1>
<blockquote>
<p>From homepage:</p>
<p>This is a command-line tool that scans for open NETBIOS nameservers on a local or remote TCP/IP network, and this is a first step in finding of open shares. It is based on the functionality of the standard Windows tool nbtstat, but it operates on a range of addresses instead of just one. I wrote this tool because the existing tools either didn’t do what I wanted or ran only on the Windows platforms: mine runs on just about everything.</p>
</blockquote>
<p><a href="http://unixwiz.net/tools/nbtscan.html">Homepage: http://unixwiz.net/tools/nbtscan.html</a> <a href="http://unixwiz.net/tools/nbtscan-source-1.0.35.zip">Source, zipped: http://unixwiz.net/tools/nbtscan-source-1.0.35.zip</a> <a href="http://unixwiz.net/tools/nbtscan-source-1.0.35.tgz">Source, gzipped: http://unixwiz.net/tools/nbtscan-source-1.0.35.tgz</a> <a href="https://www.kali.org/tools/nbtscan-unixwiz/">Kali tools: https://www.kali.org/tools/nbtscan-unixwiz/</a> <a href="https://gitlab.com/kalilinux/packages/nbtscan-unixwiz">Source: https://gitlab.com/kalilinux/packages/nbtscan-unixwiz</a></p>
<figure>
<img src="0.homepage.png" alt="" /><figcaption>0.homepage</figcaption>
</figure>
<h2 id="sample-usage">Sample usage</h2>
<h3 id="use-local-port-137">use local port 137</h3>
<pre class="shell"><code>nbtscan -r $RHOST | tee nbtscan.txt             
Doing NBT name scan for addresses from 192.168.56.77

IP address       NetBIOS Name     Server    User             MAC address      
------------------------------------------------------------------------------
192.168.56.77    TORMENT          &lt;server&gt;  TORMENT          00:00:00:00:00:00</code></pre>
<figure>
<img src="1.nbtscan-sample-usage.png" alt="" /><figcaption>1.nbtscan-sample-usage</figcaption>
</figure>
<h3 id="verbose">verbose</h3>
<pre class="shell"><code>nbtscan -v $RHOST 
Doing NBT name scan for addresses from 192.168.56.77


NetBIOS Name Table for Host 192.168.56.77:

Incomplete packet, 227 bytes long.
Name             Service          Type             
----------------------------------------
TORMENT          &lt;00&gt;             UNIQUE
TORMENT          &lt;03&gt;             UNIQUE
TORMENT          &lt;20&gt;             UNIQUE
__MSBROWSE__  &lt;01&gt;              GROUP
WORKGROUP        &lt;00&gt;              GROUP
WORKGROUP        &lt;1d&gt;             UNIQUE
WORKGROUP        &lt;1e&gt;              GROUP

Adapter address: 00:00:00:00:00:00
----------------------------------------</code></pre>
<figure>
<img src="2.nbtscan-verbose.png" alt="" /><figcaption>2.nbtscan-verbose</figcaption>
</figure>
<h3 id="dump-packets">dump packets</h3>
<pre class="shell"><code>nbtscan -d $RHOST 
Doing NBT name scan for addresses from 192.168.56.77


Packet dump for Host 192.168.56.77:

Incomplete packet, 227 bytes long.
Transaction ID: 0x0054 (84)
Flags: 0x8400 (33792)
Question count: 0x0000 (0)
Answer count: 0x0001 (1)
Name service count: 0x0000 (0)
Additional record count: 0x0000 (0)
Question name:  CKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Question type: 0x0021 (33)
Question class: 0x0001 (1)
Time to live: 0x00000000 (0)
Rdata length: 0x00ad (173)
Number of names: 0x07 (7)
Names received:
TORMENT           Service: 0x00 Flags: 0x0004
TORMENT           Service: 0x03 Flags: 0x0004
TORMENT           Service: 0x20 Flags: 0x0004
__MSBROWSE__   Service: 0x01 Flags: 0x0084
WORKGROUP         Service: 0x00 Flags: 0x0084
WORKGROUP         Service: 0x1d Flags: 0x0004
WORKGROUP         Service: 0x1e Flags: 0x0084
Adapter address: 00:00:00:00:00:00
Version major: 0x00 (0)
Version minor: 0x00 (0)
Duration: 0x0000 (0)
FRMRs Received: 0x0000 (0)
FRMRs Transmitted: 0x0000 (0)
IFrame Receive errors: 0x0000 (0)
Transmit aborts: 0x0000 (0)
Transmitted: 0x00000000 (0)
Received: 0x00000000 (0)
IFrame transmit errors: 0x0000 (0)
No receive buffers: 0x0000 (0)
tl timeouts: 0x0000 (0)
ti timeouts: 0x0000 (0)
Free NCBS: 0x0000 (0)
NCBS: 0x0000 (0)
Max NCBS: 0x0000 (0)
No transmit buffers: 0x0000 (0)
Max datagram: 0x0000 (0)
Pending sessions: 0x0000 (0)
Max sessions: 0x0000 (0)
Packet sessions: 0x0000 (0)</code></pre>
<figure>
<img src="3.nbtscan-dump-packets.png" alt="" /><figcaption>3.nbtscan-dump-packets</figcaption>
</figure>
<h3 id="scanning-whole-subnet">scanning whole subnet</h3>
<pre class="shell"><code>nbtscan $RHOST/24 
Doing NBT name scan for addresses from 192.168.56.77/24

IP address       NetBIOS Name     Server    User             MAC address      
------------------------------------------------------------------------------
192.168.56.77    TORMENT          &lt;server&gt;  TORMENT          00:00:00:00:00:00
192.168.56.255  Sendto failed: Permission denied



nbtscan -v $RHOST/24
Doing NBT name scan for addresses from 192.168.56.77/24
NetBIOS Name Table for Host 192.168.56.77:

Incomplete packet, 227 bytes long.
Name             Service          Type             
----------------------------------------
TORMENT          &lt;00&gt;             UNIQUE
TORMENT          &lt;03&gt;             UNIQUE
TORMENT          &lt;20&gt;             UNIQUE
__MSBROWSE__  &lt;01&gt;              GROUP
WORKGROUP        &lt;00&gt;              GROUP
WORKGROUP        &lt;1d&gt;             UNIQUE
WORKGROUP        &lt;1e&gt;              GROUP

Adapter address: 00:00:00:00:00:00
----------------------------------------
192.168.56.255  Sendto failed: Permission denied
</code></pre>
<figure>
<img src="4.nbtscan-scanning-the-subnet.png" alt="" /><figcaption>4.nbtscan-scanning-the-subnet</figcaption>
</figure>
<h2 id="help">help</h2>
<pre class="shell"><code>nbtscan --help                                  
nbtscan: invalid option -- &#39;-&#39;

NBTscan version 1.7.1.
This is a free software and it comes with absolutely no warranty.
You can use, distribute and modify it under terms of GNU GPL 2+.

Usage:
nbtscan [-v] [-d] [-e] [-l] [-t timeout] [-b bandwidth] [-r] [-q] [-s separator] [-m retransmits] (-f filename)|(&lt;scan_range&gt;) 
        -v              verbose output. Print all names received
                        from each host
        -d              dump packets. Print whole packet contents.
        -e              Format output in /etc/hosts format.
        -l              Format output in lmhosts format.
                        Cannot be used with -v, -s or -h options.
        -t timeout      wait timeout milliseconds for response.
                        Default 1000.
        -b bandwidth    Output throttling. Slow down output
                        so that it uses no more that bandwidth bps.
                        Useful on slow links, so that ougoing queries
                        don&#39;t get dropped.
        -r              use local port 137 for scans. Win95 boxes
                        respond to this only.
                        You need to be root to use this option on Unix.
        -q              Suppress banners and error messages,
        -s separator    Script-friendly output. Don&#39;t print
                        column and record headers, separate fields with separator.
        -h              Print human-readable names for services.
                        Can only be used with -v option.
        -m retransmits  Number of retransmits. Default 0.
        -f filename     Take IP addresses to scan from file filename.
                        -f - makes nbtscan take IP addresses from stdin.
        &lt;scan_range&gt;    what to scan. Can either be single IP
                        like 192.168.1.1 or
                        range of addresses in one of two forms: 
                        xxx.xxx.xxx.xxx/xx or xxx.xxx.xxx.xxx-xxx.
Examples:
        nbtscan -r 192.168.1.0/24
                Scans the whole C-class network.
        nbtscan 192.168.1.25-137
                Scans a range from 192.168.1.25 to 192.168.1.137
        nbtscan -v -s : 192.168.1.0/24
                Scans C-class network. Prints results in script-friendly
                format using colon as field separator.
                Produces output like that:
                192.168.0.1:NT_SERVER:00U
                192.168.0.1:MY_DOMAIN:00G
                192.168.0.1:ADMINISTRATOR:03U
                192.168.0.2:OTHER_BOX:00U
                ...
        nbtscan -f iplist
                Scans IP addresses specified in file iplist.</code></pre>
<h2 id="man-page">Man page</h2>
<pre class="shell"><code>nbtscan(1)                       scan networks searching for NetBIOS information                      nbtscan(1)

NAME
       nbtscan - scan networks for NetBIOS name information

SYNOPSIS
       nbtscan [-v] [-d] [-e] [-l] [-t timeout] [-b bandwidth] [-r] [-q]
               [-s separator] [-h] [-m retransmits] [-f filename | target]

DESCRIPTION
       NBTscan is a program for scanning IP networks for NetBIOS name information. It sends NetBIOS status query
       to each address in supplied range and lists received information in human readable  form.  For  each  re‐
       sponded  host  it  lists  IP address, NetBIOS computer name, logged-in user name and MAC address (such as
       Ethernet).

       NBTscan produces a report like that:

           IP address     NetBIOS Name  Server    User           MAC address
           -----------------------------------------------------------------------
           192.168.1.2    MYCOMPUTER              JDOE           00-a0-c9-12-34-56
           192.168.1.5    WIN98COMP     &lt;server&gt;  RROE           00-a0-c9-78-90-00
           192.168.1.123  DPTSERVER     &lt;server&gt;  ADMINISTRATOR  08-00-09-12-34-56

       First column lists IP address of responded host. Second column is computer name. Third  column  indicates
       if  this  computer shares or is able to share files or printers. For NT machine it means that Server Ser‐
       vice is running on this computer. For Windows 95 it means that &quot;I want to be able to give  others  access
       to my files&quot; or &quot;I want to be able to allow others to print on my printer(s)&quot; checkbox is ticked (in Con‐
       trol Panel/Network/File and Print Sharing). Most often it means that this computer  shares  files.  Third
       column  shows user name. If no one is logged on from this computer it is same as computer name. Last col‐
       umn shows adapter MAC address.

       If run with -v switch NBTscan lists whole NetBIOS name table for  each  responded  address.   The  output
       looks like that:

           NetBIOS Name Table for Host 192.168.1.123:

           Name             Service          Type
           ----------------------------------------
           DPTSERVER        &lt;00&gt;             UNIQUE
           DPTSERVER        &lt;20&gt;             UNIQUE
           DEPARTMENT       &lt;00&gt;             GROUP
           DEPARTMENT       &lt;1c&gt;             GROUP
           DEPARTMENT       &lt;1b&gt;             UNIQUE
           DEPARTMENT       &lt;1e&gt;             GROUP
           DPTSERVER        &lt;03&gt;             UNIQUE
           DEPARTMENT       &lt;1d&gt;             UNIQUE
           ??__MSBROWSE__?  &lt;01&gt;             GROUP
           INet~Services    &lt;1c&gt;             GROUP
           IS~DPTSERVER     &lt;00&gt;             UNIQUE
           DPTSERVER        &lt;01&gt;             UNIQUE

           Adapter address: 00-a0-c9-12-34-56
           ----------------------------------------

OPTIONS
       A summary of options is included below.

       -v     Verbose output. Print all names received from each host.

       -d     Dump packets. Print whole packet contents. Cannot be used with -v, -s or -h options.

       -e     Format output in /etc/hosts format.

       -l     Format output in lmhosts format.

       -t &lt;timeout&gt;
              Wait timeout seconds for response. Default 1.

       -b &lt;bandwidth&gt;
              Output   throttling.  Slow  down output so that it uses no more that bandwidth bps. Useful on slow
              links, so that outgoing queries don&#39;t get dropped.

       -r     Use local port 137 for scans. Win95 boxes respond to this only. You need to be root  to  use  this
              option.

       -q     Suppress banners and error messages.

       -s &lt;separator&gt;
              Script-friendly output. Don&#39;t print column and record headers, separate fields with separator.

       -h     Print human-readable names for services. Can only be used with -v option.

       -m &lt;retransmits&gt;
              Number of retransmits. Default 0.

       -f &lt;filename&gt;
              Take IP addresses to scan from file &quot;filename&quot;

       target NBTscan  is  a  command-line tool. You have to supply at least one argument, the address range, in
              one of three forms:

              xxx.xxx.xxx.xxx
                     Single IP in dotted-decimal notation. Example: 192.168.1.1

              xxx.xxx.xxx.xxx/xx
                     Net address and subnet mask. Example: 192.168.1.0/24

              xxx.xxx.xxx.xxx-xxx
                     Address range. Example: 192.168.1.1-127. This will scan all addresses from  192.168.1.1  to
                     192.168.1.127

EXAMPLES
       Scans the whole C-class network:

           nbtscan 192.168.1.0/24

       Scans the whole C-class network, using port 137:

           nbtscan -r 192.168.1.0/24

       Scans a range from 192.168.1.25 to 192.168.1.137:

           nbtscan 192.168.1.25-137

       Scans C-class network. Prints results in script-friendly format using colon as field separator:

           nbtscan -v -s : 192.168.1.0/24

       The last command produces output like that:

           192.168.0.1:NT_SERVER:00U
           192.168.0.1:MY_DOMAIN:00G
           192.168.0.1:ADMINISTRATOR:03U
           192.168.0.2:OTHER_BOX:00U
           ...

       Scans IP addresses specified in file iplist:

           nbtscan -f iplist

NETBIOS SUFFIXES
       NetBIOS  Suffix, aka NetBIOS End Character (endchar), indicates service type for the registered name. The
       most known codes are listed below. (U = Unique Name, G = Group Name)

           Name                Number(h)  Type  Usage
           --------------------------------------------------------------------------

           &lt;computername&gt;         00       U    Workstation Service
           &lt;computername&gt;         01       U    Messenger Service
           &lt;\--__MSBROWSE__&gt;      01       G    Master Browser
           &lt;computername&gt;         03       U    Messenger Service
           &lt;computername&gt;         06       U    RAS Server Service
           &lt;computername&gt;         1F       U    NetDDE Service
           &lt;computername&gt;         20       U    File Server Service
           &lt;computername&gt;         21       U    RAS Client Service
           &lt;computername&gt;         22       U    Exchange Interchange(MSMail Connector)
           &lt;computername&gt;         23       U    Exchange Store
           &lt;computername&gt;         24       U    Exchange Directory
           &lt;computername&gt;         30       U    Modem Sharing Server Service
           &lt;computername&gt;         31       U    Modem Sharing Client Service
           &lt;computername&gt;         43       U    SMS Clients Remote Control
           &lt;computername&gt;         44       U    SMS Administrators Remote Control Tool
           &lt;computername&gt;         45       U    SMS Clients Remote Chat
           &lt;computername&gt;         46       U    SMS Clients Remote Transfer
           &lt;computername&gt;         87       U    Microsoft Exchange MTA
           &lt;computername&gt;         6A       U    Microsoft Exchange IMC
           &lt;computername&gt;         BE       U    Network Monitor Agent
           &lt;computername&gt;         BF       U    Network Monitor Application
           &lt;username&gt;             03       U    Messenger Service
           &lt;domain&gt;               00       G    Domain Name
           &lt;domain&gt;               1B       U    Domain Master Browser
           &lt;domain&gt;               1C       G    Domain Controllers
           &lt;domain&gt;               1D       U    Master Browser
           &lt;domain&gt;               1E       G    Browser Service Elections
           &lt;INet~Services&gt;        1C       G    IIS
           &lt;IS~computer name&gt;     00       U    IIS

FAQ
       1.  NBTscan lists my Windows boxes just fine but does not list my Unixes or routers. Why?

       R: That is the way it is supposed to work. NBTscan uses NetBIOS for scanning and NetBIOS is  only  imple‐
       mented by Windows (and some software on Unix such as Samba).

       2.  Why do I get &quot;Connection reset by peer&quot; errors on Windows 2000?

       R:  NBTscan  uses port 137 UDP for sending queries. If the port is closed on destination host destination
       will reply with ICMP &quot;Port unreachable&quot; message. Most operating system will ignore this message.  Windows
       2000 reports it to the application as &quot;Connection reset by peer&quot; error. Just ignore it.

       3.  Why NBTscan doesn&#39;t scan for shares? Are you going to add share scanning to NBTscan?

       R:  No.  NBTscan uses UDP for what it does. That makes it very fast. Share scanning requires TCP. For one
       thing, it will make nbtscan more slow. Also adding share scanning means adding  a  lot  of  new  code  to
       nbtscan. There is a lot of good share scanners around, so there is no reason to duplicate that work.

       4.  Why do I get 00-00-00-00-00-00 instead of MAC address when I scan a Samba box?

       R: Because that&#39;s what Samba send in response to the query. Nbtscan just prints out what it gets.

AUTHOR
       NBTscan was created by Alla Bezroutchko &lt;alla@inetcat.org&gt;. Currently is maintained by some volunteers at
       https://github.com/resurrecting-open-source-projects/nbtscan

       This manual page was written for the first time by Ryszard  Lach  &lt;rla@debian.org&gt;  and  rewritten,  from
       scratch,  by  Joao  Eriberto Mota Filho &lt;eriberto@debian.org&gt; for the Debian GNU/Linux system (but may be
       used by others).

nbtscan-1.6                                        16 Ago 2021                                        nbtscan(1)
</code></pre>
