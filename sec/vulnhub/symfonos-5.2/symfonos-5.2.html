<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>
/f0c1s/blog/sec/vulnhub/symfonos-5.2
</title>
<link rel="stylesheet" href="../../../index.css"/> <link rel="stylesheet" href="../../../highlight/styles/monokai.min.css"/>
<script src="../../../highlight/highlight.min.js"></script>
<script src="../../../setup.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body onload="setup()">
<h1>
/f0c1s/blog/sec/vulnhub/symfonos-5.2
</h1>
<nav>
<a href="../../../index.html">/blog</a> <a href="../../index.html">Security</a> <a href="../index.html">VulnHub</a> <a href="../../../sec/vulnhub/symfonos-5.2/symfonos-5.2.html">+ symfonos-5.2 - 2022.01.09 Sunday</a>
</nav>
<h2 id="description">Description</h2>
<blockquote>
<p>Beginner real life based machine designed to teach people the importance of understanding from the interior.</p>
<p>Tested on VMware and Virtualbox</p>
<p>## Changelog v1.2 - 2020-03-02 v1.0 - 2020-01-07</p>
</blockquote>
<p><a href="https://www.vulnhub.com/entry/symfonos-52,415/">VulnHub: https://www.vulnhub.com/entry/symfonos-52,415/</a> <a href="https://www.vulnhub.com/series/symfonos,217/">Series: https://www.vulnhub.com/series/symfonos,217/</a></p>
<figure>
<img src="0.running-boxes.png" alt="" /><figcaption>0.running-boxes</figcaption>
</figure>
<p>I am running all others(3.1, 4) because I wasnâ€™t able to finish them earlier this week.</p>
<h2 id="scanning">Scanning</h2>
<pre class="shell"><code>fping -aAqg 192.168.56.1/24 | tee fping.txt
192.168.56.1
192.168.56.2
192.168.56.70
192.168.56.92
192.168.56.93
192.168.56.94
</code></pre>
<pre class="shell"><code>sudo netdiscover -r 192.168.56.1/24 -i eth1 -PN
[sudo] password for f0c1s:
 192.168.56.1    0a:00:27:00:00:00      1      60  Unknown vendor
 192.168.56.2    08:00:27:67:bf:c2      1      60  PCS Systemtechnik GmbH
 192.168.56.92   08:00:27:d0:e8:29      1      60  PCS Systemtechnik GmbH
 192.168.56.93   08:00:27:45:ca:64      1      60  PCS Systemtechnik GmbH
 192.168.56.94   08:00:27:40:fb:1a      1      60  PCS Systemtechnik GmbH

-- Active scan completed, 5 Hosts found.
</code></pre>
<pre class="shell"><code>sudo arp-scan -I eth1 -l
Interface: eth1, type: EN10MB, MAC: 08:00:27:13:e5:7a, IPv4: 192.168.56.70
Starting arp-scan 1.9.7 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.56.1    0a:00:27:00:00:00       (Unknown: locally administered)
192.168.56.2    08:00:27:67:bf:c2       PCS Systemtechnik GmbH
192.168.56.93   08:00:27:45:ca:64       PCS Systemtechnik GmbH
192.168.56.94   08:00:27:40:fb:1a       PCS Systemtechnik GmbH
192.168.56.92   08:00:27:d0:e8:29       PCS Systemtechnik GmbH

5 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.9.7: 256 hosts scanned in 2.179 seconds (117.49 hosts/sec). 5 responded
</code></pre>
<pre class="shell"><code>nmap 192.168.56.1/24 -sn -n
Starting Nmap 7.92 ( https://nmap.org ) at 2022-01-08 09:46 IST
Nmap scan report for 192.168.56.70
Host is up (0.0016s latency).
Nmap scan report for 192.168.56.92
Host is up (0.0023s latency).
Nmap scan report for 192.168.56.93
Host is up (0.0020s latency).
Nmap scan report for 192.168.56.94
Host is up (0.0017s latency).
Nmap done: 256 IP addresses (4 hosts up) scanned in 2.40 seconds
</code></pre>
<p>Now there is no indication here about which IP belongs to symfonos 5.2</p>
<pre class="shell"><code>nmap 192.168.56.{92,93,94} -n -A
Starting Nmap 7.92 ( https://nmap.org ) at 2022-01-08 09:48 IST
Nmap scan report for 192.168.56.92
Host is up (0.00065s latency).
Not shown: 997 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
21/tcp open  ftp     ProFTPD 1.3.5b
22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)
| ssh-hostkey:
|   2048 cd:64:72:76:80:51:7b:a8:c7:fd:b2:66:fa:b6:98:0c (RSA)
|   256 74:e5:9a:5a:4c:16:90:ca:d8:f7:c7:78:e7:5a:86:81 (ECDSA)
|_  256 3c:e4:0b:b9:db:bf:01:8a:b7:9c:42:bc:cb:1e:41:6b (ED25519)
80/tcp open  http    Apache httpd 2.4.25 ((Debian))
|_http-title: Site doesn&#39;t have a title (text/html).
|_http-server-header: Apache/2.4.25 (Debian)
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Nmap scan report for 192.168.56.93
Host is up (0.0010s latency).
Not shown: 998 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.9p1 Debian 10 (protocol 2.0)
| ssh-hostkey:
|   2048 f9:c1:73:95:a4:17:df:f6:ed:5c:8e:8a:c8:05:f9:8f (RSA)
|   256 be:c1:fd:f1:33:64:39:9a:68:35:64:f9:bd:27:ec:01 (ECDSA)
|_  256 66:f7:6a:e8:ed:d5:1d:2d:36:32:64:39:38:4f:9c:8a (ED25519)
80/tcp open  http    Apache httpd 2.4.38 ((Debian))
|_http-title: Site doesn&#39;t have a title (text/html).
|_http-server-header: Apache/2.4.38 (Debian)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Nmap scan report for 192.168.56.94
Host is up (0.00072s latency).
Not shown: 996 closed tcp ports (conn-refused)
PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0)
| ssh-hostkey:
|   2048 16:70:13:77:22:f9:68:78:40:0d:21:76:c1:50:54:23 (RSA)
|   256 a8:06:23:d0:93:18:7d:7a:6b:05:77:8d:8b:c9:ec:02 (ECDSA)
|_  256 52:c0:83:18:f4:c7:38:65:5a:ce:97:66:f3:75:68:4c (ED25519)
80/tcp  open  http     Apache httpd 2.4.29 ((Ubuntu))
|_http-title: Site doesn&#39;t have a title (text/html).
|_http-server-header: Apache/2.4.29 (Ubuntu)
389/tcp open  ldap     OpenLDAP 2.2.X - 2.3.X
636/tcp open  ldapssl?
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 3 IP addresses (3 hosts up) scanned in 12.42 seconds
</code></pre>
<p>Going by earlier scans, I can tell that 94 is symfonos 5.2, but thatâ€™s not conclusive.</p>
<figure>
<img src="1.web-homepages.png" alt="" /><figcaption>1.web-homepages</figcaption>
</figure>
<p>Because I worked on <a href="../symfonos-3.1/symfonos-3.1.html" class="in">symfonos 3</a> and <a href="../symfonos-4/symfonos-4.html" class="in">symfonos 4</a>, I know that 94 is symfonos 5.2, but still no indication from the box itself.</p>
<p>This is an interesting problem, I guess I gotta hack them all.</p>
<h2 id="attacking-web">Attacking web</h2>
<pre class="shell"><code>nikto -C all -host http://$RHOST | tee nikto.txt
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          192.168.56.94
+ Target Hostname:    192.168.56.94
+ Target Port:        80
+ Start Time:         2022-01-08 09:58:00 (GMT5.5)
---------------------------------------------------------------------------
+ Server: Apache/2.4.29 (Ubuntu)
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ Apache/2.4.29 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.
+ Server may leak inodes via ETags, header found with file /, inode: cf, size: 59b7f675f3d40, mtime: gzip
+ Allowed HTTP Methods: HEAD, GET, POST, OPTIONS
+ Cookie PHPSESSID created without the httponly flag
+ OSVDB-29786: /admin.php?en_log_id=0&amp;action=config: EasyNews from http://www.webrc.ca version 4.3 allows remote admin access. This PHP file should be protected.
+ OSVDB-29786: /admin.php?en_log_id=0&amp;action=users: EasyNews from http://www.webrc.ca version 4.3 allows remote admin access. This PHP file should be protected.
+ OSVDB-3092: /admin.php: This might be interesting...
+ OSVDB-3268: /static/: Directory indexing found.
+ OSVDB-3233: /icons/README: Apache default file found.
+ 26522 requests: 0 error(s) and 12 item(s) reported on remote host
+ End Time:           2022-01-08 09:59:23 (GMT5.5) (83 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
</code></pre>
<pre class="shell"><code>gobuster dir --url http://$RHOST --wordlist=/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -b 404,403,400 -q -f --wildcard -x php,cgi,bak
/home.php             (Status: 302) [Size: 0] [--&gt; admin.php]
/static/              (Status: 200) [Size: 1744]
/admin.php            (Status: 200) [Size: 1650]
/logout.php           (Status: 302) [Size: 0] [--&gt; admin.php]
/portraits.php        (Status: 200) [Size: 165]
</code></pre>
<figure>
<img src="2.home-takes-to-admin.png" alt="" /><figcaption>2.home-takes-to-admin</figcaption>
</figure>
<figure>
<img src="3.portraits-of-le-gods.png" alt="" /><figcaption>3.portraits-of-le-gods</figcaption>
</figure>
<pre class="shell"><code>gobuster dir --url http://$RHOST/static -x jpg,png,cgi,py,txt,php,log,bak,zip --wordlist=/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -q -f
/zeus.jpg             (Status: 200) [Size: 500476]
</code></pre>
<p>This shows zeus.jpg, which is not on portraits, but it might be on the home page.</p>
<pre class="shell"><code>feroxbuster -q -u http://$RHOST/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt --rate-limit 100 -d 2 -L 4 -k -f
403        9l       28w      278c http://192.168.56.94/icons/
200       20l       96w     1744c http://192.168.56.94/static/
403        9l       28w      278c http://192.168.56.94/icons/small/
403        9l       28w      278c http://192.168.56.94/server-status/
WLD        9l       28w      278c Got 403 for http://192.168.56.94/server-status/15dc442e9d7943f39f40984eea3cc474/ (url length: 32)
WLD         -         -         - Wildcard response is static; auto-filtering 278 responses; toggle this behavior by using --dont-filter
WLD        9l       28w      278c Got 403 for http://192.168.56.94/server-status/fe1d9f6eb3634708a4618c0a140ef9045b0db6b334c145baa6e679b64b3b55cf64b99d6d0f8249bc94157024ec71be35/ (url length: 96)
ðŸš¨ Caught ctrl+c ðŸš¨ saving scan state to ferox-http_192_168_56_94_-1641617769.state ...
Scanning: http://192.168.56.94/
Scanning: http://192.168.56.94/icons/
Scanning: http://192.168.56.94/static/
Scanning: http://192.168.56.94/server-status/
</code></pre>
<figure>
<img src="4.static.png" alt="" /><figcaption>4.static</figcaption>
</figure>
<pre class="shell"><code>wget -q $RHOST/static/zeus{,1,2,3}.jpg
</code></pre>
<pre class="shell"><code>ls -la
total 792
drwxr-xr-x 2 f0c1s f0c1s   4096 Jan  8 10:29 .
drwxr-xr-x 7 f0c1s f0c1s   4096 Jan  8 09:46 ..
-rw-r--r-- 1 f0c1s f0c1s     82 Jan  8 09:46 fping.txt
-rw-r--r-- 1 f0c1s f0c1s   1728 Jan  8 09:59 nikto.txt
-rw-r--r-- 1 f0c1s f0c1s 173173 Jan  7  2020 zeus1.jpg
-rw-r--r-- 1 f0c1s f0c1s  48830 Jan  7  2020 zeus2.jpg
-rw-r--r-- 1 f0c1s f0c1s  64346 Jan  7  2020 zeus3.jpg
-rw-r--r-- 1 f0c1s f0c1s 500476 Oct  5  2017 zeus.jpg
</code></pre>
<pre class="shell"><code>exiftool zeus*
======== zeus1.jpg
ExifTool Version Number         : 12.36
File Name                       : zeus1.jpg
Directory                       : .
File Size                       : 169 KiB
File Modification Date/Time     : 2020:01:07 02:35:25+05:30
File Access Date/Time           : 2022:01:08 10:29:02+05:30
File Inode Change Date/Time     : 2022:01:08 10:29:02+05:30
File Permissions                : -rw-r--r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.02
Resolution Unit                 : None
X Resolution                    : 100
Y Resolution                    : 100
Quality                         : 60%
DCT Encode Version              : 100
APP14 Flags 0                   : [14], Encoded with Blend=1 downsampling
APP14 Flags 1                   : (none)
Color Transform                 : YCbCr
Image Width                     : 777
Image Height                    : 871
Encoding Process                : Progressive DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)
Image Size                      : 777x871
Megapixels                      : 0.677
======== zeus2.jpg
ExifTool Version Number         : 12.36
File Name                       : zeus2.jpg
Directory                       : .
File Size                       : 48 KiB
File Modification Date/Time     : 2020:01:07 02:35:25+05:30
File Access Date/Time           : 2022:01:08 10:29:02+05:30
File Inode Change Date/Time     : 2022:01:08 10:29:02+05:30
File Permissions                : -rw-r--r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.01
Resolution Unit                 : inches
X Resolution                    : 200
Y Resolution                    : 200
Image Width                     : 500
Image Height                    : 796
Encoding Process                : Progressive DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)
Image Size                      : 500x796
Megapixels                      : 0.398
======== zeus3.jpg
ExifTool Version Number         : 12.36
File Name                       : zeus3.jpg
Directory                       : .
File Size                       : 63 KiB
File Modification Date/Time     : 2020:01:07 02:35:25+05:30
File Access Date/Time           : 2022:01:08 10:29:02+05:30
File Inode Change Date/Time     : 2022:01:08 10:29:02+05:30
File Permissions                : -rw-r--r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.01
Resolution Unit                 : inches
X Resolution                    : 72
Y Resolution                    : 72
Image Width                     : 750
Image Height                    : 452
Encoding Process                : Progressive DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)
Image Size                      : 750x452
Megapixels                      : 0.339
======== zeus.jpg
ExifTool Version Number         : 12.36
File Name                       : zeus.jpg
Directory                       : .
File Size                       : 489 KiB
File Modification Date/Time     : 2017:10:05 02:34:05+05:30
File Access Date/Time           : 2022:01:08 10:29:02+05:30
File Inode Change Date/Time     : 2022:01:08 10:29:02+05:30
File Permissions                : -rw-r--r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.01
Resolution Unit                 : None
X Resolution                    : 1
Y Resolution                    : 1
Image Width                     : 1920
Image Height                    : 1080
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)
Image Size                      : 1920x1080
Megapixels                      : 2.1
    4 image files read
</code></pre>
</body>
</html>
