<meta charset="UTF-8">
<link rel="stylesheet" href="../../../../index.css"/>
<link rel="stylesheet" href="../../../../highlight/styles/monokai.min.css"/>
<script src="../../../../highlight/highlight.min.js"></script>
<script>hljs.highlightAll();</script>

<h1 id="aotw-warmup-2021.12.02">/f0c1s/blog/sec/OTW/advent2021/warmup/</h1>
<p>
    <a href="../../../../index.html">/blog</a>
    <a href="../../../../sec/index.html">Security</a>
    <a href="../../../../sec/OTW/index.html">OverTheWire writeups</a>
    <a href="../../../../sec/OTW/advent2021/index.html">advent 2021</a>
    <a href="../../../../sec/OTW/advent2021/warmup/index.html">+ warmup</a>
</p>
<p>I should be sleeping. But here I am.</p>
<p>It starts with a missing image.</p>
<figure>
    <img src="a.png" alt=""/>
    <figcaption>missing image, can you see it</figcaption>
</figure>
<p>It links to <a
        href="https://pbs.twimg.com/media/FFbEREBWQAAsjFk.png">https://pbs.twimg.com/media/FFbEREBWQAAsjFk.png</a></p>
<p>The image that was not showing up.</p>
<figure>
    <img src="b.png" alt=""/>
    <figcaption>The image that was not showing up.</figcaption>
</figure>
<pre class="shell"><code>ls -lAh
total 116K
-rw-r--r-- 1 f0c1s f0c1s 113K Dec  2 12:39 FFbEREBWQAAsjFk.png

file FFbEREBWQAAsjFk.png
FFbEREBWQAAsjFk.png: PNG image data, 511 x 339, 8-bit colormap, non-interlaced</code></pre>
<pre><code class="language-shell">hexeditor -b FFbEREBWQAAsjFk.png</code></pre>
<figure>
    <img src="c.hexeditor.png" alt=""/>
    <figcaption>c.hexeditor.png</figcaption>
</figure>
<p>Notice “Booting Stage0”, “Loading Stage1” etc…</p>
<pre><code>exiftool FFbEREBWQAAsjFk.png
ExifTool Version Number         : 12.34
File Name                       : FFbEREBWQAAsjFk.png
Directory                       : .
File Size                       : 113 KiB
File Modification Date/Time     : 2021:12:02 12:39:58+05:30
File Access Date/Time           : 2021:12:02 12:40:18+05:30
File Inode Change Date/Time     : 2021:12:02 12:39:58+05:30
File Permissions                : -rw-r--r--
File Type                       : PNG
File Type Extension             : png
MIME Type                       : image/png
Image Width                     : 511
Image Height                    : 339
Bit Depth                       : 8
Color Type                      : Palette
Compression                     : Deflate/Inflate
Filter                          : Adaptive
Interlace                       : Noninterlaced
Palette                         : (Binary data 768 bytes, use -b option to extract)
Image Size                      : 511x339
Megapixels                      : 0.173</code></pre>
<pre><code>exiftool -b FFbEREBWQAAsjFk.png | tee FFbEREBWQAAsjFk.png.binary
...</code></pre>
<figure>
    <img src="d.png" alt=""/>
    <figcaption>exiftool -b FFbEREBWQAAsjFk.png | tee FFbEREBWQAAsjFk.png.binary</figcaption>
</figure>
<pre><code class="language-shell">hexeditor -b FFbEREBWQAAsjFk.png.binary</code></pre>
<figure>
    <img src="e.png" alt=""/>
    <figcaption>hexeditor -b binary</figcaption>
</figure>
<pre><code>file FFbEREBWQAAsjFk.png.binary
FFbEREBWQAAsjFk.png.binary: data</code></pre>
<h2>
    <p>strings in the image</p>
</h2>
<pre><code>strings FFbEREBWQAAsjFk.png | less</code></pre>
<figure>
    <img src="fa.png" alt=""/>
    <figcaption>fa.png</figcaption>
</figure>
<figure>
    <img src="fb.png" alt=""/>
    <figcaption>fb.png</figcaption>
</figure>
<h2>
    <pre><code class="language-shell">foremost -i FFbEREBWQAAsjFk.png</code> doesn’t reveal anything.</pre>
</h2>
<h2>
    <p>stegextrat is useless</p>
</h2>
<pre><code>stegextract FFbEREBWQAAsjFk.png
Detected image format: PNG
No trailing data found in file
Performing deep analysis
Done</code></pre>
<h2>
    <p>base64 encoded string in the image</p>
</h2>
<pre class="shell"><code>echo -n &quot;VGhlIGFuc3dlciBpcyBGUk9HUw==&quot; | base64 -d
The answer is FROGS</code></pre>
<p><img src="g.png"/></p>
<h2>
    <p>binwalk</p>
</h2>
<pre><code>binwalk FFbEREBWQAAsjFk.png

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             PNG image, 511 x 339, 8-bit colormap, non-interlaced
821           0x335           Zlib compressed data, best compression</code></pre>
<p><img src="h.png"/></p>
<pre><code>binwalk -e FFbEREBWQAAsjFk.png

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             PNG image, 511 x 339, 8-bit colormap, non-interlaced
821           0x335           Zlib compressed data, best compression



ls -lAhR
.:
total 120K
-rw-r--r-- 1 f0c1s f0c1s 113K Dec  2 13:28 FFbEREBWQAAsjFk.png
drwxr-xr-x 2 f0c1s f0c1s 4.0K Dec  2 13:31 _FFbEREBWQAAsjFk.png.extracted

./_FFbEREBWQAAsjFk.png.extracted:
total 288K
-rw-r--r-- 1 f0c1s f0c1s 170K Dec  2 13:31 335
-rw-r--r-- 1 f0c1s f0c1s 113K Dec  2 13:31 335.zlib
</code></pre>
<p><img src="i.png"/></p>
<h2>
    <p>zlib-flate</p>
</h2>
<pre><code>sudo apt install qpdf

Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following additional packages will be installed:
  libqpdf28
The following NEW packages will be installed:
  libqpdf28 qpdf
0 upgraded, 2 newly installed, 0 to remove and 1 not upgraded.
Need to get 1,218 kB of archives.
After this operation, 3,400 kB of additional disk space will be used.
Do you want to continue? [Y/n]
Get:1 https://mirror.anigil.com/kali kali-rolling/main amd64 libqpdf28 amd64 10.3.2-2 [629 kB]
Get:2 https://mirror.anigil.com/kali kali-rolling/main amd64 qpdf amd64 10.3.2-2 [589 kB]
Fetched 1,218 kB in 4s (340 kB/s)
Selecting previously unselected package libqpdf28:amd64.
(Reading database ... 651632 files and directories currently installed.)
Preparing to unpack .../libqpdf28_10.3.2-2_amd64.deb ...
Unpacking libqpdf28:amd64 (10.3.2-2) ...
Selecting previously unselected package qpdf.
Preparing to unpack .../qpdf_10.3.2-2_amd64.deb ...
Unpacking qpdf (10.3.2-2) ...
Setting up libqpdf28:amd64 (10.3.2-2) ...
Setting up qpdf (10.3.2-2) ...
Processing triggers for libc-bin (2.32-4) ...
Processing triggers for man-db (2.9.4-2) ...
Processing triggers for kali-menu (2021.4.2) ...</code></pre>
<pre><code>zlib-flate -uncompress &lt; _FFbEREBWQAAsjFk.png.extracted/335.zlib &gt; deflated


file deflated
deflated: data


f0c1s@kali:~/OTW/advent2021 $
ls -lAh
total 292K
-rw-r--r-- 1 f0c1s f0c1s 170K Dec  2 13:33 deflated
-rw-r--r-- 1 f0c1s f0c1s 113K Dec  2 13:28 FFbEREBWQAAsjFk.png
drwxr-xr-x 2 f0c1s f0c1s 4.0K Dec  2 13:31 _FFbEREBWQAAsjFk.png.extracted</code></pre>
<p><img src="j.png"/></p>
<p><img src="k.png"/></p>
<pre><code>binwalk deflated

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------</code></pre>
<pre><code>Initialising Quiz...
Somebody toucha my spaghet!
Wrong answer :(

    Welcome to the


  OverTheWire Advent Bonanza 2021


     Warmup Quiz


        Question n of 8:
        You answered:
Congrats! Here&#39;s your flag:

Output updated. No further input required, for now.
Provide input:
        What is my favourite colour?
        Who is my favourite reindeer?
        VGhlIGFuc3dlciBpcyBGUk9HUw==
        Jung vf guvf pvcure pnyyrq?
        What is 123
?
        Which cipher encrypted the flag?
        What&#39;s my favourite 7-digit prime?
        What&#39;s my password? (Hint: rockyou)</code></pre>
<p><img src="l.png"/></p>
<pre><code>echo -n &quot;VGhlIGFuc3dlciBpcyBGUk9HUw==&quot; | base64 -d
The answer is FROGS</code></pre>
<p>We have already seen this earlier.</p>
<h2>
    <p>mount-qemu.sh</p>
</h2>
<pre class="shell"><code>#!/bin/bash

# from: https://www.cloudsavvyit.com/7517/how-to-mount-a-qemu-virtual-disk-image/

# usage: qemu-mount {imagefile}
# 1st argument: QEMU raw image file

if [ $# -ne 1 ] ; then
  echo &#39;usage: qemu-mount imagefile&#39;
  echo &#39;Mounts a QEMU raw image file to /tmp/dos&#39;
  exit 1
fi

start=$( fdisk -l -o Device,Start ${1} | grep &quot;^${1}1&quot; | gawk &#39;{print $2}&#39; )
sectors=$( fdisk -l ${1} | grep &#39;^Units: sectors of&#39; | gawk &#39;{print $(NF-1)}&#39; )
offset=$(( $start * $sectors ))

[ -d /tmp/dos ] || mkdir /tmp/dos
sudo mount -o loop,offset=$offset ${1} /tmp/dos</code></pre>
<p>This didn’t work.</p>
<h2>
    <p>radare2</p>
</h2>
<pre><code>rabin2 -I ./deflated
arch     x86
baddr    0x0
binsz    173568
bintype  bios
bits     16
canary   false
retguard false
class    1.0
crypto   false
endian   little
havecode true
laddr    0x0
linenum  false
lsyms    false
machine  pc
maxopsz  16
minopsz  1
nx       false
os       any
pcalign  0
pic      false
relocs   false
sanitiz  false
static   true
stripped false
subsys   unknown
va       true</code></pre>
<p><img src="m.png"/></p>
<h2>
    <p>zsteg</p>
</h2>
<pre><code>zsteg -a FFbEREBWQAAsjFk.png
imagedata           .. text: &quot;?3?0000p&quot;
b5,g,msb,xy         .. text: &quot;\t|94f^&amp;\&quot;x&quot;
b8,r,msb,xy         .. text: &quot;z\tMT\tM=z&quot;
b1,b,lsb,xy,prime   .. text: &quot;o\rC\t @5r\n&quot;
b2,g,lsb,xy,prime   .. text: &quot;EUUUAUUUIUUP&quot;
b2,g,msb,xy,prime   .. text: &quot;jUUUUUUUUUWUuU&quot;
b3,b,lsb,xy,prime   .. text: &quot;\nOw\\ ?@\n&quot;
b4,rgb,lsb,xy,prime .. file: Intel ia64 COFF object file, not stripped, 64850 sections, symbol offset=0x5fd0fc00, 822083584 symbols, optional header size 4064
b4,bgr,lsb,xy,prime .. file: Intel ia64 COFF object file, not stripped, 60754 sections, symbol offset=0x50ffdc00, -520093696 symbols, optional header size 63
b5,rgb,lsb,xy,prime .. file: raw G3 (Group 3) FAX, byte-padded
b8,r,msb,xy,prime   .. text: [&quot;\t&quot; repeated 25 times]
b8,g,msb,xy,prime   .. text: &quot;w6\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t&quot;
b8,b,msb,xy,prime   .. text: [&quot;\t&quot; repeated 25 times]
b8,rgb,msb,xy,prime .. text: [&quot;\t&quot; repeated 40 times]
b8,bgr,msb,xy,prime .. text: [&quot;\t&quot; repeated 40 times]
b1,g,msb,yx         .. file: PGP Secret Sub-key -
b2,g,lsb,yx         .. text: &quot;UWuT}1Up&quot;
b2,rgb,lsb,yx       .. text: &quot;S%\nS%2\&quot;s&quot;
b2,rgb,msb,yx       .. text: &quot;#F|D&lt;@DuJ&quot;
b3,rgb,lsb,yx       .. text: &quot;\t(kZ+}jh&quot;
b4,r,lsb,yx         .. file: Novell LANalyzer capture file
b4,g,lsb,yx         .. file: Motorola S-Record; binary data in text format
b4,b,msb,yx         .. text: &quot;tuLDu%#TTrRrr&quot;
b5,b,lsb,yx         .. file: zlib compressed data
b8,r,lsb,yx         .. text: [&quot;I&quot; repeated 8 times]
b8,g,lsb,yx         .. text: &quot;u{u{uuuuu&quot;
b8,b,lsb,yx         .. text: &quot;u{u{uuuuu&quot;
b8,b,msb,yx         .. text: &quot;EEEYyY-3-EYIY)y)Y)y)y5&quot;
b8,rgb,lsb,yx       .. text: &quot;uoas as &quot;
b8,rgb,msb,yx       .. text: &quot;\&quot;e\t\t\t\t\t\twBB&quot;
b8,bgr,msb,yx       .. text: &quot;\t\t\t\t\t\tBBw&quot;
b4,g,msb,yx,prime   .. text: &quot;\r7CMrK~;3~&quot;
b4,b,msb,yx,prime   .. text: &quot;]JB}\&quot;z #E3;&quot;
b4,rgb,lsb,yx,prime .. file: Spectrum .TAP data &quot;\017w\342 &quot; - BASIC program
b8,r,lsb,yx,prime   .. text: &quot;-FXG-DG7&gt;0X&quot;
b8,b,msb,yx,prime   .. text: &quot;y)y#-)5-&quot;
b8,bgr,lsb,yx,prime .. text: &quot;k68k68ou&quot;
b4,g,msb,XY         .. text: &quot;33{;3s;73s&quot;
b4,b,lsb,XY         .. text: &quot;DT[ED[KMK&quot;
b6,r,lsb,XY         .. text: &quot;)aJXtzZa&quot;
b6,b,lsb,XY         .. text: &quot;M5#A5#L4&quot;
b8,r,lsb,XY         .. text: &quot;ZXZZTZZGXTXXXXvv&quot;
b8,r,msb,XY         .. text: &quot;*ZZZZZZZZZ&quot;
b8,g,msb,XY         .. text: &quot;333s3333s3&quot;
b2,b,lsb,XY,prime   .. text: &quot;{xUX[ETj5D&quot;
b3,rgb,lsb,XY,prime .. file: BIOS (ia32) ROM Ext. (213*512)
b5,b,msb,XY,prime   .. text: &quot;M)m@60uok&quot;
b7,b,lsb,XY,prime   .. text: &quot;6m(/b;wJ$F&quot;
b8,r,lsb,XY,prime   .. text: &quot;XZZTZQQTZXZZGZv&quot;
b8,b,msb,XY,prime   .. text: &quot;######M3K&quot;
b4,r,lsb,YX         .. text: &quot;Agt\&quot;(hhhffqgw&amp;$&quot;
b4,g,lsb,YX         .. text: &quot;{UUUUUEU&quot;
b4,b,lsb,YX         .. text: &quot;ZUUUUU\&quot;\&quot;&quot;
b5,r,lsb,YX         .. text: &quot;?LJcD&amp;-k&quot;
b8,r,lsb,YX         .. text: &quot;ZQZXDXTXZQZQZQZTZQZQZQZT:&quot;
b8,g,lsb,YX         .. text: [&quot;u&quot; repeated 8 times]
b8,b,lsb,YX         .. text: [&quot;u&quot; repeated 8 times]
b8,b,msb,YX         .. text: &quot;33K3333#&quot;
b1,g,lsb,YX,prime   .. text: &quot;D=dy|Isy\r&quot;
b1,b,msb,YX,prime   .. text: &quot;_t&#39;N\&quot;zEu&quot;
b8,r,lsb,YX,prime   .. text: &quot;ZXXXQQQQTZZQGZv&quot;
b8,b,msb,YX,prime   .. text: &quot;-333K-A-&quot;
b2,g,lsb,Xy         .. text: &quot;0@xA&lt;?a4&quot;
b3,r,msb,Xy         .. file: Apple DiskCopy 4.2 image , 1002373632 bytes, 0x2011561c tag size, GCR CLV ssdd (400k), 0x84 format
b7,r,msb,Xy         .. text: &quot;[.BnJ 4~&quot;
b8,r,msb,Xy         .. text: [&quot;\t&quot; repeated 149 times]
b8,g,msb,Xy         .. text: [&quot;\t&quot; repeated 149 times]
b8,b,msb,Xy         .. text: [&quot;\t&quot; repeated 149 times]
b3,g,msb,Xy,prime   .. text: &quot;-Lx):+CK&quot;
b8,r,msb,Xy,prime   .. text: [&quot;\t&quot; repeated 34 times]
b8,g,msb,Xy,prime   .. text: [&quot;\t&quot; repeated 34 times]
b8,b,msb,Xy,prime   .. text: [&quot;\t&quot; repeated 34 times]
b8,rgb,msb,Xy,prime .. text: [&quot;\t&quot; repeated 102 times]
b8,bgr,msb,Xy,prime .. text: [&quot;\t&quot; repeated 102 times]
b2,b,lsb,yX         .. text: &quot;w,]aSuHrsqt&quot;
b4,r,lsb,yX         .. text: &quot;222 7w@ &quot;
b4,g,lsb,yX         .. text: &quot;UEUUUU[w&quot;
b4,g,msb,yX         .. text: &quot;ss3s33w37&quot;
b4,b,lsb,yX         .. text: &quot;\&quot;%UUUUZT&quot;
b4,b,msb,yX         .. text: &quot;Wyy3wu\&quot;rw&quot;
b8,r,lsb,yX         .. text: &quot;\&quot;GggQQXQgvX:&quot;
b8,r,msb,yX         .. text: [&quot;\t&quot; repeated 13 times]
b8,g,lsb,yX         .. text: [&quot;u&quot; repeated 9 times]
b8,g,msb,yX         .. text: [&quot;\t&quot; repeated 13 times]
b8,b,lsb,yX         .. text: &quot;ouououuuu&quot;
b8,b,msb,yX         .. text: &quot;\t\t\t\t\t\t\t\t\t\t\t\t\t(&quot;
b8,rgb,msb,yX       .. text: [&quot;\t&quot; repeated 39 times]
b8,bgr,msb,yX       .. text: &quot;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(&quot;
b1,rgb,lsb,yX,prime .. file: raw G3 (Group 3) FAX, byte-padded
b3,r,lsb,yX,prime   .. file: raw G3 (Group 3) FAX, byte-padded
b3,g,lsb,yX,prime   .. file: raw G3 (Group 3) FAX, byte-padded
b3,b,lsb,yX,prime   .. file: raw G3 (Group 3) FAX, byte-padded
b3,b,msb,yX,prime   .. text: &quot;b7@[IRe&#39;&quot;
b5,b,lsb,yX,prime   .. text: &quot;=\&quot;RUc%!NR};&quot;
b6,rgb,lsb,yX,prime .. text: &quot;eS/]g9%7&quot;
b8,r,lsb,yX,prime   .. text: &quot;iTZXZXXTDXTX&quot;
b8,b,msb,yX,prime   .. text: &quot;A-YyyyYAI&quot;
b8,rgb,msb,yX,prime .. text: [&quot;\t&quot; repeated 15 times]
b8,bgr,lsb,yX,prime .. text: &quot;k68k68uu&quot;
b8,bgr,msb,yX,prime .. text: &quot;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(&quot;
b2,r,msb,xY         .. text: &quot;:jAVIhacUVU&quot;
b2,b,lsb,xY         .. text: &quot;@bTeeY%R&quot;
b3,rgb,msb,xY       .. text: &quot;QMTu^ @T&quot;
b4,g,msb,xY         .. text: &quot;;33733s3{33&quot;
b4,b,lsb,xY         .. text: &quot;TKDDPTD]&quot;
b8,r,lsb,xY         .. text: &quot;ZQZQZZZZXTQZQXXZZZQZXXQTZQQZZXXQXXTXXTXTZXQTXQXQGQZXXXXGXiTiXvv&quot;
b8,g,msb,xY         .. text: &quot;33333s333333s33&quot;
b2,r,msb,xY,prime   .. text: &quot;S\nTT\tP?y&quot;
b2,g,lsb,xY,prime   .. text: &quot;0P!E1A*WP&quot;
b4,b,lsb,xY,prime   .. text: &quot;K][T,DMKEK&quot;
b5,bgr,msb,xY,prime .. text: &quot;0j/)]c[r&quot;
b8,r,lsb,xY,prime   .. text: &quot;ZQZZZXZZTXQTXTQXiv&quot;
b1,r,msb,Yx         .. text: &quot;]K\r` \n&#39;Y&amp;\n&quot;
b2,r,lsb,Yx         .. file: GPG encrypted data
b2,rgb,lsb,Yx       .. text: &quot;4mu&gt;r2S%\nS%\n(&quot;
b2,rgb,msb,Yx       .. text: &quot;:q]Wr]c2&quot;
b4,g,lsb,Yx         .. file: Certificate
b4,b,msb,Yx         .. text: &quot;CCCCCt:3=:&quot;
b8,r,lsb,Yx         .. text: &quot;ZXQiTXTZQQTZQZQQQTDDQZQ]Z]TQZGZTXQXQgg]]igv&quot;
b8,r,msb,Yx         .. text: &quot;b*nnnZ\&quot;*nn&quot;
b8,g,lsb,Yx         .. text: &quot;{uu{uuuuu&quot;
b8,b,lsb,Yx         .. text: &quot;{oo{uuuuu&quot;
b8,b,msb,Yx         .. text: &quot;3K3K3K3K3KMy&quot;
b2,rgb,msb,Yx,prime .. text: &quot;XJ\&quot;R\&quot;@DT&quot;
b4,b,lsb,Yx,prime   .. text: &quot;$$L\&quot;/RS%&quot;
b4,b,msb,Yx,prime   .. text: &quot;DC0K+s4777\&quot;CD&quot;
b8,r,lsb,Yx,prime   .. text: &quot;QiXZZZTD]GTgg&quot;
b8,b,msb,Yx,prime   .. text: &quot;#5yI3y5y5y5-#5KKEA&quot;</code></pre>
<p><img src="na.png"/></p>
<p><img src="nb.png"/></p>
<p><img src="nc.png"/></p>
<pre><code>zsteg -E b3,rgb,lsb,XY,prime FFbEREBWQAAsjFk.png &gt; rom

file rom
rom: BIOS (ia32) ROM Ext. (213*512)

rabin2 -I ./rom
baddr    0x0
binsz    17743
bits     0
canary   false
crypto   false
endian   little
havecode false
laddr    0x0
linenum  false
lsyms    false
maxopsz  16
minopsz  1
nx       false
pcalign  0
pic      false
relocs   false
sanitiz  false
static   true
stripped false
va       false</code></pre>
<pre><code>zsteg -E b1,g,msb,yx FFbEREBWQAAsjFk.png &gt; secret-sub-key

file secret-sub-key
secret-sub-key: PGP Secret Sub-key -
</code></pre>
