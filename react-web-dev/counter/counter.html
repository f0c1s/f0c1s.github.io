<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>
/f0c1s/blog/react-web-dev/counter
</title>
<link rel="stylesheet" href="../../index.css"/> <link rel="stylesheet" href="../../highlight/styles/monokai.min.css"/>
<script src="../../setup.js"></script>
<script src="../../highlight/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="aoc 2021 aoc2021" onload="setup()">
<h1>
/f0c1s/blog/react-web-dev/counter
</h1>
<nav>
<a href="../../index.html">/blog</a> <a href="../../react-web-dev/index.html">react web dev</a> <a href="../../react-web-dev/counter/counter.html">+ counter</a>
</nav>
<h2 id="plain-react">Plain react</h2>
<pre class="shell"><code>yarn create react-app counter-1 --template typescript
cd counter-1
yarn start</code></pre>
<figure>
<img src="1.running-app.png" alt="" /><figcaption>1.running-app</figcaption>
</figure>
<figure>
<img src="2.project.png" alt="" /><figcaption>2.project</figcaption>
</figure>
<h3 id="making-changes-to-existing-project">Making changes to existing project</h3>
<h4 id="app.css">App.css</h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a>h1 {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>    <span class="kw">margin</span>: <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a>    <span class="kw">color</span>: <span class="cn">red</span><span class="op">;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a>    <span class="kw">background-color</span>: <span class="cn">#333</span><span class="op">;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a>    <span class="kw">padding</span>: <span class="dv">1</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a>    <span class="kw">font-weight</span>: <span class="dv">bold</span><span class="op">;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a>    <span class="kw">text-shadow</span>: <span class="dv">2</span><span class="dt">px</span> <span class="dv">2</span><span class="dt">px</span> <span class="dv">2</span><span class="dt">px</span> <span class="cn">black</span><span class="op">;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a>    <span class="kw">text-transform</span>: <span class="dv">uppercase</span><span class="op">;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a>}</span></code></pre></div>
<h4 id="app.tsx">App.tsx</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="im">import</span> React from <span class="st">&#39;react&#39;</span><span class="op">;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="im">import</span> <span class="st">&#39;./App.css&#39;</span><span class="op">;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a><span class="kw">function</span> <span class="fu">App</span>() {</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a>  <span class="fu">return</span> (</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a>    <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;App&quot;</span><span class="op">&gt;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a>      <span class="op">&lt;</span>h1<span class="op">&gt;</span>counter <span class="dv">1</span><span class="op">&lt;/</span>h1<span class="op">&gt;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a>    <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a>  )<span class="op">;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a>}</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a>export default App<span class="op">;</span></span></code></pre></div>
<h3 id="introducing-components-counter-and-counter-display">Introducing components counter and counter-display</h3>
<figure>
<img src="3.first-final.png" alt="" /><figcaption>3.first-final</figcaption>
</figure>
<figure>
<img src="4.file-structure.png" alt="" /><figcaption>4.file-structure</figcaption>
</figure>
<h4 id="app.tsx-1">App.tsx</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="im">import</span> React from <span class="st">&#39;react&#39;</span><span class="op">;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="im">import</span> <span class="st">&#39;./App.css&#39;</span><span class="op">;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="im">import</span> Counter from <span class="st">&quot;./components/counter/counter&quot;</span><span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a><span class="kw">function</span> <span class="fu">App</span>() {</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a>    <span class="fu">return</span> (</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a>        <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;App&quot;</span><span class="op">&gt;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a>            <span class="op">&lt;</span>h1<span class="op">&gt;</span>counter <span class="dv">1</span><span class="op">&lt;/</span>h1<span class="op">&gt;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a>            <span class="op">&lt;</span>Counter<span class="op">/&gt;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a>        <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a>    )<span class="op">;</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a>}</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true"></a>export default App<span class="op">;</span></span></code></pre></div>
<h4 id="componentscountercounter.tsx">components/counter/counter.tsx</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="im">import</span> React<span class="op">,</span> {useState} from <span class="st">&quot;react&quot;</span><span class="op">;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a><span class="im">import</span> <span class="st">&quot;./counter.css&quot;</span><span class="op">;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a><span class="im">import</span> CounterDisplay from <span class="st">&quot;../counter-display/counter-display&quot;</span><span class="op">;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a>export default <span class="kw">function</span> <span class="fu">Counter</span>() {</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a>    const [count<span class="op">,</span> setCount] <span class="op">=</span> <span class="fu">useState</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a>    <span class="fu">return</span> (</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a>        <span class="op">&lt;</span>div className<span class="op">=</span>{<span class="st">&quot;counter&quot;</span>}<span class="op">&gt;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a>            <span class="op">&lt;</span>CounterDisplay count<span class="op">=</span>{count}<span class="op">/&gt;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a>            <span class="op">&lt;</span>div className<span class="op">=</span>{<span class="st">&quot;coutner-actions&quot;</span>}<span class="op">&gt;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a>                <span class="op">&lt;</span>button onClick<span class="op">=</span>{() <span class="kw">=&gt;</span> <span class="fu">setCount</span>(count <span class="op">+</span> <span class="dv">1</span>)}<span class="op">&gt;</span>increment<span class="op">&lt;/</span>button<span class="op">&gt;</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true"></a>                <span class="op">&lt;</span>button onClick<span class="op">=</span>{() <span class="kw">=&gt;</span> <span class="fu">setCount</span>(count <span class="op">-</span> <span class="dv">1</span>)}<span class="op">&gt;</span>decrement<span class="op">&lt;/</span>button<span class="op">&gt;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true"></a>            <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true"></a>        <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true"></a>    )<span class="op">;</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true"></a>}</span></code></pre></div>
<h4 id="componentscountercounter.css">components/counter/counter.css</h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="fu">.counter</span> {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>    <span class="kw">margin</span>: <span class="dv">1</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>    <span class="kw">padding</span>: <span class="dv">1</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>    <span class="kw">position</span>: <span class="dv">relative</span><span class="op">;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a>}</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a><span class="fu">.counter</span><span class="in">::before</span> {</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a>    <span class="kw">content</span>: <span class="st">&quot;counter&quot;</span><span class="op">;</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true"></a>    <span class="kw">font-size</span>: <span class="dv">12</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true"></a>    <span class="kw">position</span>: <span class="dv">absolute</span><span class="op">;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true"></a>    <span class="kw">top</span>: <span class="dv">0</span><span class="op">;</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true"></a>    <span class="kw">left</span>: <span class="dv">0</span><span class="op">;</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true"></a>    <span class="kw">transform</span>: <span class="fu">rotate(</span><span class="dv">-7</span><span class="dt">deg</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true"></a>}</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true"></a><span class="fu">.counter</span> button {</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true"></a>    <span class="kw">padding</span>: <span class="dv">1</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true"></a>    <span class="kw">margin</span>: <span class="dv">1</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true"></a>    <span class="kw">cursor</span>: <span class="dv">pointer</span><span class="op">;</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true"></a>}</span></code></pre></div>
<h4 id="componentscountercounter-display.tsx">components/counter/counter-display.tsx</h4>
<div class="sourceCode" id="cb7"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="im">import</span> React from <span class="st">&quot;react&quot;</span><span class="op">;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="im">import</span> <span class="st">&quot;./counter-display.css&quot;</span><span class="op">;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a><span class="kw">type</span> CountDisplayPropT <span class="op">=</span> {</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a>    count<span class="op">:</span> <span class="dt">number</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a>}</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a>export default <span class="kw">function</span> <span class="fu">CounterDisplay</span>({count}<span class="op">:</span> CountDisplayPropT) {</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true"></a>    <span class="fu">return</span> (<span class="op">&lt;</span>div className<span class="op">=</span>{<span class="st">&quot;counter-value&quot;</span>}<span class="op">&gt;</span>{count}<span class="op">&lt;/</span>div<span class="op">&gt;</span>)<span class="op">;</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true"></a>}</span></code></pre></div>
<h4 id="componentscountercounter-display.css">components/counter/counter-display.css</h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="fu">.counter-value</span> {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>    <span class="kw">padding</span>: <span class="dv">1</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>    <span class="kw">margin</span>: <span class="dv">1</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a>    <span class="kw">font-size</span>: <span class="dv">48</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a>}</span></code></pre></div>
<h3 id="moving-state-outside-of-components-to-the-main-app-component">Moving state outside of components to the main App component</h3>
<figure>
<img src="5.App-component-has-state-now.png" alt="" /><figcaption>5.App-component-has-state-now</figcaption>
</figure>
<p>With same structure, here is the code:</p>
<h4 id="app.tsx-2">App.tsx</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="im">import</span> React<span class="op">,</span> {useState} from <span class="st">&#39;react&#39;</span><span class="op">;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a><span class="im">import</span> <span class="st">&#39;./App.css&#39;</span><span class="op">;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a><span class="im">import</span> Counter from <span class="st">&quot;./components/counter/counter&quot;</span><span class="op">;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a><span class="kw">function</span> <span class="fu">App</span>() {</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a>    const [count<span class="op">,</span> setCount] <span class="op">=</span> <span class="fu">useState</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a>    <span class="fu">return</span> (</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true"></a>        <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;App&quot;</span><span class="op">&gt;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true"></a>            <span class="op">&lt;</span>h1<span class="op">&gt;</span>counter <span class="dv">1</span><span class="op">&lt;/</span>h1<span class="op">&gt;</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true"></a>            <span class="op">&lt;</span>Counter count<span class="op">=</span>{count} setCount<span class="op">=</span>{setCount}<span class="op">/&gt;</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true"></a>        <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true"></a>    )<span class="op">;</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true"></a>}</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true"></a>export default App<span class="op">;</span></span></code></pre></div>
<p>Notice the state is here now, and so is the function that updates it.</p>
<h4 id="componentscountercounter.tsx-1">components/counter/counter.tsx</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="im">import</span> React from <span class="st">&quot;react&quot;</span><span class="op">;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a><span class="im">import</span> <span class="st">&quot;./counter.css&quot;</span><span class="op">;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a><span class="im">import</span> CounterDisplay from <span class="st">&quot;../counter-display/counter-display&quot;</span><span class="op">;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a><span class="kw">type</span> CounterPropT <span class="op">=</span> {</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a>    count<span class="op">:</span> <span class="dt">number</span><span class="op">;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a>    setCount<span class="op">:</span> Function<span class="op">;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true"></a>}</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true"></a>export default <span class="kw">function</span> <span class="fu">Counter</span>({count<span class="op">,</span> setCount}<span class="op">:</span> CounterPropT) {</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true"></a>    <span class="fu">return</span> (</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true"></a>        <span class="op">&lt;</span>div className<span class="op">=</span>{<span class="st">&quot;counter&quot;</span>}<span class="op">&gt;</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true"></a>            <span class="op">&lt;</span>CounterDisplay count<span class="op">=</span>{count}<span class="op">/&gt;</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true"></a>            <span class="op">&lt;</span>div className<span class="op">=</span>{<span class="st">&quot;coutner-actions&quot;</span>}<span class="op">&gt;</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true"></a>                <span class="op">&lt;</span>button onClick<span class="op">=</span>{() <span class="kw">=&gt;</span> <span class="fu">setCount</span>(count <span class="op">+</span> <span class="dv">1</span>)}<span class="op">&gt;</span>increment<span class="op">&lt;/</span>button<span class="op">&gt;</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true"></a>                <span class="op">&lt;</span>button onClick<span class="op">=</span>{() <span class="kw">=&gt;</span> <span class="fu">setCount</span>(count <span class="op">-</span> <span class="dv">1</span>)}<span class="op">&gt;</span>decrement<span class="op">&lt;/</span>button<span class="op">&gt;</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true"></a>            <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true"></a>        <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true"></a>    )<span class="op">;</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true"></a>}</span></code></pre></div>
<p>Rest of the code didn’t require any change.</p>
<h2 id="redux-toolkit-example">Redux Toolkit example</h2>
<pre class="shell"><code>yarn add @reduxjs/toolkit react-redux
yarn add -D @types/redux @types/react-redux</code></pre>
<figure>
<img src="6.running-app.png" alt="" /><figcaption>6.running-app</figcaption>
</figure>
<figure>
<img src="7.project-structure.png" alt="" /><figcaption>7.project-structure</figcaption>
</figure>
<h3 id="new-files-added">New files added</h3>
<ul>
<li>/src/state/hooks.ts</li>
<li>/src/state/slice/counterSlice.ts</li>
<li>/src/state/store.ts</li>
</ul>
<h4 id="srcstatehooks.ts">/src/state/hooks.ts</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="im">import</span> {TypedUseSelectorHook<span class="op">,</span> useDispatch<span class="op">,</span> useSelector} from <span class="st">&quot;react-redux&quot;</span><span class="op">;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a><span class="im">import</span> {AppDispatch<span class="op">,</span> RootState} from <span class="st">&quot;./store&quot;</span><span class="op">;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a>export const useAppDispatch <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="fu">useDispatch</span><span class="op">&lt;</span>AppDispatch<span class="op">&gt;</span>()<span class="op">;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a>export const useAppSelector<span class="op">:</span> TypedUseSelectorHook<span class="op">&lt;</span>RootState<span class="op">&gt;</span> <span class="op">=</span> useSelector<span class="op">;</span></span></code></pre></div>
<h4 id="srcstateslicecounterslice.ts">/src/state/slice/counterSlice.ts</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="im">import</span> {createSlice} from <span class="st">&quot;@reduxjs/toolkit&quot;</span><span class="op">;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a><span class="im">import</span> <span class="im">type</span> {RootState} from <span class="st">&quot;../store&quot;</span><span class="op">;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a>interface CounterState {</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a>    counter<span class="op">:</span> {</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true"></a>        value<span class="op">:</span> <span class="dt">number</span><span class="op">;</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true"></a>    }<span class="op">;</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true"></a>}</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true"></a>const initialState<span class="op">:</span> CounterState <span class="op">=</span> {counter<span class="op">:</span> {value<span class="op">:</span> <span class="dv">0</span>}} <span class="im">as</span> CounterState<span class="op">;</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true"></a>export const counterSlice <span class="op">=</span> <span class="fu">createSlice</span>({</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true"></a>    name<span class="op">:</span> <span class="st">&#39;counter&#39;</span><span class="op">,</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true"></a>    initialState<span class="op">,</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true"></a>    reducers<span class="op">:</span> {</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true"></a>        increment<span class="op">:</span> (state<span class="op">:</span> CounterState) <span class="kw">=&gt;</span> {</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true"></a>            state<span class="op">.</span><span class="at">counter</span><span class="op">.</span><span class="at">value</span> <span class="op">+=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true"></a>            return state<span class="op">;</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true"></a>        }<span class="op">,</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true"></a>        decrement<span class="op">:</span> (state<span class="op">:</span> CounterState) <span class="kw">=&gt;</span> {</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true"></a>            state<span class="op">.</span><span class="at">counter</span><span class="op">.</span><span class="at">value</span> <span class="op">-=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true"></a>            return state</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true"></a>        }</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true"></a>    }</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true"></a>})<span class="op">;</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true"></a>export const {increment<span class="op">,</span> decrement} <span class="op">=</span> counterSlice<span class="op">.</span><span class="at">actions</span><span class="op">;</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true"></a>export const selectCount <span class="op">=</span> (state<span class="op">:</span> RootState) <span class="kw">=&gt;</span> state<span class="op">.</span><span class="at">counter</span><span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true"></a></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true"></a>export default counterSlice<span class="op">.</span><span class="at">reducer</span><span class="op">;</span></span></code></pre></div>
<h4 id="srcstatestore.ts">/src/state/store.ts</h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="im">import</span> {configureStore} from <span class="st">&quot;@reduxjs/toolkit&quot;</span><span class="op">;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a><span class="im">import</span> {counterSlice} from <span class="st">&quot;./slice/counterSlice&quot;</span><span class="op">;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true"></a>const store <span class="op">=</span> <span class="fu">configureStore</span>({</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true"></a>    reducer<span class="op">:</span> counterSlice<span class="op">.</span><span class="at">reducer</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true"></a>})<span class="op">;</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true"></a><span class="im">export type</span> RootState <span class="op">=</span> <span class="bu">ReturnType</span><span class="op">&lt;</span>typeof store<span class="op">.</span><span class="at">getState</span><span class="op">&gt;</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true"></a><span class="im">export type</span> AppDispatch <span class="op">=</span> typeof store<span class="op">.</span><span class="at">dispatch</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true"></a>export {store}<span class="op">;</span></span></code></pre></div>
<h3 id="files-updated">Files updated</h3>
<ul>
<li>/src/App.tsx</li>
<li>/src/components/counter/counter.tsx</li>
</ul>
<h4 id="srcapp.tsx">/src/App.tsx</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="im">import</span> React from <span class="st">&#39;react&#39;</span><span class="op">;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a><span class="im">import</span> {Provider} from <span class="st">&quot;react-redux&quot;</span><span class="op">;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a><span class="im">import</span> {store} from <span class="st">&quot;./state/store&quot;</span><span class="op">;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true"></a><span class="im">import</span> <span class="st">&#39;./App.css&#39;</span><span class="op">;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true"></a><span class="im">import</span> Counter from <span class="st">&quot;./components/counter/counter&quot;</span><span class="op">;</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true"></a><span class="kw">function</span> <span class="fu">App</span>() {</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true"></a>    <span class="fu">return</span> (</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true"></a>        <span class="op">&lt;</span>Provider store<span class="op">=</span>{store}<span class="op">&gt;</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true"></a>            <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;App&quot;</span><span class="op">&gt;</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true"></a>                <span class="op">&lt;</span>h1<span class="op">&gt;</span>counter <span class="dv">1</span><span class="op">&lt;/</span>h1<span class="op">&gt;</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true"></a>                <span class="op">&lt;</span>Counter<span class="op">/&gt;</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true"></a>            <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true"></a>        <span class="op">&lt;/</span>Provider<span class="op">&gt;</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true"></a>    )<span class="op">;</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true"></a>}</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true"></a>export default App<span class="op">;</span></span></code></pre></div>
<h4 id="srccomponentscountercounter.tsx">/src/components/counter/counter.tsx</h4>
<div class="sourceCode" id="cb16"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="im">import</span> React from <span class="st">&quot;react&quot;</span><span class="op">;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a><span class="im">import</span> <span class="st">&quot;./counter.css&quot;</span><span class="op">;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a><span class="im">import</span> CounterDisplay from <span class="st">&quot;../counter-display/counter-display&quot;</span><span class="op">;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true"></a><span class="im">import</span> {useAppSelector<span class="op">,</span> useAppDispatch} from <span class="st">&quot;../../state/hooks&quot;</span><span class="op">;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true"></a><span class="im">import</span> {increment<span class="op">,</span> decrement<span class="op">,</span> selectCount} from <span class="st">&quot;../../state/slice/counterSlice&quot;</span><span class="op">;</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true"></a>export default <span class="kw">function</span> <span class="fu">Counter</span>() {</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true"></a>    const dispatch <span class="op">=</span> <span class="fu">useAppDispatch</span>()<span class="op">;</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true"></a>    const count <span class="op">=</span> <span class="fu">useAppSelector</span>(selectCount)<span class="op">;</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true"></a>    <span class="fu">return</span> (</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true"></a>        <span class="op">&lt;</span>div className<span class="op">=</span>{<span class="st">&quot;counter&quot;</span>}<span class="op">&gt;</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true"></a>            <span class="op">&lt;</span>CounterDisplay count<span class="op">=</span>{count}<span class="op">/&gt;</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true"></a>            <span class="op">&lt;</span>div className<span class="op">=</span>{<span class="st">&quot;coutner-actions&quot;</span>}<span class="op">&gt;</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true"></a>                <span class="op">&lt;</span>button onClick<span class="op">=</span>{() <span class="kw">=&gt;</span> <span class="fu">dispatch</span>(<span class="fu">increment</span>())}<span class="op">&gt;</span>increment<span class="op">&lt;/</span>button<span class="op">&gt;</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true"></a>                <span class="op">&lt;</span>button onClick<span class="op">=</span>{() <span class="kw">=&gt;</span> <span class="fu">dispatch</span>(<span class="fu">decrement</span>())}<span class="op">&gt;</span>decrement<span class="op">&lt;/</span>button<span class="op">&gt;</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true"></a>            <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true"></a>        <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true"></a>    )<span class="op">;</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true"></a>}</span></code></pre></div>
<h2 id="i-dont-understand-a-word-of-it.">I don’t understand a word of it.</h2>
<p>So let me just figure these out.</p>
<h3 id="the-slice">The Slice</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="co">/**</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a><span class="co"> * The return value of `createSlice`</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a><span class="co"> *</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a><span class="co"> * </span><span class="an">@public</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a><span class="co"> */</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true"></a>export interface Slice<span class="op">&lt;</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true"></a>  State <span class="op">=</span> any<span class="op">,</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true"></a>  CaseReducers extends SliceCaseReducers<span class="op">&lt;</span>State<span class="op">&gt;</span> <span class="op">=</span> SliceCaseReducers<span class="op">&lt;</span>State<span class="op">&gt;,</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true"></a>  Name extends string <span class="op">=</span> string</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true"></a><span class="op">&gt;</span> {</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true"></a>  <span class="co">/**</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true"></a><span class="co">   * The slice name.</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true"></a><span class="co">   */</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true"></a>  name<span class="op">:</span> Name</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true"></a>  <span class="co">/**</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true"></a><span class="co">   * The slice&#39;s reducer.</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true"></a><span class="co">   */</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true"></a>  reducer<span class="op">:</span> Reducer<span class="op">&lt;</span>State<span class="op">&gt;</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true"></a></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true"></a>  <span class="co">/**</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true"></a><span class="co">   * Action creators for the types of actions that are handled by the slice</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true"></a><span class="co">   * reducer.</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true"></a><span class="co">   */</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true"></a>  actions<span class="op">:</span> CaseReducerActions<span class="op">&lt;</span>CaseReducers<span class="op">&gt;</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true"></a></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true"></a>  <span class="co">/**</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true"></a><span class="co">   * The individual case reducer functions that were passed in the `reducers` parameter.</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true"></a><span class="co">   * This enables reuse and testing if they were defined inline when calling `createSlice`.</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true"></a><span class="co">   */</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true"></a>  caseReducers<span class="op">:</span> SliceDefinedCaseReducers<span class="op">&lt;</span>CaseReducers<span class="op">&gt;</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true"></a></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true"></a>  <span class="co">/**</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true"></a><span class="co">   * Provides access to the initial state value given to the slice.</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true"></a><span class="co">   * If a lazy state initializer was provided, it will be called and a fresh value returned.</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true"></a><span class="co">   */</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true"></a>  getInitialState<span class="op">:</span> () <span class="kw">=&gt;</span> State</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true"></a>}</span></code></pre></div>
<p>Ok, so Slice Interface is defined as having members: name, reducer, actions, caseReducers and getInitialState.</p>
<figure>
<img src="8.logging-counterSlice-after-creation.png" alt="" /><figcaption>8.logging-counterSlice-after-creation</figcaption>
</figure>
<p>I can see actions, caseReducers, getInitialState, name and reducer.</p>
<p>I can also see that on invocation of actions.increment with the proper state varialbles, an object is returned. This returned object looks like plain old redux dispatch input. We are telling rootReducer to fire action for " counter/increment" with values <code>{ counter: { value: 0} }</code>.</p>
<p>I need to maintain my own state for the component and pass it to the dispatched function call.</p>
<figure>
<img src="9.getInitialState.png" alt="" /><figcaption>9.getInitialState</figcaption>
</figure>
<p>This does return the initial value of the state.</p>
<figure>
<img src="10.reducer-function.png" alt="" /><figcaption>10.reducer-function</figcaption>
</figure>
<p>I tried to get source of the reducer function.</p>
<figure>
<img src="11.executing-reducer-function.png" alt="" /><figcaption>11.executing-reducer-function</figcaption>
</figure>
<p>In the first attempt, I just passed state object and action name. It doesn’t work. There is a given structure that redux understands, when I remembered it, and passed <code>{type: action}</code>, it worked!</p>
<p>Let’s figure out other functions and “words”.</p>
<h3 id="createslice">createSlice</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a><span class="co">/**</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a><span class="co"> * A function that accepts an initial state, an object full of reducer</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a><span class="co"> * functions, and a &quot;slice name&quot;, and automatically generates</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true"></a><span class="co"> * action creators and action types that correspond to the</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true"></a><span class="co"> * reducers and state.</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true"></a><span class="co"> *</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true"></a><span class="co"> * The `reducer` argument is passed to `createReducer()`.</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true"></a><span class="co"> *</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true"></a><span class="co"> * </span><span class="an">@public</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true"></a><span class="co"> */</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true"></a>export <span class="kw">declare</span> <span class="kw">function</span> createSlice</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true"></a>    <span class="op">&lt;</span>State<span class="op">,</span> CaseReducers extends SliceCaseReducers<span class="op">&lt;</span>State<span class="op">&gt;,</span> Name extends <span class="dt">string</span> <span class="op">=</span> <span class="dt">string</span><span class="op">&gt;</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true"></a>    (options<span class="op">:</span> CreateSliceOptions<span class="op">&lt;</span>State<span class="op">,</span> CaseReducers<span class="op">,</span> Name<span class="op">&gt;</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true"></a>    <span class="op">:</span> Slice<span class="op">&lt;</span>State<span class="op">,</span> CaseReducers<span class="op">,</span> Name<span class="op">&gt;;</span></span></code></pre></div>
<ul>
<li>name is required</li>
<li>initialState can be a function, if it is not, then a function will be created by calling <code>createNextState</code>.</li>
<li>reducers is initialized as empty object if not passed</li>
<li>createSlice returns names, reducer, actions, caseReducers, getInitialState as we have seen earlier.</li>
</ul>
<blockquote>
<p>Curried producer that infers the recipe from the curried output function (e.g. when passing to setState)</p>
</blockquote>
<figure>
<img src="12.createNextState-is-curried-producer-what.png" alt="" /><figcaption>12.createNextState-is-curried-producer-what</figcaption>
</figure>
<figure>
<img src="13.reducers-being-setup.png" alt="" /><figcaption>13.reducers-being-setup</figcaption>
</figure>
<h4 id="return-from-createslice">Return from createSlice</h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a>return {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a>    name<span class="op">,</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a>    <span class="fu">reducer</span>(state<span class="op">,</span> action) {</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a>      <span class="fu">if</span> (<span class="op">!</span>_reducer) _reducer <span class="op">=</span> <span class="fu">buildReducer</span>()</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true"></a>      return <span class="fu">_reducer</span>(state<span class="op">,</span> action)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true"></a>    }<span class="op">,</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true"></a>    actions<span class="op">:</span> actionCreators <span class="im">as</span> <span class="dt">any</span><span class="op">,</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true"></a>    caseReducers<span class="op">:</span> sliceCaseReducersByName <span class="im">as</span> <span class="dt">any</span><span class="op">,</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true"></a>    <span class="fu">getInitialState</span>() {</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true"></a>      <span class="fu">if</span> (<span class="op">!</span>_reducer) _reducer <span class="op">=</span> <span class="fu">buildReducer</span>()</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true"></a>      return _reducer<span class="op">.</span><span class="fu">getInitialState</span>()</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true"></a>    }<span class="op">,</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true"></a>  }</span></code></pre></div>
<p>The returned <code>counterSlice.reducer</code> is being used in store.ts. Let me figure out what is a <code>configureStore</code>.</p>
<h3 id="configurestore"><code>configureStore</code></h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="co">/**</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a><span class="co"> * A friendly abstraction over the standard Redux `createStore()` function.</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a><span class="co"> *</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true"></a><span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="cv">config</span><span class="co"> The store configuration.</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true"></a><span class="co"> * </span><span class="an">@returns</span><span class="co"> A configured Redux store.</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true"></a><span class="co"> *</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true"></a><span class="co"> * </span><span class="an">@public</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true"></a><span class="co"> */</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true"></a>export <span class="kw">function</span> configureStore<span class="op">&lt;</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true"></a>  S <span class="op">=</span> any<span class="op">,</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true"></a>  A extends Action <span class="op">=</span> AnyAction<span class="op">,</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true"></a>  M extends Middlewares<span class="op">&lt;</span>S<span class="op">&gt;</span> <span class="op">=</span> [ThunkMiddlewareFor<span class="op">&lt;</span>S<span class="op">&gt;</span>]</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true"></a><span class="op">&gt;</span>(options<span class="op">:</span> ConfigureStoreOptions<span class="op">&lt;</span>S<span class="op">,</span> A<span class="op">,</span> M<span class="op">&gt;</span>)<span class="op">:</span> EnhancedStore<span class="op">&lt;</span>S<span class="op">,</span> A<span class="op">,</span> M<span class="op">&gt;</span> {</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true"></a>  const curriedGetDefaultMiddleware <span class="op">=</span> <span class="fu">curryGetDefaultMiddleware</span><span class="op">&lt;</span>S<span class="op">&gt;</span>()</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true"></a>  const {</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true"></a>    reducer <span class="op">=</span> undefined<span class="op">,</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true"></a>    middleware <span class="op">=</span> <span class="fu">curriedGetDefaultMiddleware</span>()<span class="op">,</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true"></a>    devTools <span class="op">=</span> true<span class="op">,</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true"></a>    preloadedState <span class="op">=</span> undefined<span class="op">,</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true"></a>    enhancers <span class="op">=</span> undefined<span class="op">,</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true"></a>  } <span class="op">=</span> options <span class="op">||</span> {}</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true"></a>  let rootReducer<span class="op">:</span> Reducer<span class="op">&lt;</span>S<span class="op">,</span> A<span class="op">&gt;</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true"></a></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true"></a>  <span class="fu">if</span> (typeof reducer <span class="op">===</span> <span class="st">&#39;function&#39;</span>) {</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true"></a>    rootReducer <span class="op">=</span> reducer</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true"></a>  } else <span class="fu">if</span> (<span class="fu">isPlainObject</span>(reducer)) {</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true"></a>    rootReducer <span class="op">=</span> <span class="fu">combineReducers</span>(reducer)</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true"></a>  } else {</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true"></a>    throw <span class="kw">new</span> <span class="fu">Error</span>(</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true"></a>      <span class="st">&#39;&quot;reducer&quot; is a required argument, and must be a function or an object of functions that can be passed to combineReducers&#39;</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true"></a>    )</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true"></a>  }</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true"></a></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true"></a>  let finalMiddleware <span class="op">=</span> middleware</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true"></a>  <span class="fu">if</span> (typeof finalMiddleware <span class="op">===</span> <span class="st">&#39;function&#39;</span>) {</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true"></a>    finalMiddleware <span class="op">=</span> <span class="fu">finalMiddleware</span>(curriedGetDefaultMiddleware)</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true"></a></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true"></a>    <span class="fu">if</span> (<span class="op">!</span>IS_PRODUCTION <span class="op">&amp;&amp;</span> <span class="op">!</span>Array<span class="op">.</span><span class="fu">isArray</span>(finalMiddleware)) {</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true"></a>      throw <span class="kw">new</span> <span class="fu">Error</span>(</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true"></a>        <span class="st">&#39;when using a middleware builder function, an array of middleware must be returned&#39;</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true"></a>      )</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true"></a>    }</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true"></a>  }</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true"></a>  <span class="fu">if</span> (</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true"></a>    <span class="op">!</span>IS_PRODUCTION <span class="op">&amp;&amp;</span></span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true"></a>    finalMiddleware<span class="op">.</span><span class="fu">some</span>((item) <span class="kw">=&gt;</span> typeof item <span class="op">!==</span> <span class="st">&#39;function&#39;</span>)</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true"></a>  ) {</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true"></a>    throw <span class="kw">new</span> <span class="fu">Error</span>(</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true"></a>      <span class="st">&#39;each middleware provided to configureStore must be a function&#39;</span></span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true"></a>    )</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true"></a>  }</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true"></a></span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true"></a>  const middlewareEnhancer <span class="op">=</span> <span class="fu">applyMiddleware</span>(<span class="op">...</span>finalMiddleware)</span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true"></a></span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true"></a>  let finalCompose <span class="op">=</span> compose</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true"></a></span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true"></a>  <span class="fu">if</span> (devTools) {</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true"></a>    finalCompose <span class="op">=</span> <span class="fu">composeWithDevTools</span>({</span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true"></a>      <span class="co">// Enable capture of stack traces for dispatched Redux actions</span></span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true"></a>      trace<span class="op">:</span> <span class="op">!</span>IS_PRODUCTION<span class="op">,</span></span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true"></a>      <span class="op">...</span>(typeof devTools <span class="op">===</span> <span class="st">&#39;object&#39;</span> <span class="op">&amp;&amp;</span> devTools)<span class="op">,</span></span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true"></a>    })</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true"></a>  }</span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true"></a></span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true"></a>  let storeEnhancers<span class="op">:</span> StoreEnhancer[] <span class="op">=</span> [middlewareEnhancer]</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true"></a></span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true"></a>  <span class="fu">if</span> (Array<span class="op">.</span><span class="fu">isArray</span>(enhancers)) {</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true"></a>    storeEnhancers <span class="op">=</span> [middlewareEnhancer<span class="op">,</span> <span class="op">...</span>enhancers]</span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true"></a>  } else <span class="fu">if</span> (typeof enhancers <span class="op">===</span> <span class="st">&#39;function&#39;</span>) {</span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true"></a>    storeEnhancers <span class="op">=</span> <span class="fu">enhancers</span>(storeEnhancers)</span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true"></a>  }</span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true"></a></span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true"></a>  const composedEnhancer <span class="op">=</span> <span class="fu">finalCompose</span>(<span class="op">...</span>storeEnhancers) <span class="im">as</span> <span class="dt">any</span></span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true"></a></span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true"></a>  return <span class="fu">createStore</span>(rootReducer<span class="op">,</span> preloadedState<span class="op">,</span> composedEnhancer)</span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true"></a>}</span></code></pre></div>
<p>This basically calls <code>createStore</code> and returns the output of that function.</p>
<p>After creating store via <code>createStore</code> we are getting this object:</p>
<figure>
<img src="14.returned-store.png" alt="" /><figcaption>14.returned-store</figcaption>
</figure>
<p>It has the state of our application, and a dispatch function that we can use to update state.</p>
<figure>
<img src="15.firing-disatch.png" alt="" /><figcaption>15.firing-disatch</figcaption>
</figure>
<p>Notice how on firing dispatch three times, the value is updated.</p>
<p>This is because the app state is same as the one being manipulated via redux store’s dispatch call.</p>
<h3 id="createstore"><code>createStore</code></h3>
<p>This comes from reduxjs/redux/src/createStore.js</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="co">/**</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a><span class="co"> * Creates a Redux store that holds the state tree.</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a><span class="co"> * The only way to change the data in the store is to call `dispatch()` on it.</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true"></a><span class="co"> *</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true"></a><span class="co"> * There should only be a single store in your app. To specify how different</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true"></a><span class="co"> * parts of the state tree respond to actions, you may combine several reducers</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true"></a><span class="co"> * into a single reducer function by using `combineReducers`.</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true"></a><span class="co"> *</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true"></a><span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="cv">{Function}</span><span class="co"> reducer A function that returns the next state tree, given</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true"></a><span class="co"> * the current state tree and the action to handle.</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true"></a><span class="co"> *</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true"></a><span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="cv">{any}</span><span class="co"> [preloadedState] The initial state. You may optionally specify it</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true"></a><span class="co"> * to hydrate the state from the server in universal apps, or to restore a</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true"></a><span class="co"> * previously serialized user session.</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true"></a><span class="co"> * If you use `combineReducers` to produce the root reducer function, this must be</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true"></a><span class="co"> * an object with the same shape as `combineReducers` keys.</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true"></a><span class="co"> *</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true"></a><span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="cv">{Function}</span><span class="co"> [enhancer] The store enhancer. You may optionally specify it</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true"></a><span class="co"> * to enhance the store with third-party capabilities such as middleware,</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true"></a><span class="co"> * time travel, persistence, etc. The only store enhancer that ships with Redux</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true"></a><span class="co"> * is `applyMiddleware()`.</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true"></a><span class="co"> *</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true"></a><span class="co"> * </span><span class="an">@returns</span><span class="co"> {Store} A Redux store that lets you read the state, dispatch actions</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true"></a><span class="co"> * and subscribe to changes.</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true"></a><span class="co"> */</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true"></a><span class="im">export</span> <span class="im">default</span> <span class="kw">function</span> <span class="fu">createStore</span>(reducer<span class="op">,</span> preloadedState<span class="op">,</span> enhancer) {</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true"></a><span class="co">// ...a lot of code...</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true"></a>  <span class="cf">return</span> {</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true"></a>    dispatch<span class="op">,</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true"></a>    subscribe<span class="op">,</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true"></a>    getState<span class="op">,</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true"></a>    replaceReducer<span class="op">,</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true"></a>    [$$observable]<span class="op">:</span> observable<span class="op">,</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true"></a>  }</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true"></a>}</span></code></pre></div>
<p>The return is what we have seen earlier. I cannot, ATM, go into the function for a deep dive.</p>
<h2 id="adding-another-counter.">Adding another counter.</h2>
<p>Basically replicating it. This ideally should be very easy.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="op">&lt;</span>h2<span class="op">&gt;</span>counter <span class="dv">1</span><span class="op">&lt;/</span>h2<span class="op">&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a><span class="op">&lt;</span>Counter<span class="op">/&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a><span class="op">&lt;</span>h2<span class="op">&gt;</span>counter <span class="dv">2</span><span class="op">&lt;/</span>h2<span class="op">&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true"></a><span class="op">&lt;</span>Counter<span class="op">/&gt;</span></span></code></pre></div>
<p>The code above should generate two counters that have different state. But that doesn’t happen. Both the counters are using same state.</p>
<figure>
<img src="16.two-counters.png" alt="" /><figcaption>16.two-counters</figcaption>
</figure>
<p>I click increment five times, and both the counters get the same updated value.</p>
<figure>
<img src="17.unintentionally-shared-state.png" alt="" /><figcaption>17.unintentionally-shared-state</figcaption>
</figure>
<p>What is happening?</p>
<p>Well, we are using single state <code>{counter: {value: N} }</code> in redux, so that’s one.</p>
<p>Also, the whole functionality is encapsulated in <code>Counter</code> component, the display, the increment and the decrement functions.</p>
<p>This is great example of component-reuse. Let me add a class variable so that we can see the Counter in black too, but with same value.</p>
<p>After a while, I will update code in such a way that two counters work independently.</p>
<figure>
<img src="18.same-component-different-design.png" alt="" /><figcaption>18.same-component-different-design</figcaption>
</figure>
<h3 id="changes">Changes</h3>
<h4 id="app.tsx-3">App.tsx</h4>
<div class="sourceCode" id="cb23"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="im">import</span> React from <span class="st">&#39;react&#39;</span><span class="op">;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a><span class="im">import</span> {Provider} from <span class="st">&quot;react-redux&quot;</span><span class="op">;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a><span class="im">import</span> {store} from <span class="st">&quot;./state/store&quot;</span><span class="op">;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true"></a><span class="im">import</span> <span class="st">&#39;./App.css&#39;</span><span class="op">;</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true"></a><span class="im">import</span> Counter from <span class="st">&quot;./components/counter/counter&quot;</span><span class="op">;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true"></a><span class="kw">function</span> <span class="fu">App</span>() {</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true"></a>    <span class="fu">return</span> (</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true"></a>        <span class="op">&lt;</span>Provider store<span class="op">=</span>{store}<span class="op">&gt;</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true"></a>            <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;App&quot;</span><span class="op">&gt;</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true"></a>                <span class="op">&lt;</span>h2<span class="op">&gt;</span>counter <span class="dv">1</span><span class="op">&lt;/</span>h2<span class="op">&gt;</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true"></a>                <span class="op">&lt;</span>Counter klass<span class="op">=</span>{<span class="st">&quot;light&quot;</span>}<span class="op">/&gt;</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true"></a>                <span class="op">&lt;</span>h2<span class="op">&gt;</span>counter <span class="dv">2</span><span class="op">&lt;/</span>h2<span class="op">&gt;</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true"></a>                <span class="op">&lt;</span>Counter klass<span class="op">=</span>{<span class="st">&quot;dark&quot;</span>}<span class="op">/&gt;</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true"></a>            <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true"></a>        <span class="op">&lt;/</span>Provider<span class="op">&gt;</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true"></a>    )<span class="op">;</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true"></a>}</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true"></a></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true"></a>export default App<span class="op">;</span></span></code></pre></div>
<h4 id="counter.tsx">counter.tsx</h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a><span class="im">import</span> React from <span class="st">&quot;react&quot;</span><span class="op">;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a><span class="im">import</span> <span class="st">&quot;./counter.css&quot;</span><span class="op">;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true"></a><span class="im">import</span> CounterDisplay from <span class="st">&quot;../counter-display/counter-display&quot;</span><span class="op">;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true"></a><span class="im">import</span> {useAppSelector<span class="op">,</span> useAppDispatch} from <span class="st">&quot;../../state/hooks&quot;</span><span class="op">;</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true"></a><span class="im">import</span> {increment<span class="op">,</span> decrement<span class="op">,</span> selectCount} from <span class="st">&quot;../../state/slice/counterSlice&quot;</span><span class="op">;</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true"></a>interface CounterProps {</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true"></a>    klass<span class="op">?:</span> <span class="dt">string</span><span class="op">;</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true"></a>}</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true"></a>export default <span class="kw">function</span> <span class="fu">Counter</span>({klass}<span class="op">:</span> CounterProps <span class="op">=</span> {klass<span class="op">:</span> <span class="st">&quot;light&quot;</span>}) {</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true"></a>    const dispatch <span class="op">=</span> <span class="fu">useAppDispatch</span>()<span class="op">;</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true"></a>    const count <span class="op">=</span> <span class="fu">useAppSelector</span>(selectCount)<span class="op">;</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true"></a>    <span class="fu">return</span> (</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true"></a>        <span class="op">&lt;</span>div className<span class="op">=</span>{<span class="vs">`counter </span><span class="sc">${</span>klass<span class="sc">}</span><span class="vs">`</span>}<span class="op">&gt;</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true"></a>            <span class="op">&lt;</span>CounterDisplay count<span class="op">=</span>{count}<span class="op">/&gt;</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true"></a>            <span class="op">&lt;</span>div className<span class="op">=</span>{<span class="st">&quot;coutner-actions&quot;</span>}<span class="op">&gt;</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true"></a>                <span class="op">&lt;</span>button onClick<span class="op">=</span>{() <span class="kw">=&gt;</span> <span class="fu">dispatch</span>(<span class="fu">increment</span>())}<span class="op">&gt;</span>increment<span class="op">&lt;/</span>button<span class="op">&gt;</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true"></a>                <span class="op">&lt;</span>button onClick<span class="op">=</span>{() <span class="kw">=&gt;</span> <span class="fu">dispatch</span>(<span class="fu">decrement</span>())}<span class="op">&gt;</span>decrement<span class="op">&lt;/</span>button<span class="op">&gt;</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true"></a>            <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true"></a>        <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true"></a>    )<span class="op">;</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true"></a>}</span></code></pre></div>
<h4 id="counter.css">counter.css</h4>
<div class="sourceCode" id="cb25"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a><span class="fu">.counter.dark</span> {</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a>    <span class="kw">background-color</span>: <span class="cn">#333333</span><span class="op">;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true"></a>    <span class="kw">color</span>: <span class="cn">#eeeeee</span><span class="op">;</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true"></a>    <span class="kw">border</span>: <span class="dv">medium</span> <span class="dv">solid</span> <span class="cn">silver</span><span class="op">;</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true"></a>}</span></code></pre></div>
<h4 id="counter-display.css">counter-display.css</h4>
<div class="sourceCode" id="cb26"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a><span class="fu">.counter.dark</span> <span class="fu">.counter-value</span> {</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true"></a>    <span class="kw">min-width</span>: <span class="dv">100</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true"></a>    <span class="kw">font-weight</span>: <span class="dv">bold</span><span class="op">;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true"></a>    <span class="kw">font-family</span>: <span class="dv">monospace</span><span class="op">;</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true"></a>    <span class="kw">text-shadow</span>: <span class="dv">2</span><span class="dt">px</span> <span class="dv">2</span><span class="dt">px</span> <span class="dv">2</span><span class="dt">px</span> <span class="cn">black</span><span class="op">;</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true"></a>    <span class="kw">display</span>: <span class="dv">inline-block</span><span class="op">;</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true"></a>    <span class="kw">border-bottom</span>: <span class="dv">thin</span> <span class="dv">solid</span> <span class="cn">silver</span><span class="op">;</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true"></a>}</span></code></pre></div>
<h2 id="counter-2">2022.01.09 counter-2</h2>
<p>Interestingly a better implementation is found in template project that you can get from <code>yarn create react-app counter-2 --template redux-typescript</code></p>
<figure>
<img src="19.counter-2.png" alt="" /><figcaption>19.counter-2</figcaption>
</figure>
<h3 id="running-app">running app</h3>
<figure>
<img src="20.running-app.png" alt="" /><figcaption>20.running-app</figcaption>
</figure>
<p>Though it has added features, unfortunately it also is designed for single instance. Singletons be damned.</p>
<p>I should realise that redux is for maintaining a global store. A global store, by design, is singleton.</p>
<p>And thanks to non-preemptive single threadedness of JS, this doesn’t become a nightmare everyday.</p>
<h3 id="featurescountercounter.module.css">/features/counter/Counter.module.css</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a><span class="fu">.row</span> {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true"></a>  <span class="kw">display</span>: flex<span class="op">;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true"></a>  <span class="kw">align-items</span>: <span class="dv">center</span><span class="op">;</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true"></a>  <span class="kw">justify-content</span>: <span class="dv">center</span><span class="op">;</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true"></a>}</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true"></a><span class="fu">.row</span> <span class="op">&gt;</span> button {</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true"></a>  <span class="kw">margin-left</span>: <span class="dv">4</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true"></a>  <span class="kw">margin-right</span>: <span class="dv">8</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true"></a>}</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true"></a><span class="fu">.row</span><span class="in">:not(</span>:last-child<span class="in">)</span> {</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true"></a>  <span class="kw">margin-bottom</span>: <span class="dv">16</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true"></a>}</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true"></a><span class="fu">.value</span> {</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true"></a>  <span class="kw">font-size</span>: <span class="dv">78</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true"></a>  <span class="kw">padding-left</span>: <span class="dv">16</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true"></a>  <span class="kw">padding-right</span>: <span class="dv">16</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true"></a>  <span class="kw">margin-top</span>: <span class="dv">2</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true"></a>  <span class="kw">font-family</span>: <span class="st">&#39;Courier New&#39;</span><span class="op">,</span> Courier<span class="op">,</span> <span class="dv">monospace</span><span class="op">;</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true"></a>}</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true"></a></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true"></a><span class="fu">.button</span> {</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true"></a>  <span class="kw">appearance</span>: <span class="dv">none</span><span class="op">;</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true"></a>  <span class="kw">background</span>: <span class="dv">none</span><span class="op">;</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true"></a>  <span class="kw">font-size</span>: <span class="dv">32</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true"></a>  <span class="kw">padding-left</span>: <span class="dv">12</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true"></a>  <span class="kw">padding-right</span>: <span class="dv">12</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true"></a>  <span class="kw">outline</span>: <span class="dv">none</span><span class="op">;</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true"></a>  <span class="kw">border</span>: <span class="dv">2</span><span class="dt">px</span> <span class="dv">solid</span> <span class="dv">transparent</span><span class="op">;</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true"></a>  <span class="kw">color</span>: <span class="fu">rgb(</span><span class="dv">112</span><span class="op">,</span> <span class="dv">76</span><span class="op">,</span> <span class="dv">182</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true"></a>  <span class="kw">padding-bottom</span>: <span class="dv">4</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true"></a>  <span class="kw">cursor</span>: <span class="dv">pointer</span><span class="op">;</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true"></a>  <span class="kw">background-color</span>: <span class="fu">rgba(</span><span class="dv">112</span><span class="op">,</span> <span class="dv">76</span><span class="op">,</span> <span class="dv">182</span><span class="op">,</span> <span class="dv">0.1</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true"></a>  <span class="kw">border-radius</span>: <span class="dv">2</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true"></a>  <span class="kw">transition</span>: <span class="dv">all</span> <span class="dv">0.15</span><span class="dt">s</span><span class="op">;</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true"></a>}</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true"></a></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true"></a><span class="fu">.textbox</span> {</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true"></a>  <span class="kw">font-size</span>: <span class="dv">32</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true"></a>  <span class="kw">padding</span>: <span class="dv">2</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true"></a>  <span class="kw">width</span>: <span class="dv">64</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true"></a>  <span class="kw">text-align</span>: <span class="dv">center</span><span class="op">;</span></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true"></a>  <span class="kw">margin-right</span>: <span class="dv">4</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true"></a>}</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true"></a></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true"></a><span class="fu">.button</span><span class="in">:hover</span><span class="op">,</span></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true"></a><span class="fu">.button</span><span class="in">:focus</span> {</span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true"></a>  <span class="kw">border</span>: <span class="dv">2</span><span class="dt">px</span> <span class="dv">solid</span> <span class="fu">rgba(</span><span class="dv">112</span><span class="op">,</span> <span class="dv">76</span><span class="op">,</span> <span class="dv">182</span><span class="op">,</span> <span class="dv">0.4</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true"></a>}</span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true"></a></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true"></a><span class="fu">.button</span><span class="in">:active</span> {</span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true"></a>  <span class="kw">background-color</span>: <span class="fu">rgba(</span><span class="dv">112</span><span class="op">,</span> <span class="dv">76</span><span class="op">,</span> <span class="dv">182</span><span class="op">,</span> <span class="dv">0.2</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true"></a>}</span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true"></a></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true"></a><span class="fu">.asyncButton</span> {</span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true"></a>  composes: button<span class="op">;</span></span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true"></a>  <span class="kw">position</span>: <span class="dv">relative</span><span class="op">;</span></span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true"></a>}</span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true"></a></span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true"></a><span class="fu">.asyncButton</span><span class="in">:after</span> {</span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true"></a>  <span class="kw">content</span>: <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true"></a>  <span class="kw">background-color</span>: <span class="fu">rgba(</span><span class="dv">112</span><span class="op">,</span> <span class="dv">76</span><span class="op">,</span> <span class="dv">182</span><span class="op">,</span> <span class="dv">0.15</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true"></a>  <span class="kw">display</span>: <span class="dv">block</span><span class="op">;</span></span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true"></a>  <span class="kw">position</span>: <span class="dv">absolute</span><span class="op">;</span></span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true"></a>  <span class="kw">width</span>: <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true"></a>  <span class="kw">height</span>: <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true"></a>  <span class="kw">left</span>: <span class="dv">0</span><span class="op">;</span></span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true"></a>  <span class="kw">top</span>: <span class="dv">0</span><span class="op">;</span></span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true"></a>  <span class="kw">opacity</span>: <span class="dv">0</span><span class="op">;</span></span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true"></a>  <span class="kw">transition</span>: width <span class="dv">1</span><span class="dt">s</span> <span class="dv">linear</span><span class="op">,</span> opacity <span class="dv">0.5</span><span class="dt">s</span> <span class="dv">ease</span> <span class="dv">1</span><span class="dt">s</span><span class="op">;</span></span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true"></a>}</span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true"></a></span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true"></a><span class="fu">.asyncButton</span><span class="in">:active:after</span> {</span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true"></a>  <span class="kw">width</span>: <span class="dv">0</span><span class="dt">%</span><span class="op">;</span></span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true"></a>  <span class="kw">opacity</span>: <span class="dv">1</span><span class="op">;</span></span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true"></a>  <span class="kw">transition</span>: <span class="dv">0</span><span class="dt">s</span><span class="op">;</span></span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true"></a>}</span></code></pre></div>
<h3 id="featurescountercounter.tsx">/features/counter/Counter.tsx</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a><span class="im">import</span> React<span class="op">,</span> { useState } from <span class="st">&#39;react&#39;</span><span class="op">;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true"></a><span class="im">import</span> { useAppSelector<span class="op">,</span> useAppDispatch } from <span class="st">&#39;../../app/hooks&#39;</span><span class="op">;</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true"></a><span class="im">import</span> {</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true"></a>  decrement<span class="op">,</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true"></a>  increment<span class="op">,</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true"></a>  incrementByAmount<span class="op">,</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true"></a>  incrementAsync<span class="op">,</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true"></a>  incrementIfOdd<span class="op">,</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true"></a>  selectCount<span class="op">,</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true"></a>} from <span class="st">&#39;./counterSlice&#39;</span><span class="op">;</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true"></a><span class="im">import</span> styles from <span class="st">&#39;./Counter.module.css&#39;</span><span class="op">;</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true"></a>export <span class="kw">function</span> <span class="fu">Counter</span>() {</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true"></a>  const count <span class="op">=</span> <span class="fu">useAppSelector</span>(selectCount)<span class="op">;</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true"></a>  const dispatch <span class="op">=</span> <span class="fu">useAppDispatch</span>()<span class="op">;</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true"></a>  const [incrementAmount<span class="op">,</span> setIncrementAmount] <span class="op">=</span> <span class="fu">useState</span>(<span class="st">&#39;2&#39;</span>)<span class="op">;</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true"></a>  const incrementValue <span class="op">=</span> <span class="bu">Number</span>(incrementAmount) <span class="op">||</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true"></a>  <span class="fu">return</span> (</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true"></a>    <span class="op">&lt;</span>div<span class="op">&gt;</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true"></a>      <span class="op">&lt;</span>div className<span class="op">=</span>{styles<span class="op">.</span><span class="at">row</span>}<span class="op">&gt;</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true"></a>        <span class="op">&lt;</span>button</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true"></a>          className<span class="op">=</span>{styles<span class="op">.</span><span class="at">button</span>}</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true"></a>          aria<span class="op">-</span>label<span class="op">=</span><span class="st">&quot;Decrement value&quot;</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true"></a>          onClick<span class="op">=</span>{() <span class="kw">=&gt;</span> <span class="fu">dispatch</span>(<span class="fu">decrement</span>())}</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true"></a>        <span class="op">&gt;</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true"></a>          <span class="op">-</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true"></a>        <span class="op">&lt;/</span>button<span class="op">&gt;</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true"></a>        <span class="op">&lt;</span>span className<span class="op">=</span>{styles<span class="op">.</span><span class="at">value</span>}<span class="op">&gt;</span>{count}<span class="op">&lt;/</span>span<span class="op">&gt;</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true"></a>        <span class="op">&lt;</span>button</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true"></a>          className<span class="op">=</span>{styles<span class="op">.</span><span class="at">button</span>}</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true"></a>          aria<span class="op">-</span>label<span class="op">=</span><span class="st">&quot;Increment value&quot;</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true"></a>          onClick<span class="op">=</span>{() <span class="kw">=&gt;</span> <span class="fu">dispatch</span>(<span class="fu">increment</span>())}</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true"></a>        <span class="op">&gt;</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true"></a>          <span class="op">+</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true"></a>        <span class="op">&lt;/</span>button<span class="op">&gt;</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true"></a>      <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true"></a>      <span class="op">&lt;</span>div className<span class="op">=</span>{styles<span class="op">.</span><span class="at">row</span>}<span class="op">&gt;</span></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true"></a>        <span class="op">&lt;</span>input</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true"></a>          className<span class="op">=</span>{styles<span class="op">.</span><span class="at">textbox</span>}</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true"></a>          aria<span class="op">-</span>label<span class="op">=</span><span class="st">&quot;Set increment amount&quot;</span></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true"></a>          value<span class="op">=</span>{incrementAmount}</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true"></a>          onChange<span class="op">=</span>{(e) <span class="kw">=&gt;</span> <span class="fu">setIncrementAmount</span>(e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">value</span>)}</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true"></a>        <span class="op">/&gt;</span></span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true"></a>        <span class="op">&lt;</span>button</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true"></a>          className<span class="op">=</span>{styles<span class="op">.</span><span class="at">button</span>}</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true"></a>          onClick<span class="op">=</span>{() <span class="kw">=&gt;</span> <span class="fu">dispatch</span>(<span class="fu">incrementByAmount</span>(incrementValue))}</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true"></a>        <span class="op">&gt;</span></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true"></a>          Add Amount</span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true"></a>        <span class="op">&lt;/</span>button<span class="op">&gt;</span></span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true"></a>        <span class="op">&lt;</span>button</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true"></a>          className<span class="op">=</span>{styles<span class="op">.</span><span class="at">asyncButton</span>}</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true"></a>          onClick<span class="op">=</span>{() <span class="kw">=&gt;</span> <span class="fu">dispatch</span>(<span class="fu">incrementAsync</span>(incrementValue))}</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true"></a>        <span class="op">&gt;</span></span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true"></a>          Add Async</span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true"></a>        <span class="op">&lt;/</span>button<span class="op">&gt;</span></span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true"></a>        <span class="op">&lt;</span>button</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true"></a>          className<span class="op">=</span>{styles<span class="op">.</span><span class="at">button</span>}</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true"></a>          onClick<span class="op">=</span>{() <span class="kw">=&gt;</span> <span class="fu">dispatch</span>(<span class="fu">incrementIfOdd</span>(incrementValue))}</span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true"></a>        <span class="op">&gt;</span></span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true"></a>          Add If Odd</span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true"></a>        <span class="op">&lt;/</span>button<span class="op">&gt;</span></span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true"></a>      <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true"></a>    <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true"></a>  )<span class="op">;</span></span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true"></a>}</span></code></pre></div>
<h3 id="featurescountercounterapi.ts">/features/counter/counterAPI.ts</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a><span class="co">// A mock function to mimic making an async request for data</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a>export <span class="kw">function</span> <span class="fu">fetchCount</span>(amount <span class="op">=</span> <span class="dv">1</span>) {</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true"></a>  return <span class="kw">new</span> <span class="bu">Promise</span><span class="op">&lt;</span>{ data<span class="op">:</span> <span class="dt">number</span> }<span class="op">&gt;</span>((resolve) <span class="kw">=&gt;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true"></a>    <span class="fu">setTimeout</span>(() <span class="kw">=&gt;</span> <span class="fu">resolve</span>({ data<span class="op">:</span> amount })<span class="op">,</span> <span class="dv">500</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true"></a>  )<span class="op">;</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true"></a>}</span></code></pre></div>
<h3 id="featurescountercounterslice.spec.ts">/features/counter/counterSlice.spec.ts</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a><span class="im">import</span> counterReducer<span class="op">,</span> {</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true"></a>  CounterState<span class="op">,</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true"></a>  increment<span class="op">,</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true"></a>  decrement<span class="op">,</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true"></a>  incrementByAmount<span class="op">,</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true"></a>} from <span class="st">&#39;./counterSlice&#39;</span><span class="op">;</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true"></a><span class="fu">describe</span>(<span class="st">&#39;counter reducer&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true"></a>  const initialState<span class="op">:</span> CounterState <span class="op">=</span> {</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true"></a>    value<span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true"></a>    status<span class="op">:</span> <span class="st">&#39;idle&#39;</span><span class="op">,</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true"></a>  }<span class="op">;</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">&#39;should handle initial state&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true"></a>    <span class="fu">expect</span>(<span class="fu">counterReducer</span>(undefined<span class="op">,</span> { type<span class="op">:</span> <span class="st">&#39;unknown&#39;</span> }))<span class="op">.</span><span class="fu">toEqual</span>({</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true"></a>      value<span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true"></a>      status<span class="op">:</span> <span class="st">&#39;idle&#39;</span><span class="op">,</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true"></a>    })<span class="op">;</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">&#39;should handle increment&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true"></a>    const actual <span class="op">=</span> <span class="fu">counterReducer</span>(initialState<span class="op">,</span> <span class="fu">increment</span>())<span class="op">;</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true"></a>    <span class="fu">expect</span>(actual<span class="op">.</span><span class="at">value</span>)<span class="op">.</span><span class="fu">toEqual</span>(<span class="dv">4</span>)<span class="op">;</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true"></a></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">&#39;should handle decrement&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true"></a>    const actual <span class="op">=</span> <span class="fu">counterReducer</span>(initialState<span class="op">,</span> <span class="fu">decrement</span>())<span class="op">;</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true"></a>    <span class="fu">expect</span>(actual<span class="op">.</span><span class="at">value</span>)<span class="op">.</span><span class="fu">toEqual</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true"></a></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true"></a>  <span class="fu">it</span>(<span class="st">&#39;should handle incrementByAmount&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true"></a>    const actual <span class="op">=</span> <span class="fu">counterReducer</span>(initialState<span class="op">,</span> <span class="fu">incrementByAmount</span>(<span class="dv">2</span>))<span class="op">;</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true"></a>    <span class="fu">expect</span>(actual<span class="op">.</span><span class="at">value</span>)<span class="op">.</span><span class="fu">toEqual</span>(<span class="dv">5</span>)<span class="op">;</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true"></a>  })<span class="op">;</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true"></a>})<span class="op">;</span></span></code></pre></div>
<p>One thing that I have not paid any attention to is testing so far. One week, I will sit down to test. Not today.</p>
<h3 id="featurescountercounterslice.ts">/features/counter/counterSlice.ts</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a><span class="im">import</span> { createAsyncThunk<span class="op">,</span> createSlice<span class="op">,</span> PayloadAction } from <span class="st">&#39;@reduxjs/toolkit&#39;</span><span class="op">;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true"></a><span class="im">import</span> { RootState<span class="op">,</span> AppThunk } from <span class="st">&#39;../../app/store&#39;</span><span class="op">;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true"></a><span class="im">import</span> { fetchCount } from <span class="st">&#39;./counterAPI&#39;</span><span class="op">;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true"></a>export interface CounterState {</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true"></a>  value<span class="op">:</span> <span class="dt">number</span><span class="op">;</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true"></a>  status<span class="op">:</span> <span class="st">&#39;idle&#39;</span> <span class="op">|</span> <span class="st">&#39;loading&#39;</span> <span class="op">|</span> <span class="st">&#39;failed&#39;</span><span class="op">;</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true"></a>}</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true"></a>const initialState<span class="op">:</span> CounterState <span class="op">=</span> {</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true"></a>  value<span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true"></a>  status<span class="op">:</span> <span class="st">&#39;idle&#39;</span><span class="op">,</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true"></a>}<span class="op">;</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true"></a><span class="co">// The function below is called a thunk and allows us to perform async logic. It</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true"></a><span class="co">// can be dispatched like a regular action: `dispatch(incrementAsync(10))`. This</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true"></a><span class="co">// will call the thunk with the `dispatch` function as the first argument. Async</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true"></a><span class="co">// code can then be executed and other actions can be dispatched. Thunks are</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true"></a><span class="co">// typically used to make async requests.</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true"></a>export const incrementAsync <span class="op">=</span> <span class="fu">createAsyncThunk</span>(</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true"></a>  <span class="st">&#39;counter/fetchCount&#39;</span><span class="op">,</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true"></a>  <span class="fu">async</span> (amount<span class="op">:</span> <span class="dt">number</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true"></a>    const response <span class="op">=</span> await <span class="fu">fetchCount</span>(amount)<span class="op">;</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true"></a>    <span class="co">// The value we return becomes the `fulfilled` action payload</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true"></a>    return response<span class="op">.</span><span class="at">data</span><span class="op">;</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true"></a>  }</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true"></a>)<span class="op">;</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true"></a></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true"></a>export const counterSlice <span class="op">=</span> <span class="fu">createSlice</span>({</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true"></a>  name<span class="op">:</span> <span class="st">&#39;counter&#39;</span><span class="op">,</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true"></a>  initialState<span class="op">,</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true"></a>  <span class="co">// The `reducers` field lets us define reducers and generate associated actions</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true"></a>  reducers<span class="op">:</span> {</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true"></a>    increment<span class="op">:</span> (state) <span class="kw">=&gt;</span> {</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true"></a>      <span class="co">// Redux Toolkit allows us to write &quot;mutating&quot; logic in reducers. It</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true"></a>      <span class="co">// doesn&#39;t actually mutate the state because it uses the Immer library,</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true"></a>      <span class="co">// which detects changes to a &quot;draft state&quot; and produces a brand new</span></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true"></a>      <span class="co">// immutable state based off those changes</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true"></a>      state<span class="op">.</span><span class="at">value</span> <span class="op">+=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true"></a>    }<span class="op">,</span></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true"></a>    decrement<span class="op">:</span> (state) <span class="kw">=&gt;</span> {</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true"></a>      state<span class="op">.</span><span class="at">value</span> <span class="op">-=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true"></a>    }<span class="op">,</span></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true"></a>    <span class="co">// Use the PayloadAction type to declare the contents of `action.payload`</span></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true"></a>    incrementByAmount<span class="op">:</span> (state<span class="op">,</span> action<span class="op">:</span> PayloadAction<span class="op">&lt;</span><span class="dt">number</span><span class="op">&gt;</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true"></a>      state<span class="op">.</span><span class="at">value</span> <span class="op">+=</span> action<span class="op">.</span><span class="at">payload</span><span class="op">;</span></span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true"></a>    }<span class="op">,</span></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true"></a>  }<span class="op">,</span></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true"></a>  <span class="co">// The `extraReducers` field lets the slice handle actions defined elsewhere,</span></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true"></a>  <span class="co">// including actions generated by createAsyncThunk or in other slices.</span></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true"></a>  extraReducers<span class="op">:</span> (builder) <span class="kw">=&gt;</span> {</span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true"></a>    builder</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true"></a>      <span class="op">.</span><span class="fu">addCase</span>(incrementAsync<span class="op">.</span><span class="at">pending</span><span class="op">,</span> (state) <span class="kw">=&gt;</span> {</span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true"></a>        state<span class="op">.</span><span class="at">status</span> <span class="op">=</span> <span class="st">&#39;loading&#39;</span><span class="op">;</span></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true"></a>      })</span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true"></a>      <span class="op">.</span><span class="fu">addCase</span>(incrementAsync<span class="op">.</span><span class="at">fulfilled</span><span class="op">,</span> (state<span class="op">,</span> action) <span class="kw">=&gt;</span> {</span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true"></a>        state<span class="op">.</span><span class="at">status</span> <span class="op">=</span> <span class="st">&#39;idle&#39;</span><span class="op">;</span></span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true"></a>        state<span class="op">.</span><span class="at">value</span> <span class="op">+=</span> action<span class="op">.</span><span class="at">payload</span><span class="op">;</span></span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true"></a>      })<span class="op">;</span></span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true"></a>  }<span class="op">,</span></span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true"></a>})<span class="op">;</span></span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true"></a></span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true"></a>export const { increment<span class="op">,</span> decrement<span class="op">,</span> incrementByAmount } <span class="op">=</span> counterSlice<span class="op">.</span><span class="at">actions</span><span class="op">;</span></span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true"></a></span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true"></a><span class="co">// The function below is called a selector and allows us to select a value from</span></span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true"></a><span class="co">// the state. Selectors can also be defined inline where they&#39;re used instead of</span></span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true"></a><span class="co">// in the slice file. For example: `useSelector((state: RootState) =&gt; state.counter.value)`</span></span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true"></a>export const selectCount <span class="op">=</span> (state<span class="op">:</span> RootState) <span class="kw">=&gt;</span> state<span class="op">.</span><span class="at">counter</span><span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true"></a></span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true"></a><span class="co">// We can also write thunks by hand, which may contain both sync and async logic.</span></span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true"></a><span class="co">// Here&#39;s an example of conditionally dispatching actions based on current state.</span></span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true"></a>export const incrementIfOdd <span class="op">=</span> (amount<span class="op">:</span> <span class="dt">number</span>)<span class="op">:</span> AppThunk <span class="kw">=&gt;</span> (</span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true"></a>  dispatch<span class="op">,</span></span>
<span id="cb31-74"><a href="#cb31-74" aria-hidden="true"></a>  getState</span>
<span id="cb31-75"><a href="#cb31-75" aria-hidden="true"></a>) <span class="kw">=&gt;</span> {</span>
<span id="cb31-76"><a href="#cb31-76" aria-hidden="true"></a>  const currentValue <span class="op">=</span> <span class="fu">selectCount</span>(<span class="fu">getState</span>())<span class="op">;</span></span>
<span id="cb31-77"><a href="#cb31-77" aria-hidden="true"></a>  <span class="fu">if</span> (currentValue <span class="op">%</span> <span class="dv">2</span> <span class="op">===</span> <span class="dv">1</span>) {</span>
<span id="cb31-78"><a href="#cb31-78" aria-hidden="true"></a>    <span class="fu">dispatch</span>(<span class="fu">incrementByAmount</span>(amount))<span class="op">;</span></span>
<span id="cb31-79"><a href="#cb31-79" aria-hidden="true"></a>  }</span>
<span id="cb31-80"><a href="#cb31-80" aria-hidden="true"></a>}<span class="op">;</span></span>
<span id="cb31-81"><a href="#cb31-81" aria-hidden="true"></a></span>
<span id="cb31-82"><a href="#cb31-82" aria-hidden="true"></a>export default counterSlice<span class="op">.</span><span class="at">reducer</span><span class="op">;</span></span></code></pre></div>
<h4 id="createasyncthunk"><code>createAsyncThunk</code></h4>
<div class="sourceCode" id="cb32"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a>export <span class="kw">declare</span> <span class="kw">function</span> createAsyncThunk</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true"></a>    <span class="op">&lt;</span>Returned<span class="op">,</span> ThunkArg <span class="op">=</span> <span class="dt">void</span><span class="op">&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true"></a>    (</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true"></a>    typePrefix<span class="op">:</span> <span class="dt">string</span><span class="op">,</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true"></a>    payloadCreator<span class="op">:</span> AsyncThunkPayloadCreator<span class="op">&lt;</span>Returned<span class="op">,</span> ThunkArg<span class="op">,</span> {}<span class="op">&gt;,</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true"></a>    options<span class="op">?:</span> AsyncThunkOptions<span class="op">&lt;</span>ThunkArg<span class="op">,</span> {}<span class="op">&gt;</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true"></a>    )</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true"></a>    <span class="op">:</span> AsyncThunk<span class="op">&lt;</span>Returned<span class="op">,</span> ThunkArg<span class="op">,</span> {}<span class="op">&gt;;</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true"></a>export <span class="kw">declare</span> <span class="kw">function</span> createAsyncThunk</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true"></a>    <span class="op">&lt;</span>Returned<span class="op">,</span> ThunkArg<span class="op">,</span> ThunkApiConfig extends AsyncThunkConfig<span class="op">&gt;</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true"></a>        (</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true"></a>        typePrefix<span class="op">:</span> <span class="dt">string</span><span class="op">,</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true"></a>        payloadCreator<span class="op">:</span> AsyncThunkPayloadCreator<span class="op">&lt;</span>Returned<span class="op">,</span> ThunkArg<span class="op">,</span> ThunkApiConfig<span class="op">&gt;,</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true"></a>        options<span class="op">?:</span> AsyncThunkOptions<span class="op">&lt;</span>ThunkArg<span class="op">,</span> ThunkApiConfig<span class="op">&gt;</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true"></a>        )</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true"></a>        <span class="op">:</span> AsyncThunk<span class="op">&lt;</span>Returned<span class="op">,</span> ThunkArg<span class="op">,</span> ThunkApiConfig<span class="op">&gt;;</span></span></code></pre></div>
<p>Source code from reduxjs/redux-toolkit</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true"></a>export <span class="kw">function</span> createAsyncThunk<span class="op">&lt;</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true"></a>  Returned<span class="op">,</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true"></a>  ThunkArg<span class="op">,</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true"></a>  ThunkApiConfig extends AsyncThunkConfig</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true"></a><span class="op">&gt;</span>(</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true"></a>  typePrefix<span class="op">:</span> <span class="dt">string</span><span class="op">,</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true"></a>  payloadCreator<span class="op">:</span> AsyncThunkPayloadCreator<span class="op">&lt;</span>Returned<span class="op">,</span> ThunkArg<span class="op">,</span> ThunkApiConfig<span class="op">&gt;,</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true"></a>  options<span class="op">?:</span> AsyncThunkOptions<span class="op">&lt;</span>ThunkArg<span class="op">,</span> ThunkApiConfig<span class="op">&gt;</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true"></a>)<span class="op">:</span> AsyncThunk<span class="op">&lt;</span>Returned<span class="op">,</span> ThunkArg<span class="op">,</span> ThunkApiConfig<span class="op">&gt;</span> {</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true"></a>  <span class="kw">type</span> RejectedValue <span class="op">=</span> GetRejectValue<span class="op">&lt;</span>ThunkApiConfig<span class="op">&gt;</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true"></a>  <span class="kw">type</span> PendingMeta <span class="op">=</span> GetPendingMeta<span class="op">&lt;</span>ThunkApiConfig<span class="op">&gt;</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true"></a>  <span class="kw">type</span> FulfilledMeta <span class="op">=</span> GetFulfilledMeta<span class="op">&lt;</span>ThunkApiConfig<span class="op">&gt;</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true"></a>  <span class="kw">type</span> RejectedMeta <span class="op">=</span> GetRejectedMeta<span class="op">&lt;</span>ThunkApiConfig<span class="op">&gt;</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true"></a></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true"></a>  const fulfilled<span class="op">:</span> AsyncThunkFulfilledActionCreator<span class="op">&lt;</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true"></a>    Returned<span class="op">,</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true"></a>    ThunkArg<span class="op">,</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true"></a>    ThunkApiConfig</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true"></a>  <span class="op">&gt;</span> <span class="op">=</span> <span class="fu">createAction</span>(</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true"></a>    typePrefix <span class="op">+</span> <span class="st">&#39;/fulfilled&#39;</span><span class="op">,</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true"></a>    (</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true"></a>      payload<span class="op">:</span> Returned<span class="op">,</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true"></a>      requestId<span class="op">:</span> <span class="dt">string</span><span class="op">,</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true"></a>      arg<span class="op">:</span> ThunkArg<span class="op">,</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true"></a>      meta<span class="op">?:</span> FulfilledMeta</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true"></a>    ) <span class="kw">=&gt;</span> ({</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true"></a>      payload<span class="op">,</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true"></a>      meta<span class="op">:</span> {</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true"></a>        <span class="op">...</span>((meta <span class="im">as</span> <span class="dt">any</span>) <span class="op">||</span> {})<span class="op">,</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true"></a>        arg<span class="op">,</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true"></a>        requestId<span class="op">,</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true"></a>        requestStatus<span class="op">:</span> <span class="st">&#39;fulfilled&#39;</span> <span class="im">as</span> const<span class="op">,</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true"></a>      }<span class="op">,</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true"></a>    })</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true"></a>  )</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true"></a></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true"></a>  const pending<span class="op">:</span> AsyncThunkPendingActionCreator<span class="op">&lt;</span>ThunkArg<span class="op">,</span> ThunkApiConfig<span class="op">&gt;</span> <span class="op">=</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true"></a>    <span class="fu">createAction</span>(</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true"></a>      typePrefix <span class="op">+</span> <span class="st">&#39;/pending&#39;</span><span class="op">,</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true"></a>      (requestId<span class="op">:</span> <span class="dt">string</span><span class="op">,</span> arg<span class="op">:</span> ThunkArg<span class="op">,</span> meta<span class="op">?:</span> PendingMeta) <span class="kw">=&gt;</span> ({</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true"></a>        payload<span class="op">:</span> <span class="dt">undefined</span><span class="op">,</span></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true"></a>        meta<span class="op">:</span> {</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true"></a>          <span class="op">...</span>((meta <span class="im">as</span> <span class="dt">any</span>) <span class="op">||</span> {})<span class="op">,</span></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true"></a>          arg<span class="op">,</span></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true"></a>          requestId<span class="op">,</span></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true"></a>          requestStatus<span class="op">:</span> <span class="st">&#39;pending&#39;</span> <span class="im">as</span> const<span class="op">,</span></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true"></a>        }<span class="op">,</span></span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true"></a>      })</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true"></a>    )</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true"></a></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true"></a>  const rejected<span class="op">:</span> AsyncThunkRejectedActionCreator<span class="op">&lt;</span>ThunkArg<span class="op">,</span> ThunkApiConfig<span class="op">&gt;</span> <span class="op">=</span></span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true"></a>    <span class="fu">createAction</span>(</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true"></a>      typePrefix <span class="op">+</span> <span class="st">&#39;/rejected&#39;</span><span class="op">,</span></span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true"></a>      (</span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true"></a>        error<span class="op">:</span> Error <span class="op">|</span> <span class="dt">null</span><span class="op">,</span></span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true"></a>        requestId<span class="op">:</span> <span class="dt">string</span><span class="op">,</span></span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true"></a>        arg<span class="op">:</span> ThunkArg<span class="op">,</span></span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true"></a>        payload<span class="op">?:</span> RejectedValue<span class="op">,</span></span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true"></a>        meta<span class="op">?:</span> RejectedMeta</span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true"></a>      ) <span class="kw">=&gt;</span> ({</span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true"></a>        payload<span class="op">,</span></span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true"></a>        error<span class="op">:</span> ((options <span class="op">&amp;&amp;</span> options<span class="op">.</span><span class="at">serializeError</span>) <span class="op">||</span> miniSerializeError)(</span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true"></a>          error <span class="op">||</span> <span class="st">&#39;Rejected&#39;</span></span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true"></a>        ) <span class="im">as</span> GetSerializedErrorType<span class="op">&lt;</span>ThunkApiConfig<span class="op">&gt;,</span></span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true"></a>        meta<span class="op">:</span> {</span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true"></a>          <span class="op">...</span>((meta <span class="im">as</span> <span class="dt">any</span>) <span class="op">||</span> {})<span class="op">,</span></span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true"></a>          arg<span class="op">,</span></span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true"></a>          requestId<span class="op">,</span></span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true"></a>          rejectedWithValue<span class="op">:</span> <span class="op">!!</span>payload<span class="op">,</span></span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true"></a>          requestStatus<span class="op">:</span> <span class="st">&#39;rejected&#39;</span> <span class="im">as</span> const<span class="op">,</span></span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true"></a>          aborted<span class="op">:</span> error<span class="op">?.</span><span class="at">name</span> <span class="op">===</span> <span class="st">&#39;AbortError&#39;</span><span class="op">,</span></span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true"></a>          condition<span class="op">:</span> error<span class="op">?.</span><span class="at">name</span> <span class="op">===</span> <span class="st">&#39;ConditionError&#39;</span><span class="op">,</span></span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true"></a>        }<span class="op">,</span></span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true"></a>      })</span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true"></a>    )</span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true"></a></span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true"></a>  let displayedWarning <span class="op">=</span> false</span>
<span id="cb33-78"><a href="#cb33-78" aria-hidden="true"></a></span>
<span id="cb33-79"><a href="#cb33-79" aria-hidden="true"></a>  const AC <span class="op">=</span></span>
<span id="cb33-80"><a href="#cb33-80" aria-hidden="true"></a>    typeof AbortController <span class="op">!==</span> <span class="st">&#39;undefined&#39;</span></span>
<span id="cb33-81"><a href="#cb33-81" aria-hidden="true"></a>      <span class="op">?</span> AbortController</span>
<span id="cb33-82"><a href="#cb33-82" aria-hidden="true"></a>      <span class="op">:</span> class implements AbortController {</span>
<span id="cb33-83"><a href="#cb33-83" aria-hidden="true"></a>          signal<span class="op">:</span> AbortSignal <span class="op">=</span> {</span>
<span id="cb33-84"><a href="#cb33-84" aria-hidden="true"></a>            aborted<span class="op">:</span> false<span class="op">,</span></span>
<span id="cb33-85"><a href="#cb33-85" aria-hidden="true"></a>            <span class="fu">addEventListener</span>() {}<span class="op">,</span></span>
<span id="cb33-86"><a href="#cb33-86" aria-hidden="true"></a>            <span class="fu">dispatchEvent</span>() {</span>
<span id="cb33-87"><a href="#cb33-87" aria-hidden="true"></a>              return false</span>
<span id="cb33-88"><a href="#cb33-88" aria-hidden="true"></a>            }<span class="op">,</span></span>
<span id="cb33-89"><a href="#cb33-89" aria-hidden="true"></a>            <span class="fu">onabort</span>() {}<span class="op">,</span></span>
<span id="cb33-90"><a href="#cb33-90" aria-hidden="true"></a>            <span class="fu">removeEventListener</span>() {}<span class="op">,</span></span>
<span id="cb33-91"><a href="#cb33-91" aria-hidden="true"></a>          }</span>
<span id="cb33-92"><a href="#cb33-92" aria-hidden="true"></a>          <span class="fu">abort</span>() {</span>
<span id="cb33-93"><a href="#cb33-93" aria-hidden="true"></a>            <span class="fu">if</span> (<span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">NODE_ENV</span> <span class="op">!==</span> <span class="st">&#39;production&#39;</span>) {</span>
<span id="cb33-94"><a href="#cb33-94" aria-hidden="true"></a>              <span class="fu">if</span> (<span class="op">!</span>displayedWarning) {</span>
<span id="cb33-95"><a href="#cb33-95" aria-hidden="true"></a>                displayedWarning <span class="op">=</span> true</span>
<span id="cb33-96"><a href="#cb33-96" aria-hidden="true"></a>                <span class="bu">console</span><span class="op">.</span><span class="fu">info</span>(</span>
<span id="cb33-97"><a href="#cb33-97" aria-hidden="true"></a>                  <span class="vs">`This platform does not implement AbortController.</span></span>
<span id="cb33-98"><a href="#cb33-98" aria-hidden="true"></a><span class="vs">If you want to use the AbortController to react to </span><span class="sc">\`</span><span class="vs">abort</span><span class="sc">\`</span><span class="vs"> events, please consider importing a polyfill like &#39;abortcontroller-polyfill/dist/abortcontroller-polyfill-only&#39;.`</span></span>
<span id="cb33-99"><a href="#cb33-99" aria-hidden="true"></a>                )</span>
<span id="cb33-100"><a href="#cb33-100" aria-hidden="true"></a>              }</span>
<span id="cb33-101"><a href="#cb33-101" aria-hidden="true"></a>            }</span>
<span id="cb33-102"><a href="#cb33-102" aria-hidden="true"></a>          }</span>
<span id="cb33-103"><a href="#cb33-103" aria-hidden="true"></a>        }</span>
<span id="cb33-104"><a href="#cb33-104" aria-hidden="true"></a></span>
<span id="cb33-105"><a href="#cb33-105" aria-hidden="true"></a>  <span class="kw">function</span> <span class="fu">actionCreator</span>(</span>
<span id="cb33-106"><a href="#cb33-106" aria-hidden="true"></a>    arg<span class="op">:</span> ThunkArg</span>
<span id="cb33-107"><a href="#cb33-107" aria-hidden="true"></a>  )<span class="op">:</span> AsyncThunkAction<span class="op">&lt;</span>Returned<span class="op">,</span> ThunkArg<span class="op">,</span> ThunkApiConfig<span class="op">&gt;</span> {</span>
<span id="cb33-108"><a href="#cb33-108" aria-hidden="true"></a>    <span class="fu">return</span> (dispatch<span class="op">,</span> getState<span class="op">,</span> extra) <span class="kw">=&gt;</span> {</span>
<span id="cb33-109"><a href="#cb33-109" aria-hidden="true"></a>      const requestId <span class="op">=</span> options<span class="op">?.</span><span class="at">idGenerator</span></span>
<span id="cb33-110"><a href="#cb33-110" aria-hidden="true"></a>        <span class="op">?</span> options<span class="op">.</span><span class="fu">idGenerator</span>(arg)</span>
<span id="cb33-111"><a href="#cb33-111" aria-hidden="true"></a>        <span class="op">:</span> <span class="fu">nanoid</span>()</span>
<span id="cb33-112"><a href="#cb33-112" aria-hidden="true"></a></span>
<span id="cb33-113"><a href="#cb33-113" aria-hidden="true"></a>      const abortController <span class="op">=</span> <span class="kw">new</span> <span class="fu">AC</span>()</span>
<span id="cb33-114"><a href="#cb33-114" aria-hidden="true"></a>      let abortReason<span class="op">:</span> <span class="dt">string</span> <span class="op">|</span> <span class="dt">undefined</span></span>
<span id="cb33-115"><a href="#cb33-115" aria-hidden="true"></a></span>
<span id="cb33-116"><a href="#cb33-116" aria-hidden="true"></a>      const abortedPromise <span class="op">=</span> <span class="kw">new</span> <span class="bu">Promise</span><span class="op">&lt;</span><span class="dt">never</span><span class="op">&gt;</span>((_<span class="op">,</span> reject) <span class="kw">=&gt;</span></span>
<span id="cb33-117"><a href="#cb33-117" aria-hidden="true"></a>        abortController<span class="op">.</span><span class="at">signal</span><span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;abort&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span></span>
<span id="cb33-118"><a href="#cb33-118" aria-hidden="true"></a>          <span class="fu">reject</span>({ name<span class="op">:</span> <span class="st">&#39;AbortError&#39;</span><span class="op">,</span> message<span class="op">:</span> abortReason <span class="op">||</span> <span class="st">&#39;Aborted&#39;</span> })</span>
<span id="cb33-119"><a href="#cb33-119" aria-hidden="true"></a>        )</span>
<span id="cb33-120"><a href="#cb33-120" aria-hidden="true"></a>      )</span>
<span id="cb33-121"><a href="#cb33-121" aria-hidden="true"></a></span>
<span id="cb33-122"><a href="#cb33-122" aria-hidden="true"></a>      let started <span class="op">=</span> false</span>
<span id="cb33-123"><a href="#cb33-123" aria-hidden="true"></a>      <span class="kw">function</span> <span class="fu">abort</span>(reason<span class="op">?:</span> <span class="dt">string</span>) {</span>
<span id="cb33-124"><a href="#cb33-124" aria-hidden="true"></a>        <span class="fu">if</span> (started) {</span>
<span id="cb33-125"><a href="#cb33-125" aria-hidden="true"></a>          abortReason <span class="op">=</span> reason</span>
<span id="cb33-126"><a href="#cb33-126" aria-hidden="true"></a>          abortController<span class="op">.</span><span class="fu">abort</span>()</span>
<span id="cb33-127"><a href="#cb33-127" aria-hidden="true"></a>        }</span>
<span id="cb33-128"><a href="#cb33-128" aria-hidden="true"></a>      }</span>
<span id="cb33-129"><a href="#cb33-129" aria-hidden="true"></a></span>
<span id="cb33-130"><a href="#cb33-130" aria-hidden="true"></a>      const promise <span class="op">=</span> (async <span class="kw">function</span> () {</span>
<span id="cb33-131"><a href="#cb33-131" aria-hidden="true"></a>        let finalAction<span class="op">:</span> <span class="bu">ReturnType</span><span class="op">&lt;</span>typeof fulfilled <span class="op">|</span> typeof rejected<span class="op">&gt;</span></span>
<span id="cb33-132"><a href="#cb33-132" aria-hidden="true"></a>        try {</span>
<span id="cb33-133"><a href="#cb33-133" aria-hidden="true"></a>          let conditionResult <span class="op">=</span> options<span class="op">?.</span><span class="at">condition</span><span class="op">?.</span>(arg<span class="op">,</span> { getState<span class="op">,</span> extra })</span>
<span id="cb33-134"><a href="#cb33-134" aria-hidden="true"></a>          <span class="fu">if</span> (<span class="fu">isThenable</span>(conditionResult)) {</span>
<span id="cb33-135"><a href="#cb33-135" aria-hidden="true"></a>            conditionResult <span class="op">=</span> await conditionResult</span>
<span id="cb33-136"><a href="#cb33-136" aria-hidden="true"></a>          }</span>
<span id="cb33-137"><a href="#cb33-137" aria-hidden="true"></a>          <span class="fu">if</span> (conditionResult <span class="op">===</span> false) {</span>
<span id="cb33-138"><a href="#cb33-138" aria-hidden="true"></a>            <span class="co">// eslint-disable-next-line no-throw-literal</span></span>
<span id="cb33-139"><a href="#cb33-139" aria-hidden="true"></a>            throw {</span>
<span id="cb33-140"><a href="#cb33-140" aria-hidden="true"></a>              name<span class="op">:</span> <span class="st">&#39;ConditionError&#39;</span><span class="op">,</span></span>
<span id="cb33-141"><a href="#cb33-141" aria-hidden="true"></a>              message<span class="op">:</span> <span class="st">&#39;Aborted due to condition callback returning false.&#39;</span><span class="op">,</span></span>
<span id="cb33-142"><a href="#cb33-142" aria-hidden="true"></a>            }</span>
<span id="cb33-143"><a href="#cb33-143" aria-hidden="true"></a>          }</span>
<span id="cb33-144"><a href="#cb33-144" aria-hidden="true"></a>          started <span class="op">=</span> true</span>
<span id="cb33-145"><a href="#cb33-145" aria-hidden="true"></a>          <span class="fu">dispatch</span>(</span>
<span id="cb33-146"><a href="#cb33-146" aria-hidden="true"></a>            <span class="fu">pending</span>(</span>
<span id="cb33-147"><a href="#cb33-147" aria-hidden="true"></a>              requestId<span class="op">,</span></span>
<span id="cb33-148"><a href="#cb33-148" aria-hidden="true"></a>              arg<span class="op">,</span></span>
<span id="cb33-149"><a href="#cb33-149" aria-hidden="true"></a>              options<span class="op">?.</span><span class="at">getPendingMeta</span><span class="op">?.</span>({ requestId<span class="op">,</span> arg }<span class="op">,</span> { getState<span class="op">,</span> extra })</span>
<span id="cb33-150"><a href="#cb33-150" aria-hidden="true"></a>            )</span>
<span id="cb33-151"><a href="#cb33-151" aria-hidden="true"></a>          )</span>
<span id="cb33-152"><a href="#cb33-152" aria-hidden="true"></a>          finalAction <span class="op">=</span> await <span class="bu">Promise</span><span class="op">.</span><span class="fu">race</span>([</span>
<span id="cb33-153"><a href="#cb33-153" aria-hidden="true"></a>            abortedPromise<span class="op">,</span></span>
<span id="cb33-154"><a href="#cb33-154" aria-hidden="true"></a>            <span class="bu">Promise</span><span class="op">.</span><span class="fu">resolve</span>(</span>
<span id="cb33-155"><a href="#cb33-155" aria-hidden="true"></a>              <span class="fu">payloadCreator</span>(arg<span class="op">,</span> {</span>
<span id="cb33-156"><a href="#cb33-156" aria-hidden="true"></a>                dispatch<span class="op">,</span></span>
<span id="cb33-157"><a href="#cb33-157" aria-hidden="true"></a>                getState<span class="op">,</span></span>
<span id="cb33-158"><a href="#cb33-158" aria-hidden="true"></a>                extra<span class="op">,</span></span>
<span id="cb33-159"><a href="#cb33-159" aria-hidden="true"></a>                requestId<span class="op">,</span></span>
<span id="cb33-160"><a href="#cb33-160" aria-hidden="true"></a>                signal<span class="op">:</span> abortController<span class="op">.</span><span class="at">signal</span><span class="op">,</span></span>
<span id="cb33-161"><a href="#cb33-161" aria-hidden="true"></a>                rejectWithValue<span class="op">:</span> ((</span>
<span id="cb33-162"><a href="#cb33-162" aria-hidden="true"></a>                  value<span class="op">:</span> RejectedValue<span class="op">,</span></span>
<span id="cb33-163"><a href="#cb33-163" aria-hidden="true"></a>                  meta<span class="op">?:</span> RejectedMeta</span>
<span id="cb33-164"><a href="#cb33-164" aria-hidden="true"></a>                ) <span class="kw">=&gt;</span> {</span>
<span id="cb33-165"><a href="#cb33-165" aria-hidden="true"></a>                  return <span class="kw">new</span> <span class="fu">RejectWithValue</span>(value<span class="op">,</span> meta)</span>
<span id="cb33-166"><a href="#cb33-166" aria-hidden="true"></a>                }) <span class="im">as</span> <span class="dt">any</span><span class="op">,</span></span>
<span id="cb33-167"><a href="#cb33-167" aria-hidden="true"></a>                fulfillWithValue<span class="op">:</span> ((value<span class="op">:</span> <span class="dt">unknown</span><span class="op">,</span> meta<span class="op">?:</span> FulfilledMeta) <span class="kw">=&gt;</span> {</span>
<span id="cb33-168"><a href="#cb33-168" aria-hidden="true"></a>                  return <span class="kw">new</span> <span class="fu">FulfillWithMeta</span>(value<span class="op">,</span> meta)</span>
<span id="cb33-169"><a href="#cb33-169" aria-hidden="true"></a>                }) <span class="im">as</span> <span class="dt">any</span><span class="op">,</span></span>
<span id="cb33-170"><a href="#cb33-170" aria-hidden="true"></a>              })</span>
<span id="cb33-171"><a href="#cb33-171" aria-hidden="true"></a>            )<span class="op">.</span><span class="fu">then</span>((result) <span class="kw">=&gt;</span> {</span>
<span id="cb33-172"><a href="#cb33-172" aria-hidden="true"></a>              <span class="fu">if</span> (result instanceof RejectWithValue) {</span>
<span id="cb33-173"><a href="#cb33-173" aria-hidden="true"></a>                throw result</span>
<span id="cb33-174"><a href="#cb33-174" aria-hidden="true"></a>              }</span>
<span id="cb33-175"><a href="#cb33-175" aria-hidden="true"></a>              <span class="fu">if</span> (result instanceof FulfillWithMeta) {</span>
<span id="cb33-176"><a href="#cb33-176" aria-hidden="true"></a>                return <span class="fu">fulfilled</span>(result<span class="op">.</span><span class="at">payload</span><span class="op">,</span> requestId<span class="op">,</span> arg<span class="op">,</span> result<span class="op">.</span><span class="at">meta</span>)</span>
<span id="cb33-177"><a href="#cb33-177" aria-hidden="true"></a>              }</span>
<span id="cb33-178"><a href="#cb33-178" aria-hidden="true"></a>              return <span class="fu">fulfilled</span>(result <span class="im">as</span> <span class="dt">any</span><span class="op">,</span> requestId<span class="op">,</span> arg)</span>
<span id="cb33-179"><a href="#cb33-179" aria-hidden="true"></a>            })<span class="op">,</span></span>
<span id="cb33-180"><a href="#cb33-180" aria-hidden="true"></a>          ])</span>
<span id="cb33-181"><a href="#cb33-181" aria-hidden="true"></a>        } <span class="fu">catch</span> (err) {</span>
<span id="cb33-182"><a href="#cb33-182" aria-hidden="true"></a>          finalAction <span class="op">=</span></span>
<span id="cb33-183"><a href="#cb33-183" aria-hidden="true"></a>            err instanceof RejectWithValue</span>
<span id="cb33-184"><a href="#cb33-184" aria-hidden="true"></a>              <span class="op">?</span> <span class="fu">rejected</span>(null<span class="op">,</span> requestId<span class="op">,</span> arg<span class="op">,</span> err<span class="op">.</span><span class="at">payload</span><span class="op">,</span> err<span class="op">.</span><span class="at">meta</span>)</span>
<span id="cb33-185"><a href="#cb33-185" aria-hidden="true"></a>              <span class="op">:</span> <span class="fu">rejected</span>(err <span class="im">as</span> <span class="dt">any</span><span class="op">,</span> requestId<span class="op">,</span> arg)</span>
<span id="cb33-186"><a href="#cb33-186" aria-hidden="true"></a>        }</span>
<span id="cb33-187"><a href="#cb33-187" aria-hidden="true"></a>        <span class="co">// We dispatch the result action _after_ the catch, to avoid having any errors</span></span>
<span id="cb33-188"><a href="#cb33-188" aria-hidden="true"></a>        <span class="co">// here get swallowed by the try/catch block,</span></span>
<span id="cb33-189"><a href="#cb33-189" aria-hidden="true"></a>        <span class="co">// per https://twitter.com/dan_abramov/status/770914221638942720</span></span>
<span id="cb33-190"><a href="#cb33-190" aria-hidden="true"></a>        <span class="co">// and https://github.com/reduxjs/redux-toolkit/blob/e85eb17b39a2118d859f7b7746e0f3fee523e089/docs/tutorials/advanced-tutorial.md#async-error-handling-logic-in-thunks</span></span>
<span id="cb33-191"><a href="#cb33-191" aria-hidden="true"></a></span>
<span id="cb33-192"><a href="#cb33-192" aria-hidden="true"></a>        const skipDispatch <span class="op">=</span></span>
<span id="cb33-193"><a href="#cb33-193" aria-hidden="true"></a>          options <span class="op">&amp;&amp;</span></span>
<span id="cb33-194"><a href="#cb33-194" aria-hidden="true"></a>          <span class="op">!</span>options<span class="op">.</span><span class="at">dispatchConditionRejection</span> <span class="op">&amp;&amp;</span></span>
<span id="cb33-195"><a href="#cb33-195" aria-hidden="true"></a>          rejected<span class="op">.</span><span class="fu">match</span>(finalAction) <span class="op">&amp;&amp;</span></span>
<span id="cb33-196"><a href="#cb33-196" aria-hidden="true"></a>          (finalAction <span class="im">as</span> <span class="dt">any</span>)<span class="op">.</span><span class="at">meta</span><span class="op">.</span><span class="at">condition</span></span>
<span id="cb33-197"><a href="#cb33-197" aria-hidden="true"></a></span>
<span id="cb33-198"><a href="#cb33-198" aria-hidden="true"></a>        <span class="fu">if</span> (<span class="op">!</span>skipDispatch) {</span>
<span id="cb33-199"><a href="#cb33-199" aria-hidden="true"></a>          <span class="fu">dispatch</span>(finalAction)</span>
<span id="cb33-200"><a href="#cb33-200" aria-hidden="true"></a>        }</span>
<span id="cb33-201"><a href="#cb33-201" aria-hidden="true"></a>        return finalAction</span>
<span id="cb33-202"><a href="#cb33-202" aria-hidden="true"></a>      })()</span>
<span id="cb33-203"><a href="#cb33-203" aria-hidden="true"></a>      return Object<span class="op">.</span><span class="fu">assign</span>(promise <span class="im">as</span> <span class="bu">Promise</span><span class="op">&lt;</span><span class="dt">any</span><span class="op">&gt;,</span> {</span>
<span id="cb33-204"><a href="#cb33-204" aria-hidden="true"></a>        abort<span class="op">,</span></span>
<span id="cb33-205"><a href="#cb33-205" aria-hidden="true"></a>        requestId<span class="op">,</span></span>
<span id="cb33-206"><a href="#cb33-206" aria-hidden="true"></a>        arg<span class="op">,</span></span>
<span id="cb33-207"><a href="#cb33-207" aria-hidden="true"></a>        <span class="fu">unwrap</span>() {</span>
<span id="cb33-208"><a href="#cb33-208" aria-hidden="true"></a>          return promise<span class="op">.</span><span class="fu">then</span><span class="op">&lt;</span><span class="dt">any</span><span class="op">&gt;</span>(unwrapResult)</span>
<span id="cb33-209"><a href="#cb33-209" aria-hidden="true"></a>        }<span class="op">,</span></span>
<span id="cb33-210"><a href="#cb33-210" aria-hidden="true"></a>      })</span>
<span id="cb33-211"><a href="#cb33-211" aria-hidden="true"></a>    }</span>
<span id="cb33-212"><a href="#cb33-212" aria-hidden="true"></a>  }</span>
<span id="cb33-213"><a href="#cb33-213" aria-hidden="true"></a></span>
<span id="cb33-214"><a href="#cb33-214" aria-hidden="true"></a>  return Object<span class="op">.</span><span class="fu">assign</span>(</span>
<span id="cb33-215"><a href="#cb33-215" aria-hidden="true"></a>    actionCreator <span class="im">as</span> AsyncThunkActionCreator<span class="op">&lt;</span></span>
<span id="cb33-216"><a href="#cb33-216" aria-hidden="true"></a>      Returned<span class="op">,</span></span>
<span id="cb33-217"><a href="#cb33-217" aria-hidden="true"></a>      ThunkArg<span class="op">,</span></span>
<span id="cb33-218"><a href="#cb33-218" aria-hidden="true"></a>      ThunkApiConfig</span>
<span id="cb33-219"><a href="#cb33-219" aria-hidden="true"></a>    <span class="op">&gt;,</span></span>
<span id="cb33-220"><a href="#cb33-220" aria-hidden="true"></a>    {</span>
<span id="cb33-221"><a href="#cb33-221" aria-hidden="true"></a>      pending<span class="op">,</span></span>
<span id="cb33-222"><a href="#cb33-222" aria-hidden="true"></a>      rejected<span class="op">,</span></span>
<span id="cb33-223"><a href="#cb33-223" aria-hidden="true"></a>      fulfilled<span class="op">,</span></span>
<span id="cb33-224"><a href="#cb33-224" aria-hidden="true"></a>      typePrefix<span class="op">,</span></span>
<span id="cb33-225"><a href="#cb33-225" aria-hidden="true"></a>    }</span>
<span id="cb33-226"><a href="#cb33-226" aria-hidden="true"></a>  )</span>
<span id="cb33-227"><a href="#cb33-227" aria-hidden="true"></a>}</span></code></pre></div>
<p>When I print the value via <code>console.info(incrementAsync);</code> we get:</p>
<figure>
<img src="21.what-is-incrementAsync.png" alt="" /><figcaption>21.what-is-incrementAsync</figcaption>
</figure>
<p>The return values do match.</p>
<p>Executing the object “incrementAsync” obtained from calling <code>createAsyncThunk</code>.</p>
<figure>
<img src="22.executing-incrementAsync.png" alt="" /><figcaption>22.executing-incrementAsync</figcaption>
</figure>
<p>If you notice, temp0 is store, and temp1 is incrementAsync.</p>
<p>As per code, we can call what is returned by <code>createAsyncThunk</code> and pass it to <code>dispatch</code>.</p>
<h4 id="type-asyncthunk"><code>type AsyncThunk</code></h4>
<div class="sourceCode" id="cb34"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true"></a><span class="co">/**</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true"></a><span class="co"> * A type describing the return value of `createAsyncThunk`.</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true"></a><span class="co"> * Might be useful for wrapping `createAsyncThunk` in custom abstractions.</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true"></a><span class="co"> *</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true"></a><span class="co"> * </span><span class="an">@public</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true"></a><span class="co"> */</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true"></a><span class="im">export type</span> AsyncThunk<span class="op">&lt;</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true"></a>  Returned<span class="op">,</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true"></a>  ThunkArg<span class="op">,</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true"></a>  ThunkApiConfig extends AsyncThunkConfig</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true"></a><span class="op">&gt;</span> <span class="op">=</span> AsyncThunkActionCreator<span class="op">&lt;</span>Returned<span class="op">,</span> ThunkArg<span class="op">,</span> ThunkApiConfig<span class="op">&gt;</span> <span class="op">&amp;</span> {</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true"></a>  pending<span class="op">:</span> AsyncThunkPendingActionCreator<span class="op">&lt;</span>ThunkArg<span class="op">,</span> ThunkApiConfig<span class="op">&gt;</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true"></a>  rejected<span class="op">:</span> AsyncThunkRejectedActionCreator<span class="op">&lt;</span>ThunkArg<span class="op">,</span> ThunkApiConfig<span class="op">&gt;</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true"></a>  fulfilled<span class="op">:</span> AsyncThunkFulfilledActionCreator<span class="op">&lt;</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true"></a>    Returned<span class="op">,</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true"></a>    ThunkArg<span class="op">,</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true"></a>    ThunkApiConfig</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true"></a>  <span class="op">&gt;</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true"></a>  typePrefix<span class="op">:</span> <span class="dt">string</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true"></a>}</span></code></pre></div>
<figure>
<img src="23.type-AsyncThunk.png" alt="" /><figcaption>23.type-AsyncThunk</figcaption>
</figure>
<h4 id="counter-2srcfeaturescountercounterslice.ts-incrementasync">counter-2/src/features/counter/counterSlice.ts incrementAsync</h4>
<div class="sourceCode" id="cb35"><pre class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true"></a><span class="co">// The function below is called a thunk and allows us to perform async logic. It</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true"></a><span class="co">// can be dispatched like a regular action: `dispatch(incrementAsync(10))`. This</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true"></a><span class="co">// will call the thunk with the `dispatch` function as the first argument. Async</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true"></a><span class="co">// code can then be executed and other actions can be dispatched. Thunks are</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true"></a><span class="co">// typically used to make async requests.</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true"></a>export const incrementAsync <span class="op">=</span> <span class="fu">createAsyncThunk</span>(</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true"></a>    <span class="st">&#39;counter/fetchCount&#39;</span><span class="op">,</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true"></a>    <span class="fu">async</span> (amount<span class="op">:</span> <span class="dt">number</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true"></a>        const response <span class="op">=</span> await <span class="fu">fetchCount</span>(amount)<span class="op">;</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true"></a>        <span class="co">// The value we return becomes the `fulfilled` action payload</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true"></a>        return response<span class="op">.</span><span class="at">data</span><span class="op">;</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true"></a>    }</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true"></a>)<span class="op">;</span></span></code></pre></div>
<figure>
<img src="24.incrementAsync.png" alt="" /><figcaption>24.incrementAsync</figcaption>
</figure>
<p>Let me reason about the code.</p>
<p><code>incrementAsync</code> is of the type <code>AsyncThunk&lt;number, number, {}&gt;</code> which means as per <code>AsyncThunk&lt;Returned, ThunkArg, ThunkApiConfig&gt;</code>, <code>Returned</code> and <code>ThunkArg</code> are <code>number</code>.</p>
<figure>
<img src="25.mapping-abstract-types-to-concrete-ones.png" alt="" /><figcaption>25.mapping-abstract-types-to-concrete-ones</figcaption>
</figure>
<p>The <code>Returned</code> type being <code>number</code> should be due to <code>fetchCount</code> returning a number value.</p>
<figure>
<img src="26.fetCount-returns-promise-of-a-number.png" alt="" /><figcaption>26.fetCount-returns-promise-of-a-number</figcaption>
</figure>
<p>When I change the return type of fetchCount, the type <code>Returned</code> in <code>incrementAsync</code> changes to `string.</p>
<figure>
<img src="27.type-of-Returned-changed-to-string.png" alt="" /><figcaption>27.type-of-Returned-changed-to-string</figcaption>
</figure>
<p>And when I change the input type to string, <code>ThunkArg</code> changes to <code>string</code>.</p>
<figure>
<img src="28.ThunkArg-changed-to-string.png" alt="" /><figcaption>28.ThunkArg-changed-to-string</figcaption>
</figure>
<p>to be continued…</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://egghead.io/lessons/react-create-a-reducer-with-redux-toolkit-and-dispatch-its-action-with-the-useappdispatch-hook">https://egghead.io/lessons/react-create-a-reducer-with-redux-toolkit-and-dispatch-its-action-with-the-useappdispatch-hook</a></li>
<li><a href="https://redux-toolkit.js.org/tutorials/overview">https://redux-toolkit.js.org/tutorials/overview</a></li>
<li><a href="https://redux-toolkit.js.org/usage/usage-guide">https://redux-toolkit.js.org/usage/usage-guide</a></li>
<li><a href="https://redux-toolkit.js.org/usage/usage-with-typescript">https://redux-toolkit.js.org/usage/usage-with-typescript</a></li>
<li><a href="https://github.com/reduxjs/cra-template-redux-typescript">https://github.com/reduxjs/cra-template-redux-typescript</a></li>
<li><a href="https://redux-toolkit.js.org/tutorials/overview">https://redux-toolkit.js.org/tutorials/overview</a></li>
<li><a href="https://stackoverflow.com/questions/68768408/react-redux-toolkit-type-is-not-assignable-to-type-casereducertype-payload">https://stackoverflow.com/questions/68768408/react-redux-toolkit-type-is-not-assignable-to-type-casereducertype-payload</a></li>
<li><a href="https://levelup.gitconnected.com/redux-toolkit-an-easier-way-to-set-up-redux-6782b4857f8">https://levelup.gitconnected.com/redux-toolkit-an-easier-way-to-set-up-redux-6782b4857f8</a></li>
<li><a href="https://www.bezkoder.com/redux-toolkit-example-crud/">https://www.bezkoder.com/redux-toolkit-example-crud/</a></li>
<li><a href="https://redux.js.org/tutorials/fundamentals/part-8-modern-redux">https://redux.js.org/tutorials/fundamentals/part-8-modern-redux</a></li>
<li><a href="https://stackoverflow.com/questions/42906358/having-multiple-instance-of-same-reusable-redux-react-components-on-the-same-pag">https://stackoverflow.com/questions/42906358/having-multiple-instance-of-same-reusable-redux-react-components-on-the-same-pag</a></li>
<li><a href="https://redux.js.org/usage/structuring-reducers/reusing-reducer-logic">https://redux.js.org/usage/structuring-reducers/reusing-reducer-logic</a></li>
</ul>
</body>
</html>
